<!DOCTYPE html><html lang="en-US"><head><title>HWSA 2021 - Structuring and optimising Python code</title><meta property="og:title" content="HWSA 2021 - Structuring and optimising Python code"><meta property="og:image:alt" content="HWSA 2021 - Structuring and optimising Python code"><meta name="description" content="Slides for the practical session of the 2021 HWSA"><meta property="og:description" content="Slides for the practical session of the 2021 HWSA"><link rel="canonical" href="https://smutch.github.io/hwsa2021-slides"><meta property="og:url" content="https://smutch.github.io/hwsa2021-slides"><meta property="og:image" content="https://smutch.github.io/hwsa2021-slides/og-image.jpg"><meta charset="UTF-8"><meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta property="og:type" content="website"><meta name="twitter:card" content="summary_large_image"><style>@media screen{body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{-webkit-appearance:none;-moz-appearance:none;appearance:none;-webkit-tap-highlight-color:transparent;background-color:transparent;border:0;color:inherit;cursor:pointer;font-size:inherit;opacity:.8;outline:none;padding:0;transition:opacity .2s linear}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:disabled{cursor:not-allowed;opacity:.15!important}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover{opacity:1}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:active{opacity:.6}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:not(:disabled){transition:none}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-prev{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNNjggOTAgMjggNTBsNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-next{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJtMzIgOTAgNDAtNDAtNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTQwIDcwSDIwVjUwbTIwIDBMMjAgNzBtNDAtNDBoMjB2MjBtLTIwIDAgMjAtMjAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen]{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTIwIDUwaDIwdjIwbS0yMCAwIDIwLTIwbTQwIDBINjBWMzBtMjAgMEw2MCA1MCIvPjwvc3ZnPg==")}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS13aWR0aDo1cHh9PC9zdHlsZT48L2RlZnM+PHBhdGggY2xhc3M9ImEiIGQ9Ik0yMCA2MGgtNWE1IDUgMCAwIDEtNS01VjIwYTUgNSAwIDAgMSA1LTVoNjBhNSA1IDAgMCAxIDUgNXY1TTMwIDg1aDYwIi8+PHJlY3QgeD0iMzAiIHk9IjM1IiB3aWR0aD0iNjAiIGhlaWdodD0iNDAiIHJ4PSI1IiBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiLz48cmVjdCBjbGFzcz0iYSIgeD0iMzAiIHk9IjM1IiB3aWR0aD0iNjAiIGhlaWdodD0iNDAiIHJ4PSI1Ii8+PHBhdGggY2xhc3M9ImEiIGQ9Ik00MCA1MGg0ME00MCA2MGgzMCIvPjwvc3ZnPg==") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}}.bespoke-marp-note,.bespoke-marp-osc,.bespoke-progress-parent{display:none;transition:none}@media screen{body,html{height:100%;margin:0}body{background:#000;overflow:hidden}svg.bespoke-marp-slide{content-visibility:hidden;opacity:0;pointer-events:none;z-index:-1}svg.bespoke-marp-slide.bespoke-marp-active{content-visibility:visible;opacity:1;pointer-events:auto;z-index:0}svg.bespoke-marp-slide.bespoke-marp-active.bespoke-marp-active-ready *{-webkit-animation-name:__bespoke_marp__!important;animation-name:__bespoke_marp__!important}@supports not (content-visibility:hidden){svg.bespoke-marp-slide[data-bespoke-marp-load=hideable]{display:none}svg.bespoke-marp-slide[data-bespoke-marp-load=hideable].bespoke-marp-active{display:block}}[data-bespoke-marp-fragment=inactive]{visibility:hidden}body[data-bespoke-view=""] .bespoke-marp-parent,body[data-bespoke-view=next] .bespoke-marp-parent{bottom:0;left:0;position:absolute;right:0;top:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc{background:rgba(0,0,0,.65);border-radius:7px;bottom:50px;color:#fff;display:block;font-family:Helvetica,Arial,sans-serif;font-size:16px;left:50%;line-height:0;opacity:1;padding:12px;position:absolute;touch-action:manipulation;transform:translateX(-50%);transition:opacity .2s linear;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;will-change:transform;z-index:1}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>*,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>*{margin-left:6px}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>:first-child,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>:first-child{margin-left:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span{opacity:.8}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page]{display:inline-block;min-width:140px;text-align:center}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev]{height:32px;line-height:32px;width:32px}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive{cursor:none}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc{opacity:0;pointer-events:none}body[data-bespoke-view=""] svg.bespoke-marp-slide,body[data-bespoke-view=next] svg.bespoke-marp-slide{height:100%;left:0;position:absolute;top:0;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent{background:#222;display:flex;height:5px;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent+.bespoke-marp-parent{top:5px}body[data-bespoke-view=""] .bespoke-progress-parent .bespoke-progress-bar{background:#0288d1;flex:0 0 0;transition:flex-basis .2s cubic-bezier(0,1,1,1)}body[data-bespoke-view=next]{background:transparent}body[data-bespoke-view=presenter]{background:#161616}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container{display:grid;font-family:Helvetica,Arial,sans-serif;grid-template-areas:"current next" "current note" "info    note";grid-template-columns:2fr 1fr;grid-template-rows:minmax(140px,1fr) 2fr 3em;height:100%;left:0;position:absolute;top:0;width:100%}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent{grid-area:current;overflow:hidden;position:relative}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide{height:calc(100% - 40px);left:20px;pointer-events:none;position:absolute;top:20px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide.bespoke-marp-active{filter:drop-shadow(0 3px 10px rgba(0,0,0,.5))}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container{background:#222;cursor:pointer;display:none;grid-area:next;overflow:hidden;position:relative}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container iframe.bespoke-marp-presenter-next{background:transparent;border:0;display:block;filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));height:calc(100% - 40px);left:20px;pointer-events:none;position:absolute;top:20px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container{background:#222;color:#eee;grid-area:note}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note{word-wrap:break-word;scrollbar-width:thin;scrollbar-color:hsla(0,0%,93.3%,.5) transparent;box-sizing:border-box;font-size:1.1em;height:calc(100% - 40px);margin:20px;overflow:auto;padding-right:3px;white-space:pre-wrap;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar{width:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-track{background:transparent}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-thumb{background:hsla(0,0%,93.3%,.5);border-radius:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note:empty{pointer-events:none}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:first-child{margin-top:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:last-child{margin-bottom:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container{align-items:center;box-sizing:border-box;color:#eee;display:flex;flex-wrap:nowrap;grid-area:info;justify-content:center;padding:0 10px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{box-sizing:border-box;display:block;padding:0 10px;white-space:nowrap;width:100%}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{height:1.5em;line-height:1.5em;width:1.5em}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page{order:2;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page .bespoke-marp-presenter-info-page-text{display:inline-block;min-width:120px;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time{color:#999;order:1;text-align:left}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{color:#999;order:3;text-align:right}}@media print{.bespoke-marp-presenter-info-container,.bespoke-marp-presenter-next-container,.bespoke-marp-presenter-note-container{display:none}}</style><style>div#p>svg>foreignObject>section{width:1280px;height:720px;box-sizing:border-box;overflow:hidden;position:relative;scroll-snap-align:center center}div#p>svg>foreignObject>section:after{bottom:0;content:attr(data-marpit-pagination);padding:inherit;pointer-events:none;position:absolute;right:0}div#p>svg>foreignObject>section:not([data-marpit-pagination]):after{display:none}/* Normalization */div#p>svg>foreignObject>section h1{font-size:2em;margin:0.67em 0}div#p>svg>foreignObject>section video::-webkit-media-controls{will-change:transform}@page{size:1280px 720px;margin:0}@media print{body,html{background-color:#fff;margin:0;page-break-inside:avoid;break-inside:avoid-page}div#p>svg>foreignObject>section{page-break-before:always;break-before:page}div#p>svg>foreignObject>section,div#p>svg>foreignObject>section *{-webkit-print-color-adjust:exact!important;animation-delay:0s!important;animation-duration:0s!important;color-adjust:exact!important;transition:none!important}div#p>svg[data-marpit-svg]{display:block;height:100vh;width:100vw}}
/*!
 * Marp default theme.
 *
 * @theme default
 * @author Yuki Hattori
 *
 * @auto-scaling true
 * @size 4:3 960px 720px
 */div#p>svg>foreignObject>section .octicon{fill:currentColor;display:inline-block;vertical-align:text-bottom}div#p>svg>foreignObject>section .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}div#p>svg>foreignObject>section .anchor:focus{outline:none}div#p>svg>foreignObject>section h1 .octicon-link,div#p>svg>foreignObject>section h2 .octicon-link,div#p>svg>foreignObject>section h3 .octicon-link,div#p>svg>foreignObject>section h4 .octicon-link,div#p>svg>foreignObject>section h5 .octicon-link,div#p>svg>foreignObject>section h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}div#p>svg>foreignObject>section h1:hover .anchor,div#p>svg>foreignObject>section h2:hover .anchor,div#p>svg>foreignObject>section h3:hover .anchor,div#p>svg>foreignObject>section h4:hover .anchor,div#p>svg>foreignObject>section h5:hover .anchor,div#p>svg>foreignObject>section h6:hover .anchor{text-decoration:none}div#p>svg>foreignObject>section h1:hover .anchor .octicon-link,div#p>svg>foreignObject>section h2:hover .anchor .octicon-link,div#p>svg>foreignObject>section h3:hover .anchor .octicon-link,div#p>svg>foreignObject>section h4:hover .anchor .octicon-link,div#p>svg>foreignObject>section h5:hover .anchor .octicon-link,div#p>svg>foreignObject>section h6:hover .anchor .octicon-link{visibility:visible}div#p>svg>foreignObject>section h1:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h2:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h3:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h4:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h5:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h6:hover .anchor .octicon-link:before{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E");content:" ";display:inline-block;height:16px;width:16px}div#p>svg>foreignObject>section{word-wrap:break-word;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}div#p>svg>foreignObject>section{--marpit-root-font-size:16px}div#p>svg>foreignObject>section details{display:block}div#p>svg>foreignObject>section summary{display:list-item}div#p>svg>foreignObject>section a{background-color:initial}div#p>svg>foreignObject>section a:active,div#p>svg>foreignObject>section a:hover{outline-width:0}div#p>svg>foreignObject>section strong{font-weight:inherit;font-weight:bolder}div#p>svg>foreignObject>section h1{margin:.67em 0}div#p>svg>foreignObject>section img{border-style:none}div#p>svg>foreignObject>section code,div#p>svg>foreignObject>section kbd,div#p>svg>foreignObject>section pre{font-family:monospace,monospace;font-size:1em}div#p>svg>foreignObject>section hr{box-sizing:initial;overflow:visible}div#p>svg>foreignObject>section input{font:inherit;margin:0;overflow:visible}div#p>svg>foreignObject>section [type=checkbox]{padding:0}div#p>svg>foreignObject>section *,div#p>svg>foreignObject>section [type=checkbox]{box-sizing:border-box}div#p>svg>foreignObject>section input{font-family:inherit;font-size:inherit;line-height:inherit}div#p>svg>foreignObject>section a{color:#0366d6;text-decoration:none}div#p>svg>foreignObject>section a:hover{text-decoration:underline}div#p>svg>foreignObject>section strong{font-weight:600}div#p>svg>foreignObject>section hr{background:transparent;border-bottom:1px solid #dfe2e5;height:0;margin:15px 0;overflow:hidden}div#p>svg>foreignObject>section hr:after,div#p>svg>foreignObject>section hr:before{content:"";display:table}div#p>svg>foreignObject>section hr:after{clear:both}div#p>svg>foreignObject>section table{border-collapse:collapse;border-spacing:0}div#p>svg>foreignObject>section td,div#p>svg>foreignObject>section th{padding:0}div#p>svg>foreignObject>section details summary{cursor:pointer}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2,div#p>svg>foreignObject>section h3,div#p>svg>foreignObject>section h4,div#p>svg>foreignObject>section h5,div#p>svg>foreignObject>section h6{margin-bottom:0;margin-top:0}div#p>svg>foreignObject>section h1{font-size:32px}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2{font-weight:600}div#p>svg>foreignObject>section h2{font-size:24px}div#p>svg>foreignObject>section h3{font-size:20px}div#p>svg>foreignObject>section h3,div#p>svg>foreignObject>section h4{font-weight:600}div#p>svg>foreignObject>section h4{font-size:16px}div#p>svg>foreignObject>section h5{font-size:14px}div#p>svg>foreignObject>section h5,div#p>svg>foreignObject>section h6{font-weight:600}div#p>svg>foreignObject>section h6{font-size:12px}div#p>svg>foreignObject>section p{margin-bottom:10px;margin-top:0}div#p>svg>foreignObject>section blockquote{margin:0}div#p>svg>foreignObject>section ol,div#p>svg>foreignObject>section ul{margin-bottom:0;margin-top:0;padding-left:0}div#p>svg>foreignObject>section ol ol,div#p>svg>foreignObject>section ul ol{list-style-type:lower-roman}div#p>svg>foreignObject>section ol ol ol,div#p>svg>foreignObject>section ol ul ol,div#p>svg>foreignObject>section ul ol ol,div#p>svg>foreignObject>section ul ul ol{list-style-type:lower-alpha}div#p>svg>foreignObject>section dd{margin-left:0}div#p>svg>foreignObject>section code,div#p>svg>foreignObject>section pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}div#p>svg>foreignObject>section pre{margin-bottom:0;margin-top:0}div#p>svg>foreignObject>section input::-webkit-inner-spin-button,div#p>svg>foreignObject>section input::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}div#p>svg>foreignObject>section :checked+.radio-label{border-color:#0366d6;position:relative;z-index:1}div#p>svg>foreignObject>section .border{border:1px solid #e1e4e8!important}div#p>svg>foreignObject>section .border-0{border:0!important}div#p>svg>foreignObject>section .border-bottom{border-bottom:1px solid #e1e4e8!important}div#p>svg>foreignObject>section .rounded-1{border-radius:3px!important}div#p>svg>foreignObject>section .bg-white{background-color:#fff!important}div#p>svg>foreignObject>section .bg-gray-light{background-color:#fafbfc!important}div#p>svg>foreignObject>section .text-gray-light{color:#6a737d!important}div#p>svg>foreignObject>section .pl-3,div#p>svg>foreignObject>section .px-3{padding-left:16px!important}div#p>svg>foreignObject>section .px-3{padding-right:16px!important}div#p>svg>foreignObject>section .f6{font-size:12px!important}div#p>svg>foreignObject>section div#p>svg>foreignObject>section section.f6{--marpit-root-font-size:12px!important}div#p>svg>foreignObject>section .lh-condensed{line-height:1.25!important}div#p>svg>foreignObject>section .text-bold{font-weight:600!important}div#p>svg>foreignObject>section .pl-c{color:#6a737d}div#p>svg>foreignObject>section .pl-c1,div#p>svg>foreignObject>section .pl-s .pl-v{color:#005cc5}div#p>svg>foreignObject>section .pl-e,div#p>svg>foreignObject>section .pl-en{color:#6f42c1}div#p>svg>foreignObject>section .pl-s .pl-s1,div#p>svg>foreignObject>section .pl-smi{color:#24292e}div#p>svg>foreignObject>section .pl-ent{color:#22863a}div#p>svg>foreignObject>section .pl-k{color:#d73a49}div#p>svg>foreignObject>section .pl-pds,div#p>svg>foreignObject>section .pl-s,div#p>svg>foreignObject>section .pl-s .pl-pse .pl-s1,div#p>svg>foreignObject>section .pl-sr,div#p>svg>foreignObject>section .pl-sr .pl-cce,div#p>svg>foreignObject>section .pl-sr .pl-sra,div#p>svg>foreignObject>section .pl-sr .pl-sre{color:#032f62}div#p>svg>foreignObject>section .pl-smw,div#p>svg>foreignObject>section .pl-v{color:#e36209}div#p>svg>foreignObject>section .pl-bu{color:#b31d28}div#p>svg>foreignObject>section .pl-ii{background-color:#b31d28;color:#fafbfc}div#p>svg>foreignObject>section .pl-c2{background-color:#d73a49;color:#fafbfc}div#p>svg>foreignObject>section .pl-c2:before{content:"^M"}div#p>svg>foreignObject>section .pl-sr .pl-cce{color:#22863a;font-weight:700}div#p>svg>foreignObject>section .pl-ml{color:#735c0f}div#p>svg>foreignObject>section .pl-mh,div#p>svg>foreignObject>section .pl-mh .pl-en,div#p>svg>foreignObject>section .pl-ms{color:#005cc5;font-weight:700}div#p>svg>foreignObject>section .pl-mi{color:#24292e;font-style:italic}div#p>svg>foreignObject>section .pl-mb{color:#24292e;font-weight:700}div#p>svg>foreignObject>section .pl-md{background-color:#ffeef0;color:#b31d28}div#p>svg>foreignObject>section .pl-mi1{background-color:#f0fff4;color:#22863a}div#p>svg>foreignObject>section .pl-mc{background-color:#ffebda;color:#e36209}div#p>svg>foreignObject>section .pl-mi2{background-color:#005cc5;color:#f6f8fa}div#p>svg>foreignObject>section .pl-mdr{color:#6f42c1;font-weight:700}div#p>svg>foreignObject>section .pl-ba{color:#586069}div#p>svg>foreignObject>section .pl-sg{color:#959da5}div#p>svg>foreignObject>section .pl-corl{color:#032f62;text-decoration:underline}div#p>svg>foreignObject>section .mb-0{margin-bottom:0!important}div#p>svg>foreignObject>section .my-2{margin-bottom:8px!important;margin-top:8px!important}div#p>svg>foreignObject>section .pl-0{padding-left:0!important}div#p>svg>foreignObject>section .py-0{padding-bottom:0!important;padding-top:0!important}div#p>svg>foreignObject>section .pl-1{padding-left:4px!important}div#p>svg>foreignObject>section .pl-2{padding-left:8px!important}div#p>svg>foreignObject>section .py-2{padding-bottom:8px!important;padding-top:8px!important}div#p>svg>foreignObject>section .pl-3{padding-left:16px!important}div#p>svg>foreignObject>section .pl-4{padding-left:24px!important}div#p>svg>foreignObject>section .pl-5{padding-left:32px!important}div#p>svg>foreignObject>section .pl-6{padding-left:40px!important}div#p>svg>foreignObject>section .pl-7{padding-left:48px!important}div#p>svg>foreignObject>section .pl-8{padding-left:64px!important}div#p>svg>foreignObject>section .pl-9{padding-left:80px!important}div#p>svg>foreignObject>section .pl-10{padding-left:96px!important}div#p>svg>foreignObject>section .pl-11{padding-left:112px!important}div#p>svg>foreignObject>section .pl-12{padding-left:128px!important}div#p>svg>foreignObject>section hr{border-bottom-color:#eee}div#p>svg>foreignObject>section kbd{background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da;color:#444d56;display:inline-block;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;padding:3px 5px;vertical-align:middle}div#p>svg>foreignObject>section:after,div#p>svg>foreignObject>section:before{
  /* content:""; */display:table}div#p>svg>foreignObject>section:after{clear:both}div#p>svg>foreignObject>section>:first-child{margin-top:0!important}div#p>svg>foreignObject>section>:last-child{margin-bottom:0!important}div#p>svg>foreignObject>section a:not([href]){color:inherit;text-decoration:none}div#p>svg>foreignObject>section blockquote,div#p>svg>foreignObject>section details,div#p>svg>foreignObject>section dl,div#p>svg>foreignObject>section ol,div#p>svg>foreignObject>section p,div#p>svg>foreignObject>section pre,div#p>svg>foreignObject>section table,div#p>svg>foreignObject>section ul{margin-bottom:16px;margin-top:0}div#p>svg>foreignObject>section hr{background-color:#e1e4e8;border:0;height:.25em;margin:24px 0;padding:0}div#p>svg>foreignObject>section blockquote{border-left:.25em solid #dfe2e5;color:#6a737d;padding:0 1em}div#p>svg>foreignObject>section blockquote>:first-child{margin-top:0}div#p>svg>foreignObject>section blockquote>:last-child{margin-bottom:0}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2,div#p>svg>foreignObject>section h3,div#p>svg>foreignObject>section h4,div#p>svg>foreignObject>section h5,div#p>svg>foreignObject>section h6{font-weight:600;line-height:1.25;margin-bottom:16px;margin-top:24px}div#p>svg>foreignObject>section h1{font-size:2em}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2{border-bottom:1px solid #eaecef;padding-bottom:.3em}div#p>svg>foreignObject>section h2{font-size:1.5em}div#p>svg>foreignObject>section h3{font-size:1.25em}div#p>svg>foreignObject>section h4{font-size:1em}div#p>svg>foreignObject>section h5{font-size:.875em}div#p>svg>foreignObject>section h6{color:#6a737d;font-size:.85em}div#p>svg>foreignObject>section ol,div#p>svg>foreignObject>section ul{padding-left:2em}div#p>svg>foreignObject>section ol ol,div#p>svg>foreignObject>section ol ul,div#p>svg>foreignObject>section ul ol,div#p>svg>foreignObject>section ul ul{margin-bottom:0;margin-top:0}div#p>svg>foreignObject>section li{word-wrap:break-all}div#p>svg>foreignObject>section li>p{margin-top:16px}div#p>svg>foreignObject>section li+li{margin-top:.25em}div#p>svg>foreignObject>section dl{padding:0}div#p>svg>foreignObject>section dl dt{font-size:1em;font-style:italic;font-weight:600;margin-top:16px;padding:0}div#p>svg>foreignObject>section dl dd{margin-bottom:16px;padding:0 16px}div#p>svg>foreignObject>section table{display:block;overflow:auto;width:100%}div#p>svg>foreignObject>section table th{font-weight:600}div#p>svg>foreignObject>section table td,div#p>svg>foreignObject>section table th{border:1px solid #dfe2e5;padding:6px 13px}div#p>svg>foreignObject>section table tr{background-color:#fff;border-top:1px solid #c6cbd1}div#p>svg>foreignObject>section table tr:nth-child(2n){background-color:#f6f8fa}div#p>svg>foreignObject>section img{background-color:#fff;box-sizing:initial;max-width:100%}div#p>svg>foreignObject>section img[align=right]{padding-left:20px}div#p>svg>foreignObject>section img[align=left]{padding-right:20px}div#p>svg>foreignObject>section code{background-color:rgba(27,31,35,.05);border-radius:3px;font-size:85%;margin:0;padding:.2em .4em}div#p>svg>foreignObject>section pre{word-wrap:normal}div#p>svg>foreignObject>section pre>code{background:transparent;border:0;font-size:100%;margin:0;padding:0;white-space:pre;word-break:normal}div#p>svg>foreignObject>section .highlight{margin-bottom:16px}div#p>svg>foreignObject>section .highlight pre{margin-bottom:0;word-break:normal}div#p>svg>foreignObject>section pre{background-color:#f6f8fa;border-radius:3px;font-size:85%;line-height:1.45;overflow:auto;padding:16px}div#p>svg>foreignObject>section pre code{word-wrap:normal;background-color:initial;border:0;display:inline;line-height:inherit;margin:0;max-width:auto;overflow:visible;padding:0}div#p>svg>foreignObject>section .commit-tease-sha{color:#444d56;display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%}div#p>svg>foreignObject>section div#p>svg>foreignObject>section section.commit-tease-sha{--marpit-root-font-size:90%}div#p>svg>foreignObject>section .full-commit .btn-outline:not(:disabled):hover{border-color:#005cc5;color:#005cc5}div#p>svg>foreignObject>section .blob-wrapper{overflow-x:auto;overflow-y:hidden}div#p>svg>foreignObject>section .blob-wrapper-embedded{max-height:240px;overflow-y:auto}div#p>svg>foreignObject>section .blob-num{color:rgba(27,31,35,.3);cursor:pointer;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;min-width:50px;padding-left:10px;padding-right:10px;text-align:right;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:top;white-space:nowrap;width:1%}div#p>svg>foreignObject>section div#p>svg>foreignObject>section section.blob-num{--marpit-root-font-size:12px}div#p>svg>foreignObject>section .blob-num:hover{color:rgba(27,31,35,.6)}div#p>svg>foreignObject>section .blob-num:before{content:attr(data-line-number)}div#p>svg>foreignObject>section .blob-code{line-height:20px;padding-left:10px;padding-right:10px;position:relative;vertical-align:top}div#p>svg>foreignObject>section .blob-code-inner{word-wrap:normal;color:#24292e;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;overflow:visible;white-space:pre}div#p>svg>foreignObject>section div#p>svg>foreignObject>section section.blob-code-inner{--marpit-root-font-size:12px}div#p>svg>foreignObject>section .pl-token.active,div#p>svg>foreignObject>section .pl-token:hover{background:#ffea7f;cursor:pointer}div#p>svg>foreignObject>section .tab-size[data-tab-size="1"]{-moz-tab-size:1;-o-tab-size:1;tab-size:1}div#p>svg>foreignObject>section .tab-size[data-tab-size="2"]{-moz-tab-size:2;-o-tab-size:2;tab-size:2}div#p>svg>foreignObject>section .tab-size[data-tab-size="3"]{-moz-tab-size:3;-o-tab-size:3;tab-size:3}div#p>svg>foreignObject>section .tab-size[data-tab-size="4"]{-moz-tab-size:4;-o-tab-size:4;tab-size:4}div#p>svg>foreignObject>section .tab-size[data-tab-size="5"]{-moz-tab-size:5;-o-tab-size:5;tab-size:5}div#p>svg>foreignObject>section .tab-size[data-tab-size="6"]{-moz-tab-size:6;-o-tab-size:6;tab-size:6}div#p>svg>foreignObject>section .tab-size[data-tab-size="7"]{-moz-tab-size:7;-o-tab-size:7;tab-size:7}div#p>svg>foreignObject>section .tab-size[data-tab-size="8"]{-moz-tab-size:8;-o-tab-size:8;tab-size:8}div#p>svg>foreignObject>section .tab-size[data-tab-size="9"]{-moz-tab-size:9;-o-tab-size:9;tab-size:9}div#p>svg>foreignObject>section .tab-size[data-tab-size="10"]{-moz-tab-size:10;-o-tab-size:10;tab-size:10}div#p>svg>foreignObject>section .tab-size[data-tab-size="11"]{-moz-tab-size:11;-o-tab-size:11;tab-size:11}div#p>svg>foreignObject>section .tab-size[data-tab-size="12"]{-moz-tab-size:12;-o-tab-size:12;tab-size:12}div#p>svg>foreignObject>section .task-list-item{list-style-type:none}div#p>svg>foreignObject>section .task-list-item+.task-list-item{margin-top:3px}div#p>svg>foreignObject>section .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}div#p>svg>foreignObject>section .hljs{background:#fff;color:#333;display:block;overflow-x:auto;padding:.5em}div#p>svg>foreignObject>section .hljs-comment,div#p>svg>foreignObject>section .hljs-meta{color:#969896}div#p>svg>foreignObject>section .hljs-emphasis,div#p>svg>foreignObject>section .hljs-quote,div#p>svg>foreignObject>section .hljs-strong,div#p>svg>foreignObject>section .hljs-template-variable,div#p>svg>foreignObject>section .hljs-variable{color:#df5000}div#p>svg>foreignObject>section .hljs-keyword,div#p>svg>foreignObject>section .hljs-selector-tag,div#p>svg>foreignObject>section .hljs-type{color:#d73a49}div#p>svg>foreignObject>section .hljs-attribute,div#p>svg>foreignObject>section .hljs-bullet,div#p>svg>foreignObject>section .hljs-literal,div#p>svg>foreignObject>section .hljs-symbol{color:#0086b3}div#p>svg>foreignObject>section .hljs-name,div#p>svg>foreignObject>section .hljs-section{color:#63a35c}div#p>svg>foreignObject>section .hljs-tag{color:#333}div#p>svg>foreignObject>section .hljs-attr,div#p>svg>foreignObject>section .hljs-selector-attr,div#p>svg>foreignObject>section .hljs-selector-class,div#p>svg>foreignObject>section .hljs-selector-id,div#p>svg>foreignObject>section .hljs-selector-pseudo,div#p>svg>foreignObject>section .hljs-title{color:#6f42c1}div#p>svg>foreignObject>section .hljs-addition{background-color:#eaffea;color:#55a532}div#p>svg>foreignObject>section .hljs-deletion{background-color:#ffecec;color:#bd2c00}div#p>svg>foreignObject>section .hljs-link{text-decoration:underline}div#p>svg>foreignObject>section .hljs-number{color:#005cc5}div#p>svg>foreignObject>section .hljs-string{color:#032f62}div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{max-height:563px}div#p>svg>foreignObject>section h1{color:#246;font-size:1.6em}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2{border-bottom:none}div#p>svg>foreignObject>section h2{font-size:1.3em}div#p>svg>foreignObject>section h3{font-size:1.1em}div#p>svg>foreignObject>section h4{font-size:1.05em}div#p>svg>foreignObject>section h5{font-size:1em}div#p>svg>foreignObject>section h6{font-size:.9em}div#p>svg>foreignObject>section h1 strong,div#p>svg>foreignObject>section h2 strong,div#p>svg>foreignObject>section h3 strong,div#p>svg>foreignObject>section h4 strong,div#p>svg>foreignObject>section h5 strong,div#p>svg>foreignObject>section h6 strong{color:#48c;font-weight:inherit}div#p>svg>foreignObject>section hr{height:0;padding-top:.25em}div#p>svg>foreignObject>section pre{border:1px solid #999;line-height:1.15;overflow:visible}div#p>svg>foreignObject>section pre code svg[data-marp-fitting=svg]{max-height:529px}div#p>svg>foreignObject>section footer,div#p>svg>foreignObject>section header{color:hsla(0,0%,40%,.75);font-size:18px;left:30px;margin:0;position:absolute}div#p>svg>foreignObject>section header{top:21px}div#p>svg>foreignObject>section footer{bottom:21px}div#p>svg>foreignObject>section{align-items:stretch;background:#fff;display:flex;flex-direction:column;flex-wrap:nowrap;font-size:29px;height:720px;justify-content:center;padding:78.5px;width:1280px}div#p>svg>foreignObject>section{--marpit-root-font-size:29px}div#p>svg>foreignObject>section>:last-child,div#p>svg>foreignObject>section[data-footer]>:nth-last-child(2){margin-bottom:0}div#p>svg>foreignObject>section>:first-child,div#p>svg>foreignObject>section>header:first-child+*{margin-top:0}div#p>svg>foreignObject>section:after{bottom:21px;color:#777;font-size:24px;padding:0;position:absolute;right:30px}div#p>svg>foreignObject>section:after{--marpit-root-font-size:24px}div#p>svg>foreignObject>section.invert{background-color:#222;color:#e6eaf0}div#p>svg>foreignObject>section.invert:after{color:#999}div#p>svg>foreignObject>section.invert img{background-color:transparent}div#p>svg>foreignObject>section.invert a{color:#50b3ff}div#p>svg>foreignObject>section.invert h1{color:#a3c5e7}div#p>svg>foreignObject>section.invert h2,div#p>svg>foreignObject>section.invert h3,div#p>svg>foreignObject>section.invert h4,div#p>svg>foreignObject>section.invert h5{color:#ebeff5}div#p>svg>foreignObject>section.invert blockquote,div#p>svg>foreignObject>section.invert h6{border-color:#3d3f43;color:#939699}div#p>svg>foreignObject>section.invert h1 strong,div#p>svg>foreignObject>section.invert h2 strong,div#p>svg>foreignObject>section.invert h3 strong,div#p>svg>foreignObject>section.invert h4 strong,div#p>svg>foreignObject>section.invert h5 strong,div#p>svg>foreignObject>section.invert h6 strong{color:#7bf}div#p>svg>foreignObject>section.invert hr{background-color:#3d3f43}div#p>svg>foreignObject>section.invert footer,div#p>svg>foreignObject>section.invert header{color:hsla(0,0%,60%,.75)}div#p>svg>foreignObject>section.invert code,div#p>svg>foreignObject>section.invert kbd{background-color:#111}div#p>svg>foreignObject>section.invert kbd{border-color:#666;box-shadow:inset 0 -1px 0 #555;color:#e6eaf0}div#p>svg>foreignObject>section.invert table tr{background-color:#12181d;border-color:#60657b}div#p>svg>foreignObject>section.invert table tr:nth-child(2n){background-color:#1b2024}div#p>svg>foreignObject>section.invert table td,div#p>svg>foreignObject>section.invert table th{border-color:#5b5e61}div#p>svg>foreignObject>section.invert pre{background-color:#0a0e12;border-color:#777}div#p>svg>foreignObject>section.invert pre code{background-color:transparent}div#p>svg>foreignObject>section[data-color] h1,div#p>svg>foreignObject>section[data-color] h2,div#p>svg>foreignObject>section[data-color] h3,div#p>svg>foreignObject>section[data-color] h4,div#p>svg>foreignObject>section[data-color] h5,div#p>svg>foreignObject>section[data-color] h6{color:currentColor}div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{display:block;height:auto;width:100%}@supports (-ms-ime-align:auto){div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{position:static}}div#p>svg>foreignObject>section svg[data-marp-fitting=svg].__reflow__{content:""}@supports (-ms-ime-align:auto){div#p>svg>foreignObject>section svg[data-marp-fitting=svg].__reflow__{position:relative}}div#p>svg>foreignObject>section [data-marp-fitting-svg-content]{display:table;white-space:nowrap;width:-webkit-max-content;width:-moz-max-content;width:max-content}div#p>svg>foreignObject>section [data-marp-fitting-svg-content-wrap]{white-space:pre}div#p>svg>foreignObject>section img[data-marp-twemoji]{background:transparent;height:1em;margin:0 .05em 0 .1em;vertical-align:-.1em;width:1em}

/* @theme custom
 */div#p>svg>foreignObject>section:not(\9){background-color:#f0f8ff;padding-top:157px}div#p>svg>foreignObject>section footer{text-align:left}div#p>svg>foreignObject>section p.quote{text-align:right;font-family:serif;background-color:#c0c6cc;padding:10px}div#p>svg>foreignObject>section p.standout{color:#F78C6C;background-color:#2E3C43}div#p>svg>foreignObject>section h1.large{font-size:calc(var(--marpit-root-font-size, 1rem) * 3)}div#p>svg>foreignObject>section>:first-child{position:absolute;top:78.5px}div#p>svg>foreignObject>section.all-centered{padding-top:78.5px}div#p>svg>foreignObject>section.all-centered>:first-child{position:initial;top:0px}div#p>svg>foreignObject>section pre,div#p>svg>foreignObject>section pre[class*=language-]{background-color:#263238;color:#EEFFFF;font-size:calc(var(--marpit-root-font-size, 1rem) * 0.6)}div#p>svg>foreignObject>section .highlighted-line{background-color:#546E7A;color:white;display:block}


/*!
  Theme: Material
  Author: Nate Peterson
  License: ~ MIT (or more permissive) [via base16-schemes-source]
  Maintainer: @highlightjs/core-team
  Version: 2021.05.0
*/

/*
  WARNING: DO NOT EDIT THIS FILE DIRECTLY.

  This theme file was auto-generated from the Base16 scheme material
  by the Highlight.js Base16 template builder.

  - https://github.com/highlightjs/base16-highlightjs
*/

/*
base00  #263238  Default Background
base01  #2E3C43  Lighter Background (Used for status bars, line number and folding marks)
base02  #314549  Selection Background
base03  #546E7A  Comments, Invisibles, Line Highlighting
base04  #B2CCD6  Dark Foreground (Used for status bars)
base05  #EEFFFF  Default Foreground, Caret, Delimiters, Operators
base06  #EEFFFF  Light Foreground (Not often used)
base07  #FFFFFF  Light Background (Not often used)
base08  #F07178  Variables, XML Tags, Markup Link Text, Markup Lists, Diff Deleted
base09  #F78C6C  Integers, Boolean, Constants, XML Attributes, Markup Link Url
base0A  #FFCB6B  Classes, Markup Bold, Search Text Background
base0B  #C3E88D  Strings, Inherited Class, Markup Code, Diff Inserted
base0C  #89DDFF  Support, Regular Expressions, Escape Characters, Markup Quotes
base0D  #82AAFF  Functions, Methods, Attribute IDs, Headings
base0E  #C792EA  Keywords, Storage, Selector, Markup Italic, Diff Changed
base0F  #FF5370  Deprecated, Opening/Closing Embedded Language Tags, e.g. <?php ?>
*/div#p>svg>foreignObject>section pre code.hljs{display:block;overflow-x:auto;padding:1em}div#p>svg>foreignObject>section code.hljs{padding:3px 5px}div#p>svg>foreignObject>section .hljs{color:#EEFFFF;background:#263238}div#p>svg>foreignObject>section .hljs ::selection{color:#314549}


/* purposely do not highlight these things */div#p>svg>foreignObject>section .hljs-formula,div#p>svg>foreignObject>section .hljs-params,div#p>svg>foreignObject>section .hljs-property{}

/* base03 - #546E7A -  Comments, Invisibles, Line Highlighting */div#p>svg>foreignObject>section .hljs-comment{color:#546E7A}

/* base04 - #B2CCD6 -  Dark Foreground (Used for status bars) */div#p>svg>foreignObject>section .hljs-tag{color:#B2CCD6}

/* base05 - #EEFFFF -  Default Foreground, Caret, Delimiters, Operators */div#p>svg>foreignObject>section .hljs-operator,div#p>svg>foreignObject>section .hljs-punctuation,div#p>svg>foreignObject>section .hljs-subst{color:#EEFFFF}div#p>svg>foreignObject>section .hljs-operator{opacity:0.7}

/* base08 - Variables, XML Tags, Markup Link Text, Markup Lists, Diff Deleted */div#p>svg>foreignObject>section .hljs-bullet,div#p>svg>foreignObject>section .hljs-deletion,div#p>svg>foreignObject>section .hljs-name,div#p>svg>foreignObject>section .hljs-selector-tag,div#p>svg>foreignObject>section .hljs-template-variable,div#p>svg>foreignObject>section .hljs-variable{color:#F07178}

/* base09 - Integers, Boolean, Constants, XML Attributes, Markup Link Url */div#p>svg>foreignObject>section .hljs-attr,div#p>svg>foreignObject>section .hljs-link,div#p>svg>foreignObject>section .hljs-literal,div#p>svg>foreignObject>section .hljs-number,div#p>svg>foreignObject>section .hljs-symbol,div#p>svg>foreignObject>section .hljs-variable.constant_{color:#F78C6C}

/* base0A - Classes, Markup Bold, Search Text Background */div#p>svg>foreignObject>section .hljs-class .hljs-title,div#p>svg>foreignObject>section .hljs-title,div#p>svg>foreignObject>section .hljs-title.class_{color:#FFCB6B}div#p>svg>foreignObject>section .hljs-strong{font-weight:bold;color:#FFCB6B}

/* base0B - Strings, Inherited Class, Markup Code, Diff Inserted */div#p>svg>foreignObject>section .hljs-addition,div#p>svg>foreignObject>section .hljs-code,div#p>svg>foreignObject>section .hljs-string,div#p>svg>foreignObject>section .hljs-title.class_.inherited__{color:#C3E88D}

/* base0C - Support, Regular Expressions, Escape Characters, Markup Quotes */div#p>svg>foreignObject>section .hljs-built_in,div#p>svg>foreignObject>section .hljs-doctag,div#p>svg>foreignObject>section .hljs-keyword.hljs-atrule,div#p>svg>foreignObject>section .hljs-quote,div#p>svg>foreignObject>section .hljs-regexp{color:#89DDFF}

/* base0D - Functions, Methods, Attribute IDs, Headings */div#p>svg>foreignObject>section .hljs-attribute,div#p>svg>foreignObject>section .hljs-function .hljs-title,div#p>svg>foreignObject>section .hljs-section,div#p>svg>foreignObject>section .hljs-title.function_,div#p>svg>foreignObject>section .ruby .hljs-property{color:#82AAFF}

/* base0E - Keywords, Storage, Selector, Markup Italic, Diff Changed */div#p>svg>foreignObject>section .diff .hljs-meta,div#p>svg>foreignObject>section .hljs-keyword,div#p>svg>foreignObject>section .hljs-template-tag,div#p>svg>foreignObject>section .hljs-type{color:#C792EA}div#p>svg>foreignObject>section .hljs-emphasis{color:#C792EA;font-style:italic}

/* base0F - Deprecated, Opening/Closing Embedded Language Tags, e.g. <?php ?> */div#p>svg>foreignObject>section .hljs-meta,div#p>svg>foreignObject>section .hljs-meta .hljs-keyword,div#p>svg>foreignObject>section .hljs-meta .hljs-string{color:#FF5370}div#p>svg>foreignObject>section .hljs-meta-keyword,div#p>svg>foreignObject>section .hljs-meta .hljs-keyword{font-weight:bold}div#p>svg>foreignObject>section[data-marpit-scope-1hT3IYpU] pre,div#p>svg>foreignObject>section[data-marpit-scope-1hT3IYpU] pre[class*=language-]{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.5)}div#p>svg>foreignObject>section[data-marpit-scope-1hT3IYpU] ul{flex-direction:row;display:flex;font-size:calc(var(--marpit-root-font-size, 1rem) * 0.6)}div#p>svg>foreignObject>section[data-marpit-scope-1hT3IYpU] li{margin-left:calc(var(--marpit-root-font-size, 1rem) * 1);margin-top:calc(var(--marpit-root-font-size, 1rem) * 0.25)}div#p>svg>foreignObject>section[data-marpit-scope-GQkr3Nbk] ul{margin-bottom:10px}div#p>svg>foreignObject>section[data-marpit-scope-GQkr3Nbk] li,div#p>svg>foreignObject>section[data-marpit-scope-GQkr3Nbk] ul p{margin:0;line-height:calc(var(--marpit-root-font-size, 1rem) * 1.2);font-size:calc(var(--marpit-root-font-size, 1rem) * 0.8)}div#p>svg>foreignObject>section[data-marpit-scope-GQkr3Nbk] li,div#p>svg>foreignObject>section[data-marpit-scope-GQkr3Nbk] ul{padding-left:0px}div#p>svg>foreignObject>section[data-marpit-scope-GQkr3Nbk] ul ul{padding-left:20px}div#p>svg>foreignObject>section[data-marpit-scope-GQkr3Nbk] ul ul li{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.7);line-height:calc(var(--marpit-root-font-size, 1rem) * 1)}div#p>svg>foreignObject>section[data-marpit-scope-GQkr3Nbk] p.standout{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.8);padding:0 calc(var(--marpit-root-font-size, 1rem) * 0.3);text-align:right}div#p>svg>foreignObject>section[data-marpit-scope-dLAPLu5c] ul{margin-top:-15px}div#p>svg>foreignObject>section[data-marpit-scope-dLAPLu5c] li{margin:0}div#p>svg>foreignObject>section[data-marpit-scope-0MUmmPRB] .nudge-down{margin-top:40px}div#p>svg>foreignObject>section[data-marpit-scope-0MUmmPRB] h2{margin-bottom:0px}div#p>svg>foreignObject>section[data-marpit-scope-Pxzzz0Mf] ul{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.8)}div#p>svg>foreignObject>section[data-marpit-scope-Pxzzz0Mf] h1{line-height:calc(var(--marpit-root-font-size, 1rem) * 1.5)}div#p>svg>foreignObject>section[data-marpit-scope-Pxzzz0Mf] li.no-bullet{list-style-type:none}div#p>svg>foreignObject>section[data-marpit-scope-pUJF9wEg] p{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.75)}div#p>svg>foreignObject>section[data-marpit-scope-ZSY2IwjI] ul{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.75)}div#p>svg>foreignObject>section[data-marpit-scope-PIN6aX5o] p{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.8)}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]{columns:initial!important;display:block!important;padding:0!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]:after,div#p>svg>foreignObject>section[data-marpit-advanced-background=background]:before,div#p>svg>foreignObject>section[data-marpit-advanced-background=content]:after,div#p>svg>foreignObject>section[data-marpit-advanced-background=content]:before{display:none!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container]{all:initial;display:flex;flex-direction:row;height:100%;overflow:hidden;width:100%}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container][data-marpit-advanced-background-direction=vertical]{flex-direction:column}div#p>svg>foreignObject>section[data-marpit-advanced-background=background][data-marpit-advanced-background-split]>div[data-marpit-advanced-background-container]{width:var(--marpit-advanced-background-split,50%)}div#p>svg>foreignObject>section[data-marpit-advanced-background=background][data-marpit-advanced-background-split=right]>div[data-marpit-advanced-background-container]{margin-left:calc(100% - var(--marpit-advanced-background-split, 50%))}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container]>figure{all:initial;background-position:center;background-repeat:no-repeat;background-size:cover;flex:auto;margin:0}div#p>svg>foreignObject>section[data-marpit-advanced-background=content],div#p>svg>foreignObject>section[data-marpit-advanced-background=pseudo]{background:transparent!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=pseudo],div#p>svg[data-marpit-svg]>foreignObject[data-marpit-advanced-background=pseudo]{pointer-events:none!important}div#p>svg>foreignObject>section[data-marpit-advanced-background-split]{width:100%;height:100%}</style></head><body><div class="bespoke-marp-osc"><button data-bespoke-marp-osc="prev" tabindex="-1" title="Previous slide">Previous slide</button><span data-bespoke-marp-osc="page"></span><button data-bespoke-marp-osc="next" tabindex="-1" title="Next slide">Next slide</button><button data-bespoke-marp-osc="fullscreen" tabindex="-1" title="Toggle fullscreen (f)">Toggle fullscreen</button><button data-bespoke-marp-osc="presenter" tabindex="-1" title="Open presenter view (p)">Open presenter view</button></div><div id="p"><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="1" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-class="all-centered" data-background-image="linear-gradient(to bottom, #f05053, #e1eec3)" data-theme="custom" class="all-centered" style="--footer:https://github.com/smutch/code_prac_hwsa2021;--class:all-centered;--background-image:linear-gradient(to bottom, #f05053, #e1eec3);--theme:custom;background-image:linear-gradient(to bottom, #f05053, #e1eec3);background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><svg data-marp-fitting="svg"><foreignObject><span data-marp-fitting-svg-content> Optimizing and structuring python code</span></foreignObject></svg></h1>
<h2>HWSA 2021</h2>
<p>Simon Mutch</p>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-marpit-fragments="2" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-background-color="black" data-color="white" data-marpit-pagination="2" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--background-color:black;--color:white;color:white;background-color:black;background-image:none;" data-marpit-advanced-background="background"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./assets/chris-ried-ieic5Tq8YMk-unsplash.jpg&quot;);filter:blur(4px) brightness(0.2) contrast(80%);"></figure></div></section></foreignObject><foreignObject width="1280" height="720"><section id="2" data-marpit-fragments="2" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-background-color="black" data-color="white" data-marpit-pagination="2" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--background-color:black;--color:white;color:white;background-color:black;background-image:none;" data-marpit-advanced-background="content">
<h1 class="large">Session outline</h1>

<ul>
<li data-marpit-fragment="1">Presentation
<ul>
<li>Optimisation</li>
<li>Documentation</li>
<li>Tips, tricks &amp; tools</li>
</ul>
</li>
<li data-marpit-fragment="2">Practical
<ul>
<li>Open ended session with a short code to try some of these techniques out on.</li>
<li><strong><img class="emoji" draggable="false" alt="" src="https://twemoji.maxcdn.com/2/svg/1f3c6.svg" data-marp-twemoji=""/> Competition <img class="emoji" draggable="false" alt="" src="https://twemoji.maxcdn.com/2/svg/1f3c6.svg" data-marp-twemoji=""/></strong>: Who can achieve the greatest speed-up? <img class="emoji" draggable="false" alt="" src="https://twemoji.maxcdn.com/2/svg/23f1.svg" data-marp-twemoji=""/></li>
</ul>
</li>
</ul>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="color:white;" data-marpit-advanced-background="pseudo" data-marpit-pagination="2" data-marpit-pagination-total="32"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="3" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;" data-marpit-advanced-background="background"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./assets/quote-premature-optimization-is-the-root-of-all-evil-donald-knuth-72-10-20.jpg&quot;);background-size:1000px auto;"></figure></div></section></foreignObject><foreignObject width="1280" height="720"><section id="3" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="3" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;" data-marpit-advanced-background="content">
<h1></h1>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="3" data-marpit-pagination-total="32"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-marpit-fragments="7" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="4" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:50%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./assets/age-barros-rBPOfVqROzY-unsplash.jpg&quot;);"></figure></div></section></foreignObject><foreignObject width="50%" height="720"><section id="4" data-marpit-fragments="7" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="4" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:50%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1>The optimisation cycle</h1>

<ol>
<li data-marpit-fragment="1">Profile</li>
<li data-marpit-fragment="2">Develop regression tests</li>
<li data-marpit-fragment="3">Baseline timing</li>
<li data-marpit-fragment="4">Optimise identified bottlenecks</li>
<li data-marpit-fragment="5">Time</li>
<li data-marpit-fragment="6">Test</li>
<li data-marpit-fragment="7">Profile then go back to 4<br />
<strong>or</strong> call it a day and bask in glory</li>
</ol>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="4" data-marpit-pagination-total="32"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="5" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="5" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>cProfile</h1>
<div data-marpit-fragment>
<p><code>cProfile</code> is part of the Python standard library <em>(you don't need to manually install it)</em>.<br />
It gives statistics for function calls and is often the best place to start when profiling Python code.</p>
</div>
<div data-marpit-fragment>
<pre class="language-python"><code class="language-python"><span class="hljs-keyword">import</span> cProfile
<span class="hljs-keyword">import</span> pstats

profile = cProfile.Profile()

profile.enable()

dn_dlogm_list = []
<span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> z_list:
    dn_dlogm_list.append(press_schecter(M_list, z, A_std_func()))

profile.disable()

ps = pstats.Stats(profile).strip_dirs().sort_stats(pstats.SortKey.TIME)
ps.print_stats()</code></pre></div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="6" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="6" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>cProfile</h1>
<p><code>cProfile</code> is part of the Python standard library <em>(you don't need to manually install it)</em>.<br />
It gives statistics for function calls and is often the best place to start when profiling Python code.</p>
<div>
<pre class="language-python"><code class="language-python"><span class="hljs-keyword">import</span> cProfile
<span class="hljs-keyword">import</span> pstats

profile = cProfile.Profile()

<span class="highlighted-line">profile.enable()</span>
dn_dlogm_list = []
<span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> z_list:
    dn_dlogm_list.append(press_schecter(M_list, z, A_std_func()))

<span class="highlighted-line">profile.disable()</span>
ps = pstats.Stats(profile).strip_dirs().sort_stats(pstats.SortKey.TIME)
ps.print_stats()</code></pre></div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="7" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="7" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>cProfile</h1>
<p><code>cProfile</code> is part of the Python standard library <em>(you don't need to manually install it)</em>.<br />
It gives statistics for function calls and is often the best place to start when profiling Python code.</p>
<div>
<pre class="language-python"><code class="language-python"><span class="hljs-keyword">import</span> cProfile
<span class="hljs-keyword">import</span> pstats

profile = cProfile.Profile()

profile.enable()

dn_dlogm_list = []
<span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> z_list:
    dn_dlogm_list.append(press_schecter(M_list, z, A_std_func()))

profile.disable()

<span class="highlighted-line">ps = pstats.Stats(profile).strip_dirs().sort_stats(pstats.SortKey.TIME)</span><span class="highlighted-line">ps.print_stats()</span></code></pre></div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="8" data-marpit-fragments="3" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="8" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>cProfile</h1>
<pre><code><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>         3326986 function calls in 8.092 seconds

   Ordered by: internal time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
  1094475    4.079    0.000    4.079    0.000 press_schecter.py:22(tophat_ft)
  1094475    2.482    0.000    2.482    0.000 press_schecter.py:27(power)
  1094100    0.894    0.000    7.454    0.000 press_schecter.py:38(&lt;lambda&gt;)
     4005    0.536    0.000    7.992    0.002 {built-in method scipy.integrate._quadpack._qagie}
     1000    0.018    0.000    6.116    0.006 common.py:75(derivative)
     1000    0.012    0.000    0.012    0.000 {method 'reduce' of 'numpy.ufunc' objects}
        5    0.012    0.002    8.089    1.618 press_schecter.py:69(press_schecter)
</span></span></foreignObject></svg></code></pre>
<ul>
<li data-marpit-fragment="1"><strong>tottime</strong>: time spent inside this function</li>
<li data-marpit-fragment="2"><strong>cumtime</strong>: time spent inside this function and all functions it calls</li>
<li data-marpit-fragment="3"><strong>percall</strong>: cumulative time per call</li>
</ul>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="9" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="9" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>line_profiler</h1>
<p>What if we want to go deeper though?<br />
<em>Where</em> in the function are we spending all of our time? Calculating logarithms, multiplying numbers?</p>
<div data-marpit-fragment>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">@profile</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">press_schechter</span>(<span class="hljs-params">...</span>):</span>
    ...
</span></span></foreignObject></svg></code></pre>
<pre><code class="language-sh"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>&gt; kernprof -l press_schecter.py
&gt; python3 -m line_profiler press_schechter.py.lprof
</span></span></foreignObject></svg></code></pre>
</div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="10" data-marpit-scope-1hT3IYpU="" data-marpit-fragments="4" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="10" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>line_profiler</h1>
<pre><code><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>Function: press_schecter at line 66

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    66                                           @profile
    67                                           def press_schecter(M_list, z, A_std):
    68         5        115.0     23.0      0.0      R_list = (2 * (M_list) * G / (h0 ** 2 * wm)) ** (1 / 3)
    69         5         18.0      3.6      0.0      rho = rho_m(z=0)
    70
    71         5        764.0    152.8      0.0      d_c = d_crit(z)
    72
    73         5          4.0      0.8      0.0      dn_dlogm = []
    74      1005       1436.0      1.4      0.0      for r in R_list:
    75      1000    3266597.0   3266.6     24.3          std = stdev(r, A=A_std)
    76      1000       2010.0      2.0      0.0          deriv = (
    77      1000   10167353.0  10167.4     75.6              2 * G / (3 * h0 ** 2 * wm * r ** 2) * \
                                                            derivative(lambda rr: np.log(stdev(rr, A=A_std)), x0=r, dx=r * 0.5)
    78                                                   )
    79      1000       1078.0      1.1      0.0          nu = d_c / std
    80      1000       9737.0      9.7      0.1          dn_dlogm.append( \
                                                            np.sqrt(2 / np.pi) * rho * -deriv * nu * np.exp(-(nu ** 2) / 2) \
                                                         )
    81         5          3.0      0.6      0.0      return dn_dlogm
</span></span></foreignObject></svg></code></pre>
<ul>
<li data-marpit-fragment="1"><strong>Hits</strong>: Number of times this line is called.</li>
<li data-marpit-fragment="2"><strong>Total</strong>: Cumulative time spent on this line.</li>
<li data-marpit-fragment="3"><strong>Per Hit</strong>: Time spent on line each time it's called.</li>
<li data-marpit-fragment="4"><strong>% Time</strong>: Percentage of time spent on this line relative to whole function.</li>
</ul>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-marpit-scope-GQkr3Nbk="" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-class="all-centered" data-theme="custom" class="all-centered" data-marpit-pagination="11" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--class:all-centered;--theme:custom;--marpit-advanced-background-split:33%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="left"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./assets/chris-liverani-ViEBSoZH6M4-unsplash.jpg&quot;);"></figure></div></section></foreignObject><foreignObject width="67%" height="720" x="33%"><section id="11" data-marpit-scope-GQkr3Nbk="" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-class="all-centered" data-theme="custom" class="all-centered" data-marpit-pagination="11" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--class:all-centered;--theme:custom;--marpit-advanced-background-split:33%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="left">
<h1>Testing</h1>
<ul>
<li><strong>Unit tests</strong>: Ideally test the smallest logical units of your code (e.g. individual functions).
<ul>
<li>Should (ideally) test correctness, edge cases and unexpected input.</li>
</ul>
</li>
<li><strong>Integration tests</strong>: Tests larger units or the whole code and how they interact.
<ul>
<li>Should (ideally) test correctness, edge cases and unexpected input.</li>
</ul>
</li>
<li><strong>Regression tests</strong>: Tests larger units or the whole code to make sure you recover the same answer after changes.
<ul>
<li>Sometimes you don't want these (e.g. when changing physical models), but they are <strong>very important</strong> for optimisation.</li>
</ul>
</li>
</ul>
<div data-marpit-fragment>
<p class="standout"><strong>Make testing part of your routine</strong>.<br />
It's a lot easier to write tests as you go along, rather than coming back after-the-fact.</p>
</div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section class="all-centered" style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="11" data-marpit-pagination-total="32"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-marpit-scope-dLAPLu5c="" data-paginate="true" data-footer="&lt;sup&gt;1&lt;/sup&gt; See also https://github.com/astropy/pytest-arraydiff
https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="12" data-marpit-pagination-total="32" style="--paginate:true;--footer:&lt;sup&gt;1&lt;/sup&gt; See also https://github.com/astropy/pytest-arraydiff
https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:20%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;https://docs.pytest.org/en/6.2.x/_static/pytest1.png&quot;);background-size:auto;"></figure></div></section></foreignObject><foreignObject width="80%" height="720"><section id="12" data-marpit-scope-dLAPLu5c="" data-paginate="true" data-footer="&lt;sup&gt;1&lt;/sup&gt; See also https://github.com/astropy/pytest-arraydiff
https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="12" data-marpit-pagination-total="32" style="--paginate:true;--footer:&lt;sup&gt;1&lt;/sup&gt; See also https://github.com/astropy/pytest-arraydiff
https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:20%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1>Pytest</h1>

<p>Covering <a href="https://docs.pytest.org/">pytest</a> and all it has to offer would take a whole session itself!<br />
There are a lot of great examples and articles online.</p>
<p>Some useful topics to check out include:</p>
<ul>
<li>Fixtures</li>
<li>Parameterizing tests</li>
<li>Setting up continuous integration (CI) for automated testing</li>
<li>Coverage measurements</li>
</ul>
<p>For regression testing, the <a href="https://pypi.org/project/pytest-regtest/">regtest</a> plugin is popular<sup>1</sup>...</p>
<footer><sup>1</sup> See also <a href="https://github.com/astropy/pytest-arraydiff">https://github.com/astropy/pytest-arraydiff</a><br />
<a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="12" data-marpit-pagination-total="32"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="13" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="13" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Regression tests with pytest</h1>
<p>Naming of directories, files and functions all matter with pytest. You can configure this, but standard practice is:</p>
<ul>
<li>Place all of your tests in a directory called <code>tests</code>.</li>
<li>You need to have a <code>__init__.py</code> file in <code>tests</code> (to make them part of a module) but it can be empty.</li>
<li>Each file should be called <code>test_*.py</code>.</li>
<li>Each test function should be called <code>test_*</code>.</li>
</ul>
<pre><code><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>tests
 __init__.py
 test_regressions.py
</span></span></foreignObject></svg></code></pre>
<pre><code class="language-py"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_regressions</span>(<span class="hljs-params">...</span>):</span> ...
</span></span></foreignObject></svg></code></pre>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="14" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="14" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Regression tests with pytest</h1>
<pre><code class="language-py"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">from</span> pytest_regtest <span class="hljs-keyword">import</span> regtest

<span class="hljs-keyword">from</span> mycode <span class="hljs-keyword">import</span> myfunc

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_mycode</span>(<span class="hljs-params">regtest</span>):</span>

    result = myfunc(...)

    <span class="hljs-keyword">with</span> regtest:
        <span class="hljs-built_in">print</span>(result)
</span></span></foreignObject></svg></code></pre>
<p>We need to initialise and store the expected output the first time around.</p>
<pre><code class="language-sh"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>&gt; pytest --regtest-reset
</span></span></foreignObject></svg></code></pre>
<p>The results will go in <code>tests/_regtest_outputs/</code> which should be committed to version control.</p>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="15" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="15" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Regression tests with pytest</h1>
<p>Now, after trying to optimise the code, we can check we still get the right result using:</p>
<pre><code><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>&gt; pytest

============================================================================== test session starts ==============================================================================
platform darwin -- Python 3.9.5, pytest-6.2.4, py-1.10.0, pluggy-0.13.1
rootdir: /blaa/blaa/mycode
plugins: regtest-1.4.6
collected 1 item

tests/test_regressions.py .                                                                                                                                               [100%]

=============================================================================== 1 passed in 9.22s ===============================================================================
</span></span></foreignObject></svg></code></pre>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="16" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="16" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Regression tests with pytest-regtest</h1>
<p>If the output of the <code>press_schechter</code> function changes:</p>
<pre><code><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>&gt; pytest

============================================================================== test session starts ==============================================================================
platform darwin -- Python 3.9.5, pytest-6.2.4, py-1.10.0, pluggy-0.13.1
rootdir: /blaa/blaa/mycode
plugins: regtest-1.4.6
collected 1 item

tests/test_regressions.py F                                                                                                                                               [100%]

=================================================================================== FAILURES ====================================================================================
_____________________________________________________________________________ test_press_schechter ______________________________________________________________________________

regression test output differences for tests/test_regressions.py::test_mycode:

&gt;   --- current
&gt;   +++ tobe
&gt;   @@ -1,2 +1,2 @@
&gt;   -[[3943684.4663377525, 3433036.716787263, 2988666.7237358466, 2601939.030501016, 2265406.0334823187, 1972476.6100945876, 1717547.9139849006, 1495624.5560116607, 1302452.0154

...

============================================================================ short test summary info ============================================================================
FAILED tests/test_regressions.py::test_mycode
============================================================================== 1 failed in 10.03s ===============================================================================

</span></span></foreignObject></svg></code></pre>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="17" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-class="all-centered" data-theme="custom" class="all-centered" data-marpit-pagination="17" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--class:all-centered;--theme:custom;">
<h1></h1>
<h1><svg data-marp-fitting="svg"><foreignObject><span data-marp-fitting-svg-content> Let's go fast!</span></foreignObject></svg></h1>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="18" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="18" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Things to know about Python and speed</h1>
<h2>Python is an interpreted language and (almost) everything is an object</h2>
<p>This means there is a cost with looking up and accessing values.</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>a = <span class="hljs-number">8.0</span> 
<span class="hljs-built_in">print</span>(a)
</span></span></foreignObject></svg></code></pre>
<p>Translated to C this is actually something more like <em>(but in reality way more complicated!)</em>:</p>
<pre><code class="language-c"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">void</span> *a = (<span class="hljs-keyword">void</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">double</span>));
*(<span class="hljs-keyword">int</span>*)a = <span class="hljs-number">8.0</span>;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;{:g}\n&quot;</span>, *((<span class="hljs-keyword">int</span>*)a));
</span></span></foreignObject></svg></code></pre>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="19" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="19" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1><strong>The most important</strong> scientific python optimisation rule</h1>
<h4>For loops should be avoided if possible. Take advantage of Numpy's ufuncs (which will vectorize it and do it more efficiently).</h4>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>arr = np.arange(<span class="hljs-number">100_000</span>)

<span class="hljs-comment"># BAD: 165 ms  4.78 ms per loop (mean  std. dev. of 7 runs, 1 loop each)</span>
<span class="hljs-keyword">for</span> ii, val <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(arr):
    arr[ii] = np.sqrt(val)

<span class="hljs-comment"># GOOD: 147 s  2.51 s per loop (mean  std. dev. of 7 runs, 10000 loops each)</span>
arr = np.sqrt(arr)
</span></span></foreignObject></svg></code></pre>
<div data-marpit-fragment>
<p>147 s = 0.147 ms<br />
 x1,112 speed up !!! <img class="emoji" draggable="false" alt="" src="https://twemoji.maxcdn.com/2/svg/1f62e.svg" data-marp-twemoji=""/></p>
</div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="20" data-marpit-scope-0MUmmPRB="" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="20" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>An aside...</h1>
<h2>A common misconception:</h2>
<p>Numpy <code>vectorize</code> does not &quot;vectorize&quot; your code.</p>
<p class="nudge-down">From the docs:</p>
<p class="quote">&quot;The vectorize function is provided primarily for convenience, not for performance. The implementation is essentially a for loop.&quot;<br />
-- <em>Numpy docs</em></p>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-marpit-scope-Pxzzz0Mf="" data-marpit-fragments="1" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="21" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:33%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./assets/braden-collum-9HI8UJMSdZA-unsplash.jpg&quot;);"></figure></div></section></foreignObject><foreignObject width="67%" height="720"><section id="21" data-marpit-scope-Pxzzz0Mf="" data-marpit-fragments="1" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="21" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:33%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1>I've removed all the loops I can, but I still need more speed!!!</h1>

<p>There are a number of techniques and tools at our disposal. Which ones will work best is heavily dependent on the problem. e.g.:</p>
<ul>
<li>Use 3rd-party libraries which are already optimised!<br />
<strong>(I won't cover this, but it should always be your first stop.)</strong></li>
<li>Algorithmic changes (e.g. identifying redundant calculations).</li>
</ul>
<ul>
<li class="no-bullet" data-marpit-fragment="1"><img class="emoji" draggable="false" alt="" src="https://twemoji.maxcdn.com/2/svg/2b07.svg" data-marp-twemoji=""/> <strong>This is what we'll look at today.</strong> <img class="emoji" draggable="false" alt="" src="https://twemoji.maxcdn.com/2/svg/2b07.svg" data-marp-twemoji=""/> </li>
</ul>
<ul>
<li>Memoisation (caching of results for reuse later)</li>
<li>Dropping down to a lower level using <a href="https://numba.pydata.org/">Numba</a>, <a href="https://numba.pydata.org/">Cython</a>, etc.</li>
<li>Parallelisation</li>
</ul>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="21" data-marpit-pagination-total="32"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="22" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="22" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Memoisation</h1>
<h4>The idea</h4>
<p>Sometimes we have a function that may be called many times with the same input. In these situations it may be faster to store the results and reuse them rather than recalculating them each time.</p>
<h4>Works well when</h4>
<ul>
<li>You have an expensive function being called a number of times with the same input.</li>
<li>You have any non-trivial function being called many, many times with the same <em>small</em> input.</li>
</ul>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="23" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="23" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Memoisation</h1>
<h4>A (very contrived) example</h4>
<pre><code class="language-py"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

points = np.random.rand(<span class="hljs-number">10_000</span>, <span class="hljs-number">2</span>)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">myfunc</span>(<span class="hljs-params">x, y</span>):</span>
    <span class="hljs-keyword">return</span> (np.log10(np.sqrt(x**<span class="hljs-number">2</span> + y**<span class="hljs-number">2</span>) * <span class="hljs-number">5</span>) / <span class="hljs-number">0.2</span>)**<span class="hljs-number">6</span>

result = <span class="hljs-number">0.0</span>
<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):
    result += np.array([myfunc(x, y) <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> points])
</span></span></foreignObject></svg></code></pre>
<p><code>5.02 s  242 ms per loop (mean  std. dev. of 7 runs, 1 loop each)</code></p>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="24" data-paginate="true" data-footer="&lt;sup&gt;1&lt;/sup&gt; Don't do this!!!
https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="24" data-marpit-pagination-total="32" style="--paginate:true;--theme:custom;">
<h1>Memoisation</h1>
<h4>A (very contrived) example<sup>1</sup></h4>
<pre class="language-py"><code class="language-py"><span class="highlighted-line"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> cache</span>
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

points = np.random.rand(<span class="hljs-number">10_000</span>, <span class="hljs-number">2</span>)

<span class="highlighted-line"><span class="hljs-meta">@cache</span></span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">myfunc</span>(<span class="hljs-params">x, y</span>):</span>
    <span class="hljs-keyword">return</span> (np.log10(np.sqrt(x**<span class="hljs-number">2</span> + y**<span class="hljs-number">2</span>) * <span class="hljs-number">5</span>) / <span class="hljs-number">0.2</span>)**<span class="hljs-number">6</span>

result = <span class="hljs-number">0.0</span>
<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):
    result += np.array([myfunc(x, y) <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> points])</code></pre><p><code>1.28 s  423 ms per loop (mean  std. dev. of 7 runs, 1 loop each)</code></p>
<div style="margin-bottom: 40px;" data-marpit-fragment>
A factor of ~4 speed-up by adding 2 lines... Not bad!
</div>
<footer><sup>1</sup> Don't do this!!!<br />
<a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="25" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:20%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./assets/joblib_logo.svg&quot;);background-size:auto 200px;"></figure></div></section></foreignObject><foreignObject width="80%" height="720"><section id="25" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="25" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:20%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1>Memoisation</h1>

<h4>However...</h4>
<p><code>functools.cache</code> stores the result in RAM and needs to compare each input argument against the cached results.<br />
This works well when arguments and output are small e.g <code>float</code>s <code>int</code>s etc.</p>
<h4>joblib.Memory</h4>
<p>These limitations can be overcome in some cases with <a href="https://joblib.readthedocs.io/en/latest/memory.html#memory">joblib.Memory</a>.<br />
It caches to disk and removes much of the overhead with large input and out arrays.</p>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="25" data-marpit-pagination-total="32"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-marpit-scope-pUJF9wEg="" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="26" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:25%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="left"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./assets/verne-ho-5jfvhQPWtUo-unsplash.jpg&quot;);"></figure></div></section></foreignObject><foreignObject width="75%" height="720" x="25%"><section id="26" data-marpit-scope-pUJF9wEg="" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="26" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:25%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="left">
<h1>Going lower level...</h1>

<p>Sometimes the best way to improve the speed of our code is to use another language!... <img class="emoji" draggable="false" alt="" src="https://twemoji.maxcdn.com/2/svg/1f631.svg" data-marp-twemoji=""/></p>
<p>But fear not! This does not mean having to re-write your code in C/C++/Rust etc.</p>
<div style="margin-top: 30px" data-marpit-fragment>
<p><a href="https://numba.pydata.org/"><img src="./assets/numba-blue-horizontal-rgb.svg" alt="w:200px" style="width:200px;" /></a> A <strong>J</strong>ust <strong>I</strong>n <strong>T</strong>ime (JIT) compiler to machine code. It can be incredibly easy to use and provide great speed gains. It can also be used for GPU programming.</p>
</div>
<div data-marpit-fragment>
<p><a href="https://cython.readthedocs.io/en/latest/"><img src="./assets/cythonlogo.png" alt="w:200px" style="width:200px;" /></a> A python-superset language that can be used to create C efficient C extensions. As well as providing similar speed-ups to Numba (with a bit more effort), it can be used in more complex situations and also provides a great and flexible way to interface C libraries with Python.</p>
</div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="26" data-marpit-pagination-total="32"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="27" data-marpit-scope-ZSY2IwjI="" data-marpit-fragments="1" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="27" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Numba</h1>
<p>Using Numba can be incredibly easy:</p>
<pre><code class="language-py"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">import</span> numba
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-meta">@numba.njit</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">myfunc</span>(<span class="hljs-params">arr, n_loops</span>):</span>
    result = np.zeros(arr.shape[<span class="hljs-number">0</span>])
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n_loops):
        result += (np.log10(np.sqrt(arr[:, <span class="hljs-number">0</span>]**<span class="hljs-number">2</span> + arr[:, <span class="hljs-number">1</span>]**<span class="hljs-number">2</span>) * <span class="hljs-number">5</span>) / <span class="hljs-number">0.2</span>)**<span class="hljs-number">6</span>
    <span class="hljs-keyword">return</span> result

points = np.random.rand(<span class="hljs-number">10_000</span>, <span class="hljs-number">2</span>)
result = myfunc(points, <span class="hljs-number">100</span>)
</span></span></foreignObject></svg></code></pre>

<ul>
<li><code>njit</code> means compile in &quot;no-python&quot; mode. This requires the function to be simple and use only support functions and types (most of Numpy) but not Python classes or dicts.</li>
<li>Loops are encouraged! They will be optimised by LLVM (the compiler) for your CPU.</li>
</ul>
<ul>
<li data-marpit-fragment="1"><code>15.7 ms</code> with decorator vs. <code>42.5 ms</code> without <span data-marpit-fragment><strong>= ~2.5x speed-up</strong></span></li>
</ul>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="28" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="28" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Where Numba might not be enough<br />(WARNING: very subjective!)</h1>
<ul>
<li>It only supports a subset of Python + Numpy (although a very large one).</li>
<li>It can be hard to debug if things don't work as expected.</li>
<li>There isn't much scope for workarounds. If it doesn't &quot;just work&quot; then often it won't work.</li>
</ul>
<p><strong>Despite these, I definitely recommend Numba as the first-stop for speeding up numerical code!</strong></p>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="29" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="29" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Parallelisation</h1>
<p>Almost all computers have multiple cores. In some cases we can take advantage of this to speed up our calculations. Numpy &amp; Scipy actually do this for some functions without you necessarily realising.</p>
<p>This technique works well when:</p>
<ul>
<li>you have an expensive function</li>
<li>being called multiple times with different arguments</li>
<li>independently of each other.</li>
</ul>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="30" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="30" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Native parallelisation in Python is expensive</h1>
<h3>The GIL</h3>
<p>The Global Interpreter Lock (GIL) is a mutex which ensures only one thread can use the interpreter at any one time. It's a feature that makes Python simple and easy to use.<br />
But it's a hurdle to efficient parallelisation.</p>
<p>To get around this natively we can use the <a href="https://docs.python.org/3/library/multiprocessing.html">multiprocessing</a> standard library.<br />
It uses multiple processes, each running their own Python interpreter, with their own private memory space.<br />
<strong>But</strong> this is expensive, so we need to have enough work for each process to make it worthwhile.</p>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="31" data-marpit-scope-PIN6aX5o="" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="31" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>nogil</h1>
<p>As it turns out, Numba (does) and Cython (can) release the GIL! <img class="emoji" draggable="false" alt="" src="https://twemoji.maxcdn.com/2/svg/1f973.svg" data-marp-twemoji=""/></p>
<p>Numba can do it automatically in some cases (see <a href="https://numba.readthedocs.io/en/stable/user/parallel.html#">the docs</a>), but we can also manually request it:</p>
<pre class="language-py"><code class="language-py"><span class="hljs-keyword">import</span> numba
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="highlighted-line"><span class="hljs-meta">@numba.njit(<span class="hljs-params">parallel=<span class="hljs-literal">True</span></span>)</span></span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">myfunc</span>(<span class="hljs-params">arr, n_loops</span>):</span>
    result = np.zeros(arr.shape[<span class="hljs-number">0</span>])
<span class="highlighted-line">    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> numba.prange(n_loops):</span>        result += (np.log10(np.sqrt(arr[:, <span class="hljs-number">0</span>]**<span class="hljs-number">2</span> + arr[:, <span class="hljs-number">1</span>]**<span class="hljs-number">2</span>) * <span class="hljs-number">5</span>) / <span class="hljs-number">0.2</span>)**<span class="hljs-number">6</span>
    <span class="hljs-keyword">return</span> result

points = np.random.rand(<span class="hljs-number">10_000</span>, <span class="hljs-number">2</span>)
result = myfunc(points, <span class="hljs-number">10_000</span>)</code></pre><p>For more information and a good, flexible library for multiple different parallelisation backends, see <a href="https://joblib.readthedocs.io/en/latest/">joblib</a>.</p>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="32" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="32" data-marpit-pagination-total="32" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;"><footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
<script>!function(){"use strict";const t="marpitSVGPolyfill:setZoomFactor,",e=Symbol();let r,o;function n(n){const i="object"==typeof n&&n.target||document,a="object"==typeof n?n.zoom:n;window[e]||(Object.defineProperty(window,e,{configurable:!0,value:!0}),window.addEventListener("message",(({data:e,origin:r})=>{if(r===window.origin)try{if(e&&"string"==typeof e&&e.startsWith(t)){const[,t]=e.split(","),r=Number.parseFloat(t);Number.isNaN(r)||(o=r)}}catch(t){console.error(t)}})));let l=!1;Array.from(i.querySelectorAll("svg[data-marpit-svg]"),(t=>{var e,n,i,s;t.style.transform||(t.style.transform="translateZ(0)");const c=a||o||t.currentScale||1;r!==c&&(r=c,l=c);const d=t.getBoundingClientRect(),{length:u}=t.children;for(let r=0;r<u;r+=1){const o=t.children[r],a=o.getScreenCTM();if(a){const t=null!==(n=null===(e=o.x)||void 0===e?void 0:e.baseVal.value)&&void 0!==n?n:0,r=null!==(s=null===(i=o.y)||void 0===i?void 0:i.baseVal.value)&&void 0!==s?s:0,l=o.firstElementChild,{style:u}=l;u.transformOrigin||(u.transformOrigin=`${-t}px ${-r}px`),u.transform=`scale(${c}) matrix(${a.a}, ${a.b}, ${a.c}, ${a.d}, ${a.e-d.left}, ${a.f-d.top}) translateZ(0.0001px)`}}})),!1!==l&&Array.from(i.querySelectorAll("iframe"),(({contentWindow:e})=>{null==e||e.postMessage(`${t}${l}`,"null"===window.origin?"*":window.origin)}))}r=1,o=void 0;const i=(t,e,r)=>{if(t.getAttribute(e)!==r)return t.setAttribute(e,r),!0};function a({once:t=!1,target:e=document}={}){const r="Apple Computer, Inc."===navigator.vendor?[n]:[];let o=!t;const a=()=>{for(const t of r)t({target:e});!function(t=document){Array.from(t.querySelectorAll('svg[data-marp-fitting="svg"]'),(t=>{var e;const r=t.firstChild,o=r.firstChild,{scrollWidth:n,scrollHeight:a}=o;let l,s=1;if(t.hasAttribute("data-marp-fitting-code")&&(l=null===(e=t.parentElement)||void 0===e?void 0:e.parentElement),t.hasAttribute("data-marp-fitting-math")&&(l=t.parentElement),l){const t=getComputedStyle(l),e=Math.ceil(l.clientWidth-parseFloat(t.paddingLeft||"0")-parseFloat(t.paddingRight||"0"));e&&(s=e)}const c=Math.max(n,s),d=Math.max(a,1),u=`0 0 ${c} ${d}`;i(r,"width",`${c}`),i(r,"height",`${d}`),i(t,"preserveAspectRatio",getComputedStyle(t).getPropertyValue("--preserve-aspect-ratio")||"xMinYMin meet"),i(t,"viewBox",u)&&t.classList.toggle("__reflow__")}))}(e),o&&window.requestAnimationFrame(a)};return a(),()=>{o=!1}}const l=Symbol(),s=document.currentScript;((t=document)=>{if("undefined"==typeof window)throw new Error("Marp Core's browser script is valid only in browser context.");if(t[l])return t[l];const e=a({target:t}),r=()=>{e(),delete t[l]};Object.defineProperty(t,l,{configurable:!0,value:r})})(s?s.getRootNode():document)}();
</script></foreignObject></svg></div><div class="bespoke-marp-note" data-index="31" tabindex="0"><p>- ---

   - # test
   - 
   - &lt;div style=&quot;overflow: hidden;&quot;&gt;
   - &lt;div style=&quot;position: absolute;&quot; data-marpit-fragment&gt;
   - 
   - ![](./assets/chris-ried-ieic5Tq8YMk-unsplash.jpg)
   - 
   - &lt;/div&gt;
   - 
   - &lt;div style=&quot;position: absolute;&quot; data-marpit-fragment&gt;
   - 
   - ![blur:4px brightness:0.2 contrast:80%](./assets/chris-ried-ieic5Tq8YMk-unsplash.jpg)
   - 
   - &lt;/div&gt;
   - 
   - &lt;div style=&quot;position: absolute;&quot; data-marpit-fragment&gt;
   - 
   - ![](./assets/chris-ried-ieic5Tq8YMk-unsplash.jpg)
   - 
   - &lt;/div&gt;
   - 
   - &lt;/div&gt;</p></div><script>/*!! License: https://unpkg.com/@marp-team/marp-cli@1.1.1/lib/bespoke.js.LICENSE.txt */
!function(){"use strict";var e=function(e,t){var n,r=1===(e.parent||e).nodeType?e.parent||e:document.querySelector(e.parent||e),a=[].filter.call("string"==typeof e.slides?r.querySelectorAll(e.slides):e.slides||r.children,(function(e){return"SCRIPT"!==e.nodeName})),s={},i=function(e,t){return(t=t||{}).index=a.indexOf(e),t.slide=e,t},o=function(e,t){s[e]=(s[e]||[]).filter((function(e){return e!==t}))},l=function(e,t){return(s[e]||[]).reduce((function(e,n){return e&&!1!==n(t)}),!0)},c=function(e,t){a[e]&&(n&&l("deactivate",i(n,t)),n=a[e],l("activate",i(n,t)))},d=function(e,t){var r=a.indexOf(n)+e;l(e>0?"next":"prev",i(n,t))&&c(r,t)},u={off:o,on:function(e,t){return(s[e]||(s[e]=[])).push(t),o.bind(null,e,t)},fire:l,slide:function(e,t){if(!arguments.length)return a.indexOf(n);l("slide",i(a[e],t))&&c(e,t)},next:d.bind(null,1),prev:d.bind(null,-1),parent:r,slides:a,destroy:function(e){l("destroy",i(n,e)),s={}}};return(t||[]).forEach((function(e){e(u)})),n||c(0),u};function t(e){e.parent.classList.add("bespoke-marp-parent"),e.slides.forEach((e=>e.classList.add("bespoke-marp-slide"))),e.on("activate",(t=>{const n=t.slide,r=!n.classList.contains("bespoke-marp-active");e.slides.forEach((e=>{e.classList.remove("bespoke-marp-active"),e.setAttribute("aria-hidden","true")})),n.classList.add("bespoke-marp-active"),n.removeAttribute("aria-hidden"),r&&(n.classList.add("bespoke-marp-active-ready"),document.body.clientHeight,n.classList.remove("bespoke-marp-active-ready"))}))}function n(e){let t=0,n=0;Object.defineProperty(e,"fragments",{enumerable:!0,value:e.slides.map((e=>[null,...e.querySelectorAll("[data-marpit-fragment]")]))});const r=r=>void 0!==e.fragments[t][n+r],a=(r,a)=>{t=r,n=a,e.fragments.forEach(((e,t)=>{e.forEach(((e,n)=>{if(null==e)return;const s=t<r||t===r&&n<=a;e.setAttribute("data-bespoke-marp-fragment",s?"active":"inactive"),t===r&&n===a?e.setAttribute("data-bespoke-marp-current-fragment","current"):e.removeAttribute("data-bespoke-marp-current-fragment")}))})),e.fragmentIndex=a;const s={slide:e.slides[r],index:r,fragments:e.fragments[r],fragmentIndex:a};e.fire("fragment",s)};e.on("next",(({fragment:s=!0})=>{if(s){if(r(1))return a(t,n+1),!1;const s=t+1;e.fragments[s]&&a(s,0)}else{const r=e.fragments[t].length;if(n+1<r)return a(t,r-1),!1;const s=e.fragments[t+1];s&&a(t+1,s.length-1)}})),e.on("prev",(({fragment:s=!0})=>{if(r(-1)&&s)return a(t,n-1),!1;const i=t-1;e.fragments[i]&&a(i,e.fragments[i].length-1)})),e.on("slide",(({index:t,fragment:n})=>{let r=0;if(void 0!==n){const a=e.fragments[t];if(a){const{length:e}=a;r=-1===n?e-1:Math.min(Math.max(n,0),e-1)}}a(t,r)})),a(0,0)}var r,a={exports:{}};r=a,function(){var e="undefined"!=typeof window&&void 0!==window.document?window.document:{},t=r.exports,n=function(){for(var t,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,a=n.length,s={};r<a;r++)if((t=n[r])&&t[1]in e){for(r=0;r<t.length;r++)s[n[0][r]]=t[r];return s}return!1}(),a={change:n.fullscreenchange,error:n.fullscreenerror},s={request:function(t,r){return new Promise(function(a,s){var i=function(){this.off("change",i),a()}.bind(this);this.on("change",i);var o=(t=t||e.documentElement)[n.requestFullscreen](r);o instanceof Promise&&o.then(i).catch(s)}.bind(this))},exit:function(){return new Promise(function(t,r){if(this.isFullscreen){var a=function(){this.off("change",a),t()}.bind(this);this.on("change",a);var s=e[n.exitFullscreen]();s instanceof Promise&&s.then(a).catch(r)}else t()}.bind(this))},toggle:function(e,t){return this.isFullscreen?this.exit():this.request(e,t)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(t,n){var r=a[t];r&&e.addEventListener(r,n,!1)},off:function(t,n){var r=a[t];r&&e.removeEventListener(r,n,!1)},raw:n};n?(Object.defineProperties(s,{isFullscreen:{get:function(){return Boolean(e[n.fullscreenElement])}},element:{enumerable:!0,get:function(){return e[n.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(e[n.fullscreenEnabled])}}}),t?r.exports=s:window.screenfull=s):t?r.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}();var s=a.exports;function i(e){e.fullscreen=()=>{s.isEnabled&&s.toggle(document.body)},document.addEventListener("keydown",(t=>{"f"!==t.key&&"F11"!==t.key||t.altKey||t.ctrlKey||t.metaKey||!s.isEnabled||(e.fullscreen(),t.preventDefault())}))}function o(e=2e3){return t=>{let n;function r(){n&&clearTimeout(n),n=setTimeout((()=>{t.parent.classList.add("bespoke-marp-inactive"),t.fire("marp-inactive")}),e),t.parent.classList.contains("bespoke-marp-inactive")&&(t.parent.classList.remove("bespoke-marp-inactive"),t.fire("marp-active"))}document.addEventListener("mousedown",r),document.addEventListener("mousemove",r),document.addEventListener("touchend",r),setTimeout(r,0)}}const l=["AUDIO","BUTTON","INPUT","SELECT","TEXTAREA","VIDEO"];function c(e){e.parent.addEventListener("keydown",(e=>{if(!e.target)return;const t=e.target;(l.includes(t.nodeName)||"true"===t.contentEditable)&&e.stopPropagation()}))}function d(e){window.addEventListener("load",(()=>{for(const t of e.slides){const e=t.querySelector("[data-marp-fitting]")?"":"hideable";t.setAttribute("data-bespoke-marp-load",e)}}))}var u;function f({interval:e=250}={}){return t=>{document.addEventListener("keydown",(e=>{if(" "===e.key&&e.shiftKey)t.prev();else if("ArrowLeft"===e.key||"ArrowUp"===e.key||"PageUp"===e.key)t.prev({fragment:!e.shiftKey});else if(" "!==e.key||e.shiftKey)if("ArrowRight"===e.key||"ArrowDown"===e.key||"PageDown"===e.key)t.next({fragment:!e.shiftKey});else if("End"===e.key)t.slide(t.slides.length-1,{fragment:-1});else{if("Home"!==e.key)return;t.slide(0)}else t.next();e.preventDefault()}));let n,r,a=0;t.parent.addEventListener("wheel",(s=>{let i=!1;const o=(e,t)=>{e&&(i=i||function(e,t){return function(e,t){const n=t===u.X?"Width":"Height";return e[`client${n}`]<e[`scroll${n}`]}(e,t)&&function(e,t){const{overflow:n}=e,r=e[`overflow${t}`];return"auto"===n||"scroll"===n||"auto"===r||"scroll"===r}(getComputedStyle(e),t)}(e,t)),(null==e?void 0:e.parentElement)&&o(e.parentElement,t)};if(0!==s.deltaX&&o(s.target,u.X),0!==s.deltaY&&o(s.target,u.Y),i)return;s.preventDefault();const l=Math.sqrt(Math.pow(s.deltaX,2)+Math.pow(s.deltaY,2));if(void 0!==s.wheelDelta){if(void 0===s.webkitForce&&Math.abs(s.wheelDelta)<40)return;if(s.deltaMode===s.DOM_DELTA_PIXEL&&l<4)return}else if(s.deltaMode===s.DOM_DELTA_PIXEL&&l<12)return;r&&clearTimeout(r),r=setTimeout((()=>{n=0}),e);const c=Date.now()-a<e,d=l<=n;if(n=l,c||d)return;let f;(s.deltaX>0||s.deltaY>0)&&(f="next"),(s.deltaX<0||s.deltaY<0)&&(f="prev"),f&&(t[f](),a=Date.now())}))}}!function(e){e.X="X",e.Y="Y"}(u||(u={}));const p=(...e)=>history.replaceState(...e),m="data-bespoke-view",g="presenter",h="next",v=["",g,h],b=(e,{protocol:t,host:n,pathname:r,hash:a}=location)=>{const s=e.toString();return`${t}//${n}${r}${s?"?":""}${s}${a}`},w=()=>{const e=document.body.getAttribute(m);if(v.includes(e))return e;throw new Error("View mode is not assigned.")},y=e=>new URLSearchParams(location.search).get(e),k=(e,t={})=>{var n;const r=Object.assign({location:location,setter:p},t),a=new URLSearchParams(r.location.search);for(const t of Object.keys(e)){const n=e[t];"string"==typeof n?a.set(t,n):a.delete(t)}try{r.setter(Object.assign({},null!==(n=window.history.state)&&void 0!==n?n:{}),"",b(a,r.location))}catch(e){console.error(e)}},E={available:(()=>{try{return localStorage.setItem("bespoke-marp","bespoke-marp"),localStorage.removeItem("bespoke-marp"),!0}catch(e){return console.warn("Warning: Using localStorage is restricted in the current host so some features may not work."),!1}})(),get:e=>{try{return localStorage.getItem(e)}catch(e){return null}},set:(e,t)=>{try{return localStorage.setItem(e,t),!0}catch(e){return!1}},remove:e=>{try{return localStorage.removeItem(e),!0}catch(e){return!1}}};function x(e=".bespoke-marp-osc"){const t=document.querySelector(e);if(!t)return()=>{};const n=(e,n)=>{t.querySelectorAll(`[data-bespoke-marp-osc=${JSON.stringify(e)}]`).forEach(n)};return s.isEnabled||n("fullscreen",(e=>e.style.display="none")),E.available||n("presenter",(e=>{e.disabled=!0,e.title="Presenter view is disabled due to restricted localStorage."})),e=>{t.addEventListener("click",(t=>{if(t.target instanceof HTMLElement){const{bespokeMarpOsc:n}=t.target.dataset;switch(n&&t.target.blur(),n){case"next":e.next({fragment:!t.shiftKey});break;case"prev":e.prev({fragment:!t.shiftKey});break;case"fullscreen":"function"==typeof e.fullscreen&&s.isEnabled&&e.fullscreen();break;case"presenter":e.openPresenterView()}}})),e.parent.appendChild(t),e.on("activate",(({index:t})=>{n("page",(n=>n.textContent=`Page ${t+1} of ${e.slides.length}`))})),e.on("fragment",(({index:t,fragments:r,fragmentIndex:a})=>{n("prev",(e=>e.disabled=0===t&&0===a)),n("next",(n=>n.disabled=t===e.slides.length-1&&a===r.length-1))})),e.on("marp-active",(()=>t.removeAttribute("aria-hidden"))),e.on("marp-inactive",(()=>t.setAttribute("aria-hidden","true"))),s.isEnabled&&s.onchange((()=>n("fullscreen",(e=>e.classList.toggle("exit",s.isEnabled&&s.isFullscreen)))))}}function L(e){window.addEventListener("message",(t=>{if(t.origin!==window.origin)return;const[n,r]=t.data.split(":");if("navigate"===n){const[t,n]=r.split(",");let a=Number.parseInt(t,10),s=Number.parseInt(n,10)+1;s>=e.fragments[a].length&&(a+=1,s=0),e.slide(a,{fragment:s})}}))}function S(e){if(!(e=>e.syncKey&&"string"==typeof e.syncKey)(e))throw new Error("The current instance of Bespoke.js is invalid for Marp bespoke presenter plugin.");Object.defineProperties(e,{openPresenterView:{enumerable:!0,value:M},presenterUrl:{enumerable:!0,get:I}}),E.available&&document.addEventListener("keydown",(t=>{"p"!==t.key||t.altKey||t.ctrlKey||t.metaKey||(t.preventDefault(),e.openPresenterView())}))}function M(){const e=Math.max(Math.floor(.85*window.innerWidth),640),t=Math.max(Math.floor(.85*window.innerHeight),360);return window.open(this.presenterUrl,`bespoke-marp-presenter-${this.syncKey}`,`width=${e},height=${t},menubar=no,toolbar=no`)}function I(){const e=new URLSearchParams(location.search);return e.set("view","presenter"),e.set("sync",this.syncKey),b(e)}var P=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];let O=e=>String(e).replace(/[&<>"']/g,(e=>`&${F[e]};`)),F={"&":"amp","<":"lt",">":"gt",'"':"quot","'":"apos"},$="dangerouslySetInnerHTML",A={className:"class",htmlFor:"for"},T={};function q(e,t){let n=[],r="";t=t||{};for(let e=arguments.length;e-- >2;)n.push(arguments[e]);if("function"==typeof e)return t.children=n.reverse(),e(t);if(e){if(r+="<"+e,t)for(let e in t)!1!==t[e]&&null!=t[e]&&e!==$&&(r+=` ${A[e]?A[e]:O(e)}="${O(t[e])}"`);r+=">"}if(-1===P.indexOf(e)){if(t[$])r+=t[$].__html;else for(;n.length;){let e=n.pop();if(e)if(e.pop)for(let t=e.length;t--;)n.push(e[t]);else r+=!0===T[e]?e:O(e)}r+=e?`</${e}>`:""}return T[r]=!0,r}const K=({children:e})=>q(null,null,...e),N="bespoke-marp-presenter-container",C="bespoke-marp-presenter-next",D="bespoke-marp-presenter-next-container",j="bespoke-marp-presenter-note-container",X="bespoke-marp-presenter-info-container",R="bespoke-marp-presenter-info-page",U="bespoke-marp-presenter-info-page-text",B="bespoke-marp-presenter-info-page-prev",V="bespoke-marp-presenter-info-page-next",Y="bespoke-marp-presenter-info-time",H="bespoke-marp-presenter-info-timer";function z(e){const{title:t}=document;document.title="[Presenter view]"+(t?` - ${t}`:"");const n={},r=e=>(n[e]=n[e]||document.querySelector(`.${e}`),n[e]);document.body.appendChild((e=>{const t=document.createElement("div");return t.className=N,t.appendChild(e),t.insertAdjacentHTML("beforeend",q(K,null,q("div",{class:D},q("iframe",{class:C,src:"?view=next"})),q("div",{class:j}),q("div",{class:X},q("div",{class:R},q("button",{class:B,tabindex:"-1",title:"Previous"},"Previous"),q("span",{class:U}),q("button",{class:V,tabindex:"-1",title:"Next"},"Next")),q("time",{class:Y,title:"Current time"}),q("div",{class:H})))),t})(e.parent)),(e=>{r(D).addEventListener("click",(()=>e.next()));const t=r(C),n=(a=t,(e,t)=>{var n;return null===(n=a.contentWindow)||void 0===n?void 0:n.postMessage(`navigate:${e},${t}`,"null"===window.origin?"*":window.origin)});var a;t.addEventListener("load",(()=>{r(D).classList.add("active"),n(e.slide(),e.fragmentIndex),e.on("fragment",(({index:e,fragmentIndex:t})=>n(e,t)))}));const s=document.querySelectorAll(".bespoke-marp-note");s.forEach((e=>{e.addEventListener("keydown",(e=>e.stopPropagation())),r(j).appendChild(e)})),e.on("activate",(()=>s.forEach((t=>t.classList.toggle("active",t.dataset.index==e.slide()))))),e.on("activate",(({index:t})=>{r(U).textContent=`${t+1} / ${e.slides.length}`}));const i=r(B),o=r(V);i.addEventListener("click",(t=>{i.blur(),e.prev({fragment:!t.shiftKey})})),o.addEventListener("click",(t=>{o.blur(),e.next({fragment:!t.shiftKey})})),e.on("fragment",(({index:t,fragments:n,fragmentIndex:r})=>{i.disabled=0===t&&0===r,o.disabled=t===e.slides.length-1&&r===n.length-1}));const l=()=>r(Y).textContent=(new Date).toLocaleTimeString();l(),setInterval(l,250)})(e)}function _(e){const t=w();return t===h&&e.appendChild(document.createElement("span")),{"":S,[g]:z,[h]:L}[t]}function J(e){e.on("activate",(t=>{document.querySelectorAll(".bespoke-progress-parent > .bespoke-progress-bar").forEach((n=>{n.style.flexBasis=100*t.index/(e.slides.length-1)+"%"}))}))}const W=e=>{const t=Number.parseInt(e,10);return Number.isNaN(t)?null:t};function G(e={}){const t=Object.assign({history:!0},e);return e=>{let n=!0;const r=e=>{const t=n;try{return n=!0,e()}finally{n=t}},a=(t={fragment:!0})=>{((t,n)=>{const{fragments:r,slides:a}=e,s=Math.max(0,Math.min(t,a.length-1)),i=Math.max(0,Math.min(n||0,r[s].length-1));s===e.slide()&&i===e.fragmentIndex||e.slide(s,{fragment:i})})((W(location.hash.slice(1))||1)-1,t.fragment?W(y("f")||""):null)};e.on("fragment",(({index:e,fragmentIndex:r})=>{n||k({f:0===r||r.toString()},{location:Object.assign(Object.assign({},location),{hash:`#${e+1}`}),setter:(...e)=>t.history?history.pushState(...e):history.replaceState(...e)})})),setTimeout((()=>{a(),window.addEventListener("hashchange",(()=>r((()=>{a({fragment:!1}),k({f:void 0})})))),window.addEventListener("popstate",(()=>{n||r((()=>a()))})),n=!1}),0)}}function Q(e={}){var t;const n=e.key||(null===(t=window.history.state)||void 0===t?void 0:t.marpBespokeSyncKey)||Math.random().toString(36).slice(2),r=`bespoke-marp-sync-${n}`;var a;a={marpBespokeSyncKey:n},k({},{setter:(e,...t)=>p(Object.assign(Object.assign({},e),a),...t)});const s=()=>{const e=E.get(r);return e?JSON.parse(e):Object.create(null)},i=e=>{const t=s(),n=Object.assign(Object.assign({},t),e(t));return E.set(r,JSON.stringify(n)),n},o=()=>{window.removeEventListener("pageshow",o),i((e=>({reference:(e.reference||0)+1})))};return e=>{o(),Object.defineProperty(e,"syncKey",{value:n,enumerable:!0});let t=!0;setTimeout((()=>{e.on("fragment",(e=>{t&&i((()=>({index:e.index,fragmentIndex:e.fragmentIndex})))}))}),0),window.addEventListener("storage",(n=>{if(n.key===r&&n.oldValue&&n.newValue){const r=JSON.parse(n.oldValue),a=JSON.parse(n.newValue);if(r.index!==a.index||r.fragmentIndex!==a.fragmentIndex)try{t=!1,e.slide(a.index,{fragment:a.fragmentIndex})}finally{t=!0}}}));const a=()=>{const{reference:e}=s();void 0===e||e<=1?E.remove(r):i((()=>({reference:e-1})))};window.addEventListener("pagehide",(e=>{e.persisted&&window.addEventListener("pageshow",o),a()})),e.on("destroy",a)}}function Z({slope:e=Math.tan(-35*Math.PI/180),swipeThreshold:t=30}={}){return n=>{let r;const a=n.parent,s=e=>{const t=a.getBoundingClientRect();return{x:e.pageX-(t.left+t.right)/2,y:e.pageY-(t.top+t.bottom)/2}};a.addEventListener("touchstart",(e=>{r=1===e.touches.length?s(e.touches[0]):void 0}),{passive:!0}),a.addEventListener("touchmove",(e=>{if(r)if(1===e.touches.length){e.preventDefault();const t=s(e.touches[0]),n=t.x-r.x,a=t.y-r.y;r.delta=Math.sqrt(Math.pow(Math.abs(n),2)+Math.pow(Math.abs(a),2)),r.radian=Math.atan2(n,a)}else r=void 0})),a.addEventListener("touchend",(a=>{if(r){if(r.delta&&r.delta>=t&&r.radian){let t=r.radian-e;t=(t+Math.PI)%(2*Math.PI)-Math.PI,n[t<0?"next":"prev"](),a.stopPropagation()}r=void 0}}),{passive:!0})}}function ee(e,t,n,r){return new(n||(n=Promise))((function(a,s){function i(e){try{l(r.next(e))}catch(e){s(e)}}function o(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))}let te;const ne=()=>(void 0===te&&(te="wakeLock"in navigator&&navigator.wakeLock),te),re=()=>ee(void 0,void 0,void 0,(function*(){const e=ne();if(e)try{return yield e.request("screen")}catch(e){console.warn(e)}return null}));function ae(){return ee(this,void 0,void 0,(function*(){if(!ne())return;let e;const t=()=>{e&&"visible"===document.visibilityState&&re()};return document.addEventListener("visibilitychange",t),document.addEventListener("fullscreenchange",t),e=yield re(),e}))}!function(r=document.getElementById("p")){document.body.setAttribute(m,(()=>{const e=y("view");return e===h||e===g?e:""})());const a=(e=>{const t=y(e);return k({[e]:void 0}),t})("sync")||void 0,s=!1,l=!0;e(r,((...e)=>{const t=v.findIndex((e=>w()===e));if(t<0)throw new Error("Invalid view");return e.map((([e,n])=>e[t]&&n)).filter((e=>e))})([[l,l,s],Q({key:a})],[[l,l,l],_(r)],[[l,l,s],c],[[l,l,l],t],[[l,s,s],o()],[[l,l,l],d],[[l,l,l],G({history:!1})],[[l,l,s],f()],[[l,l,s],i],[[l,s,s],J],[[l,l,s],Z()],[[l,s,s],x()],[[l,l,l],n],[[l,l,s],ae]))}()}();</script></body></html>