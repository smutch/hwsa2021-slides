<!DOCTYPE html><html lang="en-US"><head><title>HWSA 2021 - Optimising Python code</title><meta property="og:title" content="HWSA 2021 - Optimising Python code"><meta property="og:image:alt" content="HWSA 2021 - Optimising Python code"><meta name="description" content="Slides for the practical session of the 2021 HWSA"><meta property="og:description" content="Slides for the practical session of the 2021 HWSA"><link rel="canonical" href="https://smutch.github.io/hwsa2021-slides"><meta property="og:url" content="https://smutch.github.io/hwsa2021-slides"><meta property="og:image" content="https://smutch.github.io/hwsa2021-slides/og-image.jpg"><meta charset="UTF-8"><meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta property="og:type" content="website"><meta name="twitter:card" content="summary_large_image"><style>@media screen{body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{-webkit-tap-highlight-color:transparent;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:0;color:inherit;cursor:pointer;font-size:inherit;opacity:80%;outline:none;padding:0;transition:opacity .2s linear}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:disabled{cursor:not-allowed;opacity:15%!important}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover{opacity:100%}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:active{opacity:60%}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:not(:disabled){transition:none}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-prev{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNNjggOTAgMjggNTBsNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-next{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJtMzIgOTAgNDAtNDAtNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTQwIDcwSDIwVjUwbTIwIDBMMjAgNzBtNDAtNDBoMjB2MjBtLTIwIDAgMjAtMjAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen]{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTIwIDUwaDIwdjIwbS0yMCAwIDIwLTIwbTQwIDBINjBWMzBtMjAgMEw2MCA1MCIvPjwvc3ZnPg==")}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBkPSJNODcuOCA0Ny41Qzg5IDUwIDg3LjcgNTIgODUgNTJIMzVhOC43IDguNyAwIDAgMS03LjItNC41bC0xNS42LTMxQzExIDE0IDEyLjIgMTIgMTUgMTJoNTBhOC44IDguOCAwIDAgMSA3LjIgNC41ek02MCA1MnYzNm0tMTAgMGgyME00NSA0MmgyMCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZmZmIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iNSIvPjwvc3ZnPg==") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}}.bespoke-marp-note,.bespoke-marp-osc,.bespoke-progress-parent{display:none;transition:none}@media screen{body,html{height:100%;margin:0}body{background:#000;overflow:hidden}svg.bespoke-marp-slide{content-visibility:hidden;opacity:0;pointer-events:none;z-index:-1}svg.bespoke-marp-slide.bespoke-marp-active{content-visibility:visible;opacity:100%;pointer-events:auto;z-index:0}svg.bespoke-marp-slide.bespoke-marp-active.bespoke-marp-active-ready *{-webkit-animation-name:__bespoke_marp__!important;animation-name:__bespoke_marp__!important}@supports not (content-visibility:hidden){svg.bespoke-marp-slide[data-bespoke-marp-load=hideable]{display:none}svg.bespoke-marp-slide[data-bespoke-marp-load=hideable].bespoke-marp-active{display:block}}[data-bespoke-marp-fragment=inactive]{visibility:hidden}body[data-bespoke-view=""] .bespoke-marp-parent,body[data-bespoke-view=next] .bespoke-marp-parent{bottom:0;left:0;position:absolute;right:0;top:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc{background:rgba(0,0,0,.65);border-radius:7px;bottom:50px;color:#fff;contain:paint;display:block;font-family:Helvetica,Arial,sans-serif;font-size:16px;left:50%;line-height:0;opacity:100%;padding:12px;position:absolute;touch-action:manipulation;transform:translateX(-50%);transition:opacity .2s linear;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;will-change:transform;z-index:1}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>*,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>*{margin-left:6px}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>:first-child,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>:first-child{margin-left:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span{opacity:80%}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page]{display:inline-block;min-width:140px;text-align:center}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev]{height:32px;line-height:32px;width:32px}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive{cursor:none}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc{opacity:0;pointer-events:none}body[data-bespoke-view=""] svg.bespoke-marp-slide,body[data-bespoke-view=next] svg.bespoke-marp-slide{height:100%;left:0;position:absolute;top:0;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent{background:#222;display:flex;height:5px;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent+.bespoke-marp-parent{top:5px}body[data-bespoke-view=""] .bespoke-progress-parent .bespoke-progress-bar{background:#0288d1;flex:0 0 0;transition:flex-basis .2s cubic-bezier(0,1,1,1)}body[data-bespoke-view=next]{background:transparent}body[data-bespoke-view=presenter]{background:#161616}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container{display:grid;font-family:Helvetica,Arial,sans-serif;grid-template:"current next" minmax(140px,1fr) "current note" 2fr "info    note" 3em/2fr 1fr;height:100%;left:0;position:absolute;top:0;width:100%}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent{grid-area:current;overflow:hidden;position:relative}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide{height:calc(100% - 40px);left:20px;pointer-events:none;position:absolute;top:20px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide.bespoke-marp-active{filter:drop-shadow(0 3px 10px rgba(0,0,0,.5))}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container{background:#222;cursor:pointer;display:none;grid-area:next;overflow:hidden;position:relative}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container iframe.bespoke-marp-presenter-next{background:transparent;border:0;display:block;filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));height:calc(100% - 40px);left:20px;pointer-events:none;position:absolute;top:20px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container{background:#222;color:#eee;grid-area:note}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note{word-wrap:break-word;box-sizing:border-box;font-size:1.1em;height:calc(100% - 40px);margin:20px;overflow:auto;padding-right:3px;scrollbar-color:hsla(0,0%,93%,.5) transparent;scrollbar-width:thin;white-space:pre-wrap;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar{width:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-track{background:transparent}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-thumb{background:hsla(0,0%,93%,.5);border-radius:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note:empty{pointer-events:none}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:first-child{margin-top:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:last-child{margin-bottom:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container{align-items:center;box-sizing:border-box;color:#eee;display:flex;flex-wrap:nowrap;grid-area:info;justify-content:center;padding:0 10px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{box-sizing:border-box;display:block;padding:0 10px;white-space:nowrap;width:100%}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{height:1.5em;line-height:1.5em;width:1.5em}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page{order:2;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page .bespoke-marp-presenter-info-page-text{display:inline-block;min-width:120px;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time{color:#999;order:1;text-align:left}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{color:#999;order:3;text-align:right}}@media print{.bespoke-marp-presenter-info-container,.bespoke-marp-presenter-next-container,.bespoke-marp-presenter-note-container{display:none}}</style><style>div#p>svg>foreignObject>section{width:1280px;height:720px;box-sizing:border-box;overflow:hidden;position:relative;scroll-snap-align:center center}div#p>svg>foreignObject>section:after{bottom:0;content:attr(data-marpit-pagination);padding:inherit;pointer-events:none;position:absolute;right:0}div#p>svg>foreignObject>section:not([data-marpit-pagination]):after{display:none}/* Normalization */div#p>svg>foreignObject>section h1{font-size:2em;margin:0.67em 0}div#p>svg>foreignObject>section video::-webkit-media-controls{will-change:transform}@page{size:1280px 720px;margin:0}@media print{body,html{background-color:#fff;margin:0;page-break-inside:avoid;break-inside:avoid-page}div#p>svg>foreignObject>section{page-break-before:always;break-before:page}div#p>svg>foreignObject>section,div#p>svg>foreignObject>section *{-webkit-print-color-adjust:exact!important;animation-delay:0s!important;animation-duration:0s!important;color-adjust:exact!important;transition:none!important}div#p>svg[data-marpit-svg]{display:block;height:100vh;width:100vw}}
/*!
 * Marp default theme.
 *
 * @theme default
 * @author Yuki Hattori
 *
 * @auto-scaling true
 * @size 16:9 1280px 720px
 * @size 4:3 960px 720px
 */div#p>svg>foreignObject>section{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;word-wrap:break-word;background-color:#fff;color:#24292f;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;margin:0}div#p>svg>foreignObject>section{--marpit-root-font-size:16px}div#p>svg>foreignObject>section .octicon{fill:currentColor;display:inline-block;vertical-align:text-bottom}div#p>svg>foreignObject>section h1:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h2:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h3:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h4:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h5:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h6:hover .anchor .octicon-link:before{background-color:currentColor;content:" ";display:inline-block;height:16px;-webkit-mask-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 0 0 1.06 1.06l1.25-1.25a2 2 0 1 1 2.83 2.83l-2.5 2.5a2 2 0 0 1-2.83 0 .75.75 0 0 0-1.06 1.06 3.5 3.5 0 0 0 4.95 0l2.5-2.5a3.5 3.5 0 0 0-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 0 1 0-2.83l2.5-2.5a2 2 0 0 1 2.83 0 .75.75 0 0 0 1.06-1.06 3.5 3.5 0 0 0-4.95 0l-2.5 2.5a3.5 3.5 0 0 0 4.95 4.95l1.25-1.25a.75.75 0 0 0-1.06-1.06l-1.25 1.25a2 2 0 0 1-2.83 0z"/></svg>');mask-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 0 0 1.06 1.06l1.25-1.25a2 2 0 1 1 2.83 2.83l-2.5 2.5a2 2 0 0 1-2.83 0 .75.75 0 0 0-1.06 1.06 3.5 3.5 0 0 0 4.95 0l2.5-2.5a3.5 3.5 0 0 0-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 0 1 0-2.83l2.5-2.5a2 2 0 0 1 2.83 0 .75.75 0 0 0 1.06-1.06 3.5 3.5 0 0 0-4.95 0l-2.5 2.5a3.5 3.5 0 0 0 4.95 4.95l1.25-1.25a.75.75 0 0 0-1.06-1.06l-1.25 1.25a2 2 0 0 1-2.83 0z"/></svg>');width:16px}div#p>svg>foreignObject>section details,div#p>svg>foreignObject>section figcaption,div#p>svg>foreignObject>section figure{display:block}div#p>svg>foreignObject>section summary{display:list-item}div#p>svg>foreignObject>section a{background-color:transparent;color:#0969da;text-decoration:none}div#p>svg>foreignObject>section a:active,div#p>svg>foreignObject>section a:hover{outline-width:0}div#p>svg>foreignObject>section abbr[title]{border-bottom:none;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}div#p>svg>foreignObject>section b,div#p>svg>foreignObject>section strong{font-weight:600}div#p>svg>foreignObject>section dfn{font-style:italic}div#p>svg>foreignObject>section h1{border-bottom:1px solid #d8dee4;font-size:2em;font-weight:600;margin:.67em 0;padding-bottom:.3em}div#p>svg>foreignObject>section mark{background-color:#ff0;color:#24292f}div#p>svg>foreignObject>section small{font-size:90%}div#p>svg>foreignObject>section sub,div#p>svg>foreignObject>section sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}div#p>svg>foreignObject>section sub{bottom:-.25em}div#p>svg>foreignObject>section sup{top:-.5em}div#p>svg>foreignObject>section img{background-color:#fff;border-style:none;box-sizing:content-box;max-width:100%}div#p>svg>foreignObject>section code,div#p>svg>foreignObject>section kbd,div#p>svg>foreignObject>section pre,div#p>svg>foreignObject>section samp{font-family:monospace,monospace;font-size:1em}div#p>svg>foreignObject>section figure{margin:1em 40px}div#p>svg>foreignObject>section hr{background:transparent;background-color:#d0d7de;border:0;box-sizing:content-box;height:.25em;margin:24px 0;overflow:hidden;padding:0}div#p>svg>foreignObject>section [type=reset],div#p>svg>foreignObject>section [type=submit],div#p>svg>foreignObject>section html [type=button]{-webkit-appearance:button}div#p>svg>foreignObject>section [type=button]::-moz-focus-inner,div#p>svg>foreignObject>section [type=reset]::-moz-focus-inner,div#p>svg>foreignObject>section [type=submit]::-moz-focus-inner{border-style:none;padding:0}div#p>svg>foreignObject>section [type=button]:-moz-focusring,div#p>svg>foreignObject>section [type=reset]:-moz-focusring,div#p>svg>foreignObject>section [type=submit]:-moz-focusring{outline:1px dotted ButtonText}div#p>svg>foreignObject>section [type=checkbox],div#p>svg>foreignObject>section [type=radio]{box-sizing:border-box;padding:0}div#p>svg>foreignObject>section [type=number]::-webkit-inner-spin-button,div#p>svg>foreignObject>section [type=number]::-webkit-outer-spin-button{height:auto}div#p>svg>foreignObject>section [type=search]{-webkit-appearance:textfield;outline-offset:-2px}div#p>svg>foreignObject>section [type=search]::-webkit-search-cancel-button,div#p>svg>foreignObject>section [type=search]::-webkit-search-decoration{-webkit-appearance:none}div#p>svg>foreignObject>section ::-webkit-input-placeholder{color:inherit;opacity:.54}div#p>svg>foreignObject>section ::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}div#p>svg>foreignObject>section a:hover{text-decoration:underline}div#p>svg>foreignObject>section hr:after,div#p>svg>foreignObject>section hr:before{content:"";display:table}div#p>svg>foreignObject>section hr:after{clear:both}div#p>svg>foreignObject>section table{border-collapse:collapse;border-spacing:0;display:block;max-width:100%;overflow:auto;width:-webkit-max-content;width:-moz-max-content;width:max-content}div#p>svg>foreignObject>section td,div#p>svg>foreignObject>section th{padding:0}div#p>svg>foreignObject>section details summary{cursor:pointer}div#p>svg>foreignObject>section details:not([open])>:not(summary){display:none!important}div#p>svg>foreignObject>section kbd{background-color:#f6f8fa;border:1px solid rgba(175,184,193,.2);border-radius:6px;box-shadow:inset 0 -1px 0 rgba(175,184,193,.2);color:#24292f;display:inline-block;font:11px ui-monospace,SFMono-Regular,SF Mono,Menlo,Consolas,Liberation Mono,monospace;line-height:10px;padding:3px 5px;vertical-align:middle}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2,div#p>svg>foreignObject>section h3,div#p>svg>foreignObject>section h4,div#p>svg>foreignObject>section h5,div#p>svg>foreignObject>section h6{font-weight:600;line-height:1.25;margin-bottom:16px;margin-top:24px}div#p>svg>foreignObject>section h2{border-bottom:1px solid #d8dee4;font-size:1.5em;font-weight:600;padding-bottom:.3em}div#p>svg>foreignObject>section h3{font-size:1.25em;font-weight:600}div#p>svg>foreignObject>section h4{font-size:1em;font-weight:600}div#p>svg>foreignObject>section h5{font-size:.875em;font-weight:600}div#p>svg>foreignObject>section h6{color:#57606a;font-size:.85em;font-weight:600}div#p>svg>foreignObject>section p{margin-bottom:10px;margin-top:0}div#p>svg>foreignObject>section blockquote{border-left:.25em solid #d0d7de;color:#57606a;margin:0;padding:0 1em}div#p>svg>foreignObject>section ol,div#p>svg>foreignObject>section ul{margin-bottom:0;margin-top:0;padding-left:2em}div#p>svg>foreignObject>section ol ol,div#p>svg>foreignObject>section ul ol{list-style-type:lower-roman}div#p>svg>foreignObject>section ol ol ol,div#p>svg>foreignObject>section ol ul ol,div#p>svg>foreignObject>section ul ol ol,div#p>svg>foreignObject>section ul ul ol{list-style-type:lower-alpha}div#p>svg>foreignObject>section dd{margin-left:0}div#p>svg>foreignObject>section code,div#p>svg>foreignObject>section pre,div#p>svg>foreignObject>section tt{font-family:ui-monospace,SFMono-Regular,SF Mono,Menlo,Consolas,Liberation Mono,monospace;font-size:12px}div#p>svg>foreignObject>section pre{word-wrap:normal;margin-bottom:0;margin-top:0}div#p>svg>foreignObject>section :-ms-input-placeholder{color:#6e7781;opacity:1}div#p>svg>foreignObject>section ::-moz-placeholder{color:#6e7781;opacity:1}div#p>svg>foreignObject>section ::placeholder{color:#6e7781;opacity:1}div#p>svg>foreignObject>section .pl-c{color:#6e7781}div#p>svg>foreignObject>section .pl-c1,div#p>svg>foreignObject>section .pl-s .pl-v{color:#0550ae}div#p>svg>foreignObject>section .pl-e,div#p>svg>foreignObject>section .pl-en{color:#8250df}div#p>svg>foreignObject>section .pl-s .pl-s1,div#p>svg>foreignObject>section .pl-smi{color:#24292f}div#p>svg>foreignObject>section .pl-ent{color:#116329}div#p>svg>foreignObject>section .pl-k{color:#cf222e}div#p>svg>foreignObject>section .pl-pds,div#p>svg>foreignObject>section .pl-s,div#p>svg>foreignObject>section .pl-s .pl-pse .pl-s1,div#p>svg>foreignObject>section .pl-sr,div#p>svg>foreignObject>section .pl-sr .pl-cce,div#p>svg>foreignObject>section .pl-sr .pl-sra,div#p>svg>foreignObject>section .pl-sr .pl-sre{color:#0a3069}div#p>svg>foreignObject>section .pl-smw,div#p>svg>foreignObject>section .pl-v{color:#953800}div#p>svg>foreignObject>section .pl-bu{color:#82071e}div#p>svg>foreignObject>section .pl-ii{background-color:#82071e;color:#f6f8fa}div#p>svg>foreignObject>section .pl-c2{background-color:#cf222e;color:#f6f8fa}div#p>svg>foreignObject>section .pl-sr .pl-cce{color:#116329;font-weight:700}div#p>svg>foreignObject>section .pl-ml{color:#3b2300}div#p>svg>foreignObject>section .pl-mh,div#p>svg>foreignObject>section .pl-mh .pl-en,div#p>svg>foreignObject>section .pl-ms{color:#0550ae;font-weight:700}div#p>svg>foreignObject>section .pl-mi{color:#24292f;font-style:italic}div#p>svg>foreignObject>section .pl-mb{color:#24292f;font-weight:700}div#p>svg>foreignObject>section .pl-md{background-color:#ffebe9;color:#82071e}div#p>svg>foreignObject>section .pl-mi1{background-color:#dafbe1;color:#116329}div#p>svg>foreignObject>section .pl-mc{background-color:#ffd8b5;color:#953800}div#p>svg>foreignObject>section .pl-mi2{background-color:#0550ae;color:#eaeef2}div#p>svg>foreignObject>section .pl-mdr{color:#8250df;font-weight:700}div#p>svg>foreignObject>section .pl-ba{color:#57606a}div#p>svg>foreignObject>section .pl-sg{color:#8c959f}div#p>svg>foreignObject>section .pl-corl{color:#0a3069;text-decoration:underline}div#p>svg>foreignObject>section [data-catalyst]{display:block}div#p>svg>foreignObject>section g-emoji{font-family:Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;font-size:1em;font-style:normal!important;font-weight:400;line-height:1;vertical-align:-.075em}div#p>svg>foreignObject>section g-emoji img{height:1em;width:1em}div#p>svg>foreignObject>section:after,div#p>svg>foreignObject>section:before{
  /* content:""; */display:table}div#p>svg>foreignObject>section:after{clear:both}div#p>svg>foreignObject>section>:first-child{margin-top:0!important}div#p>svg>foreignObject>section>:last-child{margin-bottom:0!important}div#p>svg>foreignObject>section a:not([href]){color:inherit;text-decoration:none}div#p>svg>foreignObject>section .absent{color:#cf222e}div#p>svg>foreignObject>section .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}div#p>svg>foreignObject>section .anchor:focus{outline:none}div#p>svg>foreignObject>section blockquote,div#p>svg>foreignObject>section details,div#p>svg>foreignObject>section dl,div#p>svg>foreignObject>section ol,div#p>svg>foreignObject>section p,div#p>svg>foreignObject>section pre,div#p>svg>foreignObject>section table,div#p>svg>foreignObject>section ul{margin-bottom:16px;margin-top:0}div#p>svg>foreignObject>section blockquote>:first-child{margin-top:0}div#p>svg>foreignObject>section blockquote>:last-child{margin-bottom:0}div#p>svg>foreignObject>section sup>a:before{content:"["}div#p>svg>foreignObject>section sup>a:after{content:"]"}div#p>svg>foreignObject>section h1 .octicon-link,div#p>svg>foreignObject>section h2 .octicon-link,div#p>svg>foreignObject>section h3 .octicon-link,div#p>svg>foreignObject>section h4 .octicon-link,div#p>svg>foreignObject>section h5 .octicon-link,div#p>svg>foreignObject>section h6 .octicon-link{color:#24292f;vertical-align:middle;visibility:hidden}div#p>svg>foreignObject>section h1:hover .anchor,div#p>svg>foreignObject>section h2:hover .anchor,div#p>svg>foreignObject>section h3:hover .anchor,div#p>svg>foreignObject>section h4:hover .anchor,div#p>svg>foreignObject>section h5:hover .anchor,div#p>svg>foreignObject>section h6:hover .anchor{text-decoration:none}div#p>svg>foreignObject>section h1:hover .anchor .octicon-link,div#p>svg>foreignObject>section h2:hover .anchor .octicon-link,div#p>svg>foreignObject>section h3:hover .anchor .octicon-link,div#p>svg>foreignObject>section h4:hover .anchor .octicon-link,div#p>svg>foreignObject>section h5:hover .anchor .octicon-link,div#p>svg>foreignObject>section h6:hover .anchor .octicon-link{visibility:visible}div#p>svg>foreignObject>section h1 code,div#p>svg>foreignObject>section h1 tt,div#p>svg>foreignObject>section h2 code,div#p>svg>foreignObject>section h2 tt,div#p>svg>foreignObject>section h3 code,div#p>svg>foreignObject>section h3 tt,div#p>svg>foreignObject>section h4 code,div#p>svg>foreignObject>section h4 tt,div#p>svg>foreignObject>section h5 code,div#p>svg>foreignObject>section h5 tt,div#p>svg>foreignObject>section h6 code,div#p>svg>foreignObject>section h6 tt{font-size:inherit;padding:0 .2em}div#p>svg>foreignObject>section ol.no-list,div#p>svg>foreignObject>section ul.no-list{list-style-type:none;padding:0}div#p>svg>foreignObject>section ol[type="1"]{list-style-type:decimal}div#p>svg>foreignObject>section ol[type=a]{list-style-type:lower-alpha}div#p>svg>foreignObject>section ol[type=i]{list-style-type:lower-roman}div#p>svg>foreignObject>section div>ol:not([type]){list-style-type:decimal}div#p>svg>foreignObject>section ol ol,div#p>svg>foreignObject>section ol ul,div#p>svg>foreignObject>section ul ol,div#p>svg>foreignObject>section ul ul{margin-bottom:0;margin-top:0}div#p>svg>foreignObject>section li>p{margin-top:16px}div#p>svg>foreignObject>section li+li{margin-top:.25em}div#p>svg>foreignObject>section dl{padding:0}div#p>svg>foreignObject>section dl dt{font-size:1em;font-style:italic;font-weight:600;margin-top:16px;padding:0}div#p>svg>foreignObject>section dl dd{margin-bottom:16px;padding:0 16px}div#p>svg>foreignObject>section table th{font-weight:600}div#p>svg>foreignObject>section table td,div#p>svg>foreignObject>section table th{border:1px solid #d0d7de;padding:6px 13px}div#p>svg>foreignObject>section table tr{background-color:#fff;border-top:1px solid #d8dee4}div#p>svg>foreignObject>section table tr:nth-child(2n){background-color:#f6f8fa}div#p>svg>foreignObject>section table img{background-color:transparent}div#p>svg>foreignObject>section img[align=right]{padding-left:20px}div#p>svg>foreignObject>section img[align=left]{padding-right:20px}div#p>svg>foreignObject>section .emoji{background-color:transparent;max-width:none;vertical-align:text-top}div#p>svg>foreignObject>section span.frame,div#p>svg>foreignObject>section span.frame>span{display:block;overflow:hidden}div#p>svg>foreignObject>section span.frame>span{border:1px solid #d0d7de;float:left;margin:13px 0 0;padding:7px;width:auto}div#p>svg>foreignObject>section span.frame span img{display:block;float:left}div#p>svg>foreignObject>section span.frame span span{clear:both;color:#24292f;display:block;padding:5px 0 0}div#p>svg>foreignObject>section span.align-center{clear:both;display:block;overflow:hidden}div#p>svg>foreignObject>section span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}div#p>svg>foreignObject>section span.align-center span img{margin:0 auto;text-align:center}div#p>svg>foreignObject>section span.align-right{clear:both;display:block;overflow:hidden}div#p>svg>foreignObject>section span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}div#p>svg>foreignObject>section span.align-right span img{margin:0;text-align:right}div#p>svg>foreignObject>section span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}div#p>svg>foreignObject>section span.float-left span{margin:13px 0 0}div#p>svg>foreignObject>section span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}div#p>svg>foreignObject>section span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}div#p>svg>foreignObject>section code,div#p>svg>foreignObject>section tt{background-color:rgba(175,184,193,.2);border-radius:6px;font-size:85%;margin:0;padding:.2em .4em}div#p>svg>foreignObject>section code br,div#p>svg>foreignObject>section tt br{display:none}div#p>svg>foreignObject>section del code{text-decoration:inherit}div#p>svg>foreignObject>section pre code{font-size:100%}div#p>svg>foreignObject>section pre>code{background:transparent;border:0;margin:0;padding:0;white-space:pre;word-break:normal}div#p>svg>foreignObject>section .highlight{margin-bottom:16px}div#p>svg>foreignObject>section .highlight pre{margin-bottom:0;word-break:normal}div#p>svg>foreignObject>section pre{background-color:#f6f8fa;border-radius:6px;font-size:85%;line-height:1.45;overflow:auto;padding:16px}div#p>svg>foreignObject>section pre code,div#p>svg>foreignObject>section pre tt{word-wrap:normal;background-color:transparent;border:0;display:inline;line-height:inherit;margin:0;max-width:auto;overflow:visible;padding:0}div#p>svg>foreignObject>section .csv-data td,div#p>svg>foreignObject>section .csv-data th{font-size:12px;line-height:1;overflow:hidden;padding:5px;text-align:left;white-space:nowrap}div#p>svg>foreignObject>section .csv-data .blob-num{background:#fff;border:0;padding:10px 8px 9px;text-align:right}div#p>svg>foreignObject>section .csv-data tr{border-top:0}div#p>svg>foreignObject>section .csv-data th{background:#f6f8fa;border-top:0;font-weight:600}div#p>svg>foreignObject>section .footnotes{border-top:1px solid #d0d7de;color:#57606a;font-size:12px}div#p>svg>foreignObject>section div#p>svg>foreignObject>section section.footnotes{--marpit-root-font-size:12px}div#p>svg>foreignObject>section .footnotes ol{padding-left:16px}div#p>svg>foreignObject>section .footnotes li{position:relative}div#p>svg>foreignObject>section .footnotes li:target:before{border:2px solid #0969da;border-radius:6px;bottom:-8px;content:"";left:-24px;pointer-events:none;position:absolute;right:-8px;top:-8px}div#p>svg>foreignObject>section .footnotes li:target{color:#24292f}div#p>svg>foreignObject>section .footnotes .data-footnote-backref g-emoji{font-family:monospace}div#p>svg>foreignObject>section [hidden]{display:none!important}div#p>svg>foreignObject>section ::-webkit-calendar-picker-indicator{filter:invert(50%)}div#p>svg>foreignObject>section .hljs{background:#fff;color:#333;display:block;overflow-x:auto;padding:.5em}div#p>svg>foreignObject>section .hljs-comment,div#p>svg>foreignObject>section .hljs-meta{color:#969896}div#p>svg>foreignObject>section .hljs-emphasis,div#p>svg>foreignObject>section .hljs-quote,div#p>svg>foreignObject>section .hljs-strong,div#p>svg>foreignObject>section .hljs-template-variable,div#p>svg>foreignObject>section .hljs-variable{color:#df5000}div#p>svg>foreignObject>section .hljs-keyword,div#p>svg>foreignObject>section .hljs-selector-tag,div#p>svg>foreignObject>section .hljs-type{color:#d73a49}div#p>svg>foreignObject>section .hljs-attribute,div#p>svg>foreignObject>section .hljs-bullet,div#p>svg>foreignObject>section .hljs-literal,div#p>svg>foreignObject>section .hljs-symbol{color:#0086b3}div#p>svg>foreignObject>section .hljs-name,div#p>svg>foreignObject>section .hljs-section{color:#63a35c}div#p>svg>foreignObject>section .hljs-tag{color:#333}div#p>svg>foreignObject>section .hljs-attr,div#p>svg>foreignObject>section .hljs-selector-attr,div#p>svg>foreignObject>section .hljs-selector-class,div#p>svg>foreignObject>section .hljs-selector-id,div#p>svg>foreignObject>section .hljs-selector-pseudo,div#p>svg>foreignObject>section .hljs-title{color:#6f42c1}div#p>svg>foreignObject>section .hljs-addition{background-color:#eaffea;color:#55a532}div#p>svg>foreignObject>section .hljs-deletion{background-color:#ffecec;color:#bd2c00}div#p>svg>foreignObject>section .hljs-link{text-decoration:underline}div#p>svg>foreignObject>section .hljs-number{color:#005cc5}div#p>svg>foreignObject>section .hljs-string{color:#032f62}div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{max-height:563px}div#p>svg>foreignObject>section h1{color:#246;font-size:1.6em}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2{border-bottom:none}div#p>svg>foreignObject>section h2{font-size:1.3em}div#p>svg>foreignObject>section h3{font-size:1.1em}div#p>svg>foreignObject>section h4{font-size:1.05em}div#p>svg>foreignObject>section h5{font-size:1em}div#p>svg>foreignObject>section h6{font-size:.9em}div#p>svg>foreignObject>section h1 strong,div#p>svg>foreignObject>section h2 strong,div#p>svg>foreignObject>section h3 strong,div#p>svg>foreignObject>section h4 strong,div#p>svg>foreignObject>section h5 strong,div#p>svg>foreignObject>section h6 strong{color:#48c;font-weight:inherit}div#p>svg>foreignObject>section hr{height:0;padding-top:.25em}div#p>svg>foreignObject>section pre{border:1px solid #999;line-height:1.15;overflow:visible}div#p>svg>foreignObject>section pre code svg[data-marp-fitting=svg]{max-height:529px}div#p>svg>foreignObject>section footer,div#p>svg>foreignObject>section header{color:hsla(0,0%,40%,.75);font-size:18px;left:30px;margin:0;position:absolute}div#p>svg>foreignObject>section header{top:21px}div#p>svg>foreignObject>section footer{bottom:21px}div#p>svg>foreignObject>section{align-items:stretch;background:#fff;display:flex;flex-flow:column nowrap;font-size:29px;height:720px;justify-content:center;padding:78.5px;width:1280px}div#p>svg>foreignObject>section{--marpit-root-font-size:29px}div#p>svg>foreignObject>section>:last-child,div#p>svg>foreignObject>section[data-footer]>:nth-last-child(2){margin-bottom:0}div#p>svg>foreignObject>section>:first-child,div#p>svg>foreignObject>section>header:first-child+*{margin-top:0}div#p>svg>foreignObject>section:after{bottom:21px;color:#777;font-size:24px;padding:0;position:absolute;right:30px}div#p>svg>foreignObject>section:after{--marpit-root-font-size:24px}div#p>svg>foreignObject>section.invert{background-color:#222;color:#e6eaf0}div#p>svg>foreignObject>section.invert:after{color:#999}div#p>svg>foreignObject>section.invert img{background-color:transparent}div#p>svg>foreignObject>section.invert a{color:#50b3ff}div#p>svg>foreignObject>section.invert h1{color:#a3c5e7}div#p>svg>foreignObject>section.invert h2,div#p>svg>foreignObject>section.invert h3,div#p>svg>foreignObject>section.invert h4,div#p>svg>foreignObject>section.invert h5{color:#ebeff5}div#p>svg>foreignObject>section.invert blockquote,div#p>svg>foreignObject>section.invert h6{border-color:#3d3f43;color:#939699}div#p>svg>foreignObject>section.invert h1 strong,div#p>svg>foreignObject>section.invert h2 strong,div#p>svg>foreignObject>section.invert h3 strong,div#p>svg>foreignObject>section.invert h4 strong,div#p>svg>foreignObject>section.invert h5 strong,div#p>svg>foreignObject>section.invert h6 strong{color:#7bf}div#p>svg>foreignObject>section.invert hr{background-color:#3d3f43}div#p>svg>foreignObject>section.invert footer,div#p>svg>foreignObject>section.invert header{color:hsla(0,0%,60%,.75)}div#p>svg>foreignObject>section.invert code,div#p>svg>foreignObject>section.invert kbd{background-color:#111}div#p>svg>foreignObject>section.invert kbd{border-color:#666;box-shadow:inset 0 -1px 0 #555;color:#e6eaf0}div#p>svg>foreignObject>section.invert table tr{background-color:#12181d;border-color:#60657b}div#p>svg>foreignObject>section.invert table tr:nth-child(2n){background-color:#1b2024}div#p>svg>foreignObject>section.invert table td,div#p>svg>foreignObject>section.invert table th{border-color:#5b5e61}div#p>svg>foreignObject>section.invert pre{background-color:#0a0e12;border-color:#777}div#p>svg>foreignObject>section.invert pre code{background-color:transparent}div#p>svg>foreignObject>section[data-color] h1,div#p>svg>foreignObject>section[data-color] h2,div#p>svg>foreignObject>section[data-color] h3,div#p>svg>foreignObject>section[data-color] h4,div#p>svg>foreignObject>section[data-color] h5,div#p>svg>foreignObject>section[data-color] h6{color:currentColor}div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{display:block;height:auto;width:100%}@supports (-ms-ime-align:auto){div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{position:static}}div#p>svg>foreignObject>section svg[data-marp-fitting=svg].__reflow__{content:""}@supports (-ms-ime-align:auto){div#p>svg>foreignObject>section svg[data-marp-fitting=svg].__reflow__{position:relative}}div#p>svg>foreignObject>section [data-marp-fitting-svg-content]{display:table;white-space:nowrap;width:-webkit-max-content;width:-moz-max-content;width:max-content}div#p>svg>foreignObject>section [data-marp-fitting-svg-content-wrap]{white-space:pre}div#p>svg>foreignObject>section img[data-marp-twemoji]{background:transparent;height:1em;margin:0 .05em 0 .1em;vertical-align:-.1em;width:1em}

/* @theme custom
 */div#p>svg>foreignObject>section:not(a){background-color:#f0f8ff;padding-top:157px}div#p>svg>foreignObject>section footer{text-align:left}div#p>svg>foreignObject>section p.quote{text-align:right;font-family:serif;background-color:#c0c6cc;padding:10px}div#p>svg>foreignObject>section p.standout{color:#F78C6C;background-color:#2E3C43}div#p>svg>foreignObject>section h1.large{font-size:calc(var(--marpit-root-font-size, 1rem) * 3)}div#p>svg>foreignObject>section>:first-child{position:absolute;top:78.5px}div#p>svg>foreignObject>section.all-centered{padding-top:78.5px}div#p>svg>foreignObject>section.all-centered>:first-child{position:initial;top:0px}div#p>svg>foreignObject>section pre,div#p>svg>foreignObject>section pre[class*=language-]{background-color:#263238;color:#EEFFFF;font-size:calc(var(--marpit-root-font-size, 1rem) * 0.6)}div#p>svg>foreignObject>section .highlighted-line{background-color:#546E7A;color:white;display:block}


/*!
  Theme: Material
  Author: Nate Peterson
  License: ~ MIT (or more permissive) [via base16-schemes-source]
  Maintainer: @highlightjs/core-team
  Version: 2021.05.0
*/

/*
  WARNING: DO NOT EDIT THIS FILE DIRECTLY.

  This theme file was auto-generated from the Base16 scheme material
  by the Highlight.js Base16 template builder.

  - https://github.com/highlightjs/base16-highlightjs
*/

/*
base00  #263238  Default Background
base01  #2E3C43  Lighter Background (Used for status bars, line number and folding marks)
base02  #314549  Selection Background
base03  #546E7A  Comments, Invisibles, Line Highlighting
base04  #B2CCD6  Dark Foreground (Used for status bars)
base05  #EEFFFF  Default Foreground, Caret, Delimiters, Operators
base06  #EEFFFF  Light Foreground (Not often used)
base07  #FFFFFF  Light Background (Not often used)
base08  #F07178  Variables, XML Tags, Markup Link Text, Markup Lists, Diff Deleted
base09  #F78C6C  Integers, Boolean, Constants, XML Attributes, Markup Link Url
base0A  #FFCB6B  Classes, Markup Bold, Search Text Background
base0B  #C3E88D  Strings, Inherited Class, Markup Code, Diff Inserted
base0C  #89DDFF  Support, Regular Expressions, Escape Characters, Markup Quotes
base0D  #82AAFF  Functions, Methods, Attribute IDs, Headings
base0E  #C792EA  Keywords, Storage, Selector, Markup Italic, Diff Changed
base0F  #FF5370  Deprecated, Opening/Closing Embedded Language Tags, e.g. <?php ?>
*/div#p>svg>foreignObject>section pre code.hljs{display:block;overflow-x:auto;padding:1em}div#p>svg>foreignObject>section code.hljs{padding:3px 5px}div#p>svg>foreignObject>section .hljs{color:#EEFFFF;background:#263238}div#p>svg>foreignObject>section .hljs ::selection{color:#314549}


/* purposely do not highlight these things */div#p>svg>foreignObject>section .hljs-formula,div#p>svg>foreignObject>section .hljs-params,div#p>svg>foreignObject>section .hljs-property{}

/* base03 - #546E7A -  Comments, Invisibles, Line Highlighting */div#p>svg>foreignObject>section .hljs-comment{color:#546E7A}

/* base04 - #B2CCD6 -  Dark Foreground (Used for status bars) */div#p>svg>foreignObject>section .hljs-tag{color:#B2CCD6}

/* base05 - #EEFFFF -  Default Foreground, Caret, Delimiters, Operators */div#p>svg>foreignObject>section .hljs-operator,div#p>svg>foreignObject>section .hljs-punctuation,div#p>svg>foreignObject>section .hljs-subst{color:#EEFFFF}div#p>svg>foreignObject>section .hljs-operator{opacity:0.7}

/* base08 - Variables, XML Tags, Markup Link Text, Markup Lists, Diff Deleted */div#p>svg>foreignObject>section .hljs-bullet,div#p>svg>foreignObject>section .hljs-deletion,div#p>svg>foreignObject>section .hljs-name,div#p>svg>foreignObject>section .hljs-selector-tag,div#p>svg>foreignObject>section .hljs-template-variable,div#p>svg>foreignObject>section .hljs-variable{color:#F07178}

/* base09 - Integers, Boolean, Constants, XML Attributes, Markup Link Url */div#p>svg>foreignObject>section .hljs-attr,div#p>svg>foreignObject>section .hljs-link,div#p>svg>foreignObject>section .hljs-literal,div#p>svg>foreignObject>section .hljs-number,div#p>svg>foreignObject>section .hljs-symbol,div#p>svg>foreignObject>section .hljs-variable.constant_{color:#F78C6C}

/* base0A - Classes, Markup Bold, Search Text Background */div#p>svg>foreignObject>section .hljs-class .hljs-title,div#p>svg>foreignObject>section .hljs-title,div#p>svg>foreignObject>section .hljs-title.class_{color:#FFCB6B}div#p>svg>foreignObject>section .hljs-strong{font-weight:bold;color:#FFCB6B}

/* base0B - Strings, Inherited Class, Markup Code, Diff Inserted */div#p>svg>foreignObject>section .hljs-addition,div#p>svg>foreignObject>section .hljs-code,div#p>svg>foreignObject>section .hljs-string,div#p>svg>foreignObject>section .hljs-title.class_.inherited__{color:#C3E88D}

/* base0C - Support, Regular Expressions, Escape Characters, Markup Quotes */div#p>svg>foreignObject>section .hljs-built_in,div#p>svg>foreignObject>section .hljs-doctag,div#p>svg>foreignObject>section .hljs-keyword.hljs-atrule,div#p>svg>foreignObject>section .hljs-quote,div#p>svg>foreignObject>section .hljs-regexp{color:#89DDFF}

/* base0D - Functions, Methods, Attribute IDs, Headings */div#p>svg>foreignObject>section .hljs-attribute,div#p>svg>foreignObject>section .hljs-function .hljs-title,div#p>svg>foreignObject>section .hljs-section,div#p>svg>foreignObject>section .hljs-title.function_,div#p>svg>foreignObject>section .ruby .hljs-property{color:#82AAFF}

/* base0E - Keywords, Storage, Selector, Markup Italic, Diff Changed */div#p>svg>foreignObject>section .diff .hljs-meta,div#p>svg>foreignObject>section .hljs-keyword,div#p>svg>foreignObject>section .hljs-template-tag,div#p>svg>foreignObject>section .hljs-type{color:#C792EA}div#p>svg>foreignObject>section .hljs-emphasis{color:#C792EA;font-style:italic}

/* base0F - Deprecated, Opening/Closing Embedded Language Tags, e.g. <?php ?> */div#p>svg>foreignObject>section .hljs-meta,div#p>svg>foreignObject>section .hljs-meta .hljs-keyword,div#p>svg>foreignObject>section .hljs-meta .hljs-string{color:#FF5370}div#p>svg>foreignObject>section .hljs-meta-keyword,div#p>svg>foreignObject>section .hljs-meta .hljs-keyword{font-weight:bold}div#p>svg>foreignObject>section[data-marpit-scope-8I9Zlxe7] *{text-align:center;color:white}div#p>svg>foreignObject>section[data-marpit-scope-8I9Zlxe7] h1{color:white}div#p>svg>foreignObject>section[data-marpit-scope-8I9Zlxe7] a{color:dodgerblue}div#p>svg>foreignObject>section[data-marpit-scope-rBwQPAus] p{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.7);margin-top:30px}div#p>svg>foreignObject>section[data-marpit-scope-rBwQPAus].all-centered>:first-child{position:initial;top:0px}div#p>svg>foreignObject>section[data-marpit-scope-rBwQPAus] hr{margin:0}div#p>svg>foreignObject>section[data-marpit-scope-cuqIQANb] pre,div#p>svg>foreignObject>section[data-marpit-scope-cuqIQANb] pre[class*=language-]{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.5)}div#p>svg>foreignObject>section[data-marpit-scope-cuqIQANb] ul{flex-direction:row;display:flex;font-size:calc(var(--marpit-root-font-size, 1rem) * 0.6)}div#p>svg>foreignObject>section[data-marpit-scope-cuqIQANb] li{margin-left:calc(var(--marpit-root-font-size, 1rem) * 1);margin-top:calc(var(--marpit-root-font-size, 1rem) * 0.25)}div#p>svg>foreignObject>section[data-marpit-scope-A2HmKoYE] ul{margin-bottom:10px}div#p>svg>foreignObject>section[data-marpit-scope-A2HmKoYE] li,div#p>svg>foreignObject>section[data-marpit-scope-A2HmKoYE] ul p{margin:0;line-height:calc(var(--marpit-root-font-size, 1rem) * 1.2);font-size:calc(var(--marpit-root-font-size, 1rem) * 0.8)}div#p>svg>foreignObject>section[data-marpit-scope-A2HmKoYE] li,div#p>svg>foreignObject>section[data-marpit-scope-A2HmKoYE] ul{padding-left:0px}div#p>svg>foreignObject>section[data-marpit-scope-A2HmKoYE] ul ul{padding-left:20px}div#p>svg>foreignObject>section[data-marpit-scope-A2HmKoYE] ul ul li{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.7);line-height:calc(var(--marpit-root-font-size, 1rem) * 1)}div#p>svg>foreignObject>section[data-marpit-scope-A2HmKoYE] p.standout{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.8);padding:0 calc(var(--marpit-root-font-size, 1rem) * 0.3);text-align:right}div#p>svg>foreignObject>section[data-marpit-scope-PDOwMHx4] ul{margin-top:-15px}div#p>svg>foreignObject>section[data-marpit-scope-PDOwMHx4] li{margin:0}div#p>svg>foreignObject>section[data-marpit-scope-hXgQ8Llv] p,div#p>svg>foreignObject>section[data-marpit-scope-hXgQ8Llv] ul{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.9)}div#p>svg>foreignObject>section[data-marpit-scope-KAhwoLma] .nudge-down{margin-top:40px}div#p>svg>foreignObject>section[data-marpit-scope-KAhwoLma] h2{margin-bottom:0px}div#p>svg>foreignObject>section[data-marpit-scope-eXPGCaso] p,div#p>svg>foreignObject>section[data-marpit-scope-eXPGCaso] ul{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.8)}div#p>svg>foreignObject>section[data-marpit-scope-eXPGCaso] h1{line-height:calc(var(--marpit-root-font-size, 1rem) * 1.5)}div#p>svg>foreignObject>section[data-marpit-scope-eXPGCaso] li.no-bullet{list-style-type:none}div#p>svg>foreignObject>section[data-marpit-scope-iR6opykE] p{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.75)}div#p>svg>foreignObject>section[data-marpit-scope-Q4rxCHyh] ul{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.75)}div#p>svg>foreignObject>section[data-marpit-scope-QkzL274r] p{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.8)}div#p>svg>foreignObject>section[data-marpit-scope-veCbeOYL] p,div#p>svg>foreignObject>section[data-marpit-scope-veCbeOYL] ul{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.9)}div#p>svg>foreignObject>section[data-marpit-scope-iR8uBWkv] p,div#p>svg>foreignObject>section[data-marpit-scope-iR8uBWkv] ul{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.7)}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]{columns:initial!important;display:block!important;padding:0!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]:after,div#p>svg>foreignObject>section[data-marpit-advanced-background=background]:before,div#p>svg>foreignObject>section[data-marpit-advanced-background=content]:after,div#p>svg>foreignObject>section[data-marpit-advanced-background=content]:before{display:none!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container]{all:initial;display:flex;flex-direction:row;height:100%;overflow:hidden;width:100%}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container][data-marpit-advanced-background-direction=vertical]{flex-direction:column}div#p>svg>foreignObject>section[data-marpit-advanced-background=background][data-marpit-advanced-background-split]>div[data-marpit-advanced-background-container]{width:var(--marpit-advanced-background-split,50%)}div#p>svg>foreignObject>section[data-marpit-advanced-background=background][data-marpit-advanced-background-split=right]>div[data-marpit-advanced-background-container]{margin-left:calc(100% - var(--marpit-advanced-background-split, 50%))}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container]>figure{all:initial;background-position:center;background-repeat:no-repeat;background-size:cover;flex:auto;margin:0}div#p>svg>foreignObject>section[data-marpit-advanced-background=content],div#p>svg>foreignObject>section[data-marpit-advanced-background=pseudo]{background:transparent!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=pseudo],div#p>svg[data-marpit-svg]>foreignObject[data-marpit-advanced-background=pseudo]{pointer-events:none!important}div#p>svg>foreignObject>section[data-marpit-advanced-background-split]{width:100%;height:100%}</style></head><body><div class="bespoke-marp-osc"><button data-bespoke-marp-osc="prev" tabindex="-1" title="Previous slide">Previous slide</button><span data-bespoke-marp-osc="page"></span><button data-bespoke-marp-osc="next" tabindex="-1" title="Next slide">Next slide</button><button data-bespoke-marp-osc="fullscreen" tabindex="-1" title="Toggle fullscreen (f)">Toggle fullscreen</button><button data-bespoke-marp-osc="presenter" tabindex="-1" title="Open presenter view (p)">Open presenter view</button></div><div id="p"><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="1" data-marpit-scope-8I9Zlxe7="" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-class="all-centered" data-background-image="linear-gradient(to bottom, #2C5364, #203A43, #0F2027)" data-theme="custom" class="all-centered" style="--footer:https://github.com/smutch/code_prac_hwsa2021;--class:all-centered;--background-image:linear-gradient(to bottom, #2C5364, #203A43, #0F2027);--theme:custom;background-image:linear-gradient(to bottom, #2C5364, #203A43, #0F2027);background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><svg data-marp-fitting="svg"><foreignObject><span data-marp-fitting-svg-content> Optimising Python code</span></foreignObject></svg></h1>
<h2>HWSA 2021</h2>
<h3>Simon Mutch</h3>
<p>ASTRO 3D Postdoc<br />
Senior Research Data Specialist: Melbourne Data Analytics Platform<br />
The University of Melbourne</p>
<div style="display: block; position: absolute; bottom:-3px; right: 25px;">
<p><img src="./assets/UOM-Rev3D_H_Sm_RGB.jpg" alt="w:200px" style="width:200px;" /></p>
</div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-marpit-scope-rBwQPAus="" data-marpit-fragments="2" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-background-color="black" data-color="white" data-marpit-pagination="2" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--background-color:black;--color:white;color:white;background-color:black;background-image:none;" data-marpit-advanced-background="background"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./assets/chris-ried-ieic5Tq8YMk-unsplash.jpg&quot;);filter:blur(4px) brightness(0.2) contrast(80%);"></figure></div></section></foreignObject><foreignObject width="1280" height="720"><section id="2" data-marpit-scope-rBwQPAus="" data-marpit-fragments="2" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-background-color="black" data-color="white" data-marpit-pagination="2" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--background-color:black;--color:white;color:white;background-color:black;background-image:none;" data-marpit-advanced-background="content">
<h1 class="large">Session outline</h1>

<ul>
<li data-marpit-fragment="1">Presentation on optimisation
<ul>
<li>Profiling</li>
<li>Testing</li>
<li>Speeding up Python code</li>
</ul>
</li>
<li data-marpit-fragment="2">Practical
<ul>
<li>Open ended session with a short code to try some of these techniques out on.</li>
<li><strong><img class="emoji" draggable="false" alt="🏆" src="https://twemoji.maxcdn.com/2/svg/1f3c6.svg" data-marp-twemoji=""/> Competition <img class="emoji" draggable="false" alt="🏆" src="https://twemoji.maxcdn.com/2/svg/1f3c6.svg" data-marp-twemoji=""/></strong>: Who can achieve the greatest speed-up? <img class="emoji" draggable="false" alt="⏱️" src="https://twemoji.maxcdn.com/2/svg/23f1.svg" data-marp-twemoji=""/></li>
</ul>
</li>
</ul>
<div data-marpit-fragment>
<p><em>There is more content in these slides than we'll cover today, but hoepfully they will be a useful reference for the future.</em></p>
</div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="color:white;" data-marpit-advanced-background="pseudo" data-marpit-pagination="2" data-marpit-pagination-total="35"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="3" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;" data-marpit-advanced-background="background"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./assets/quote-premature-optimization-is-the-root-of-all-evil-donald-knuth-72-10-20.jpg&quot;);background-size:1000px auto;"></figure></div></section></foreignObject><foreignObject width="1280" height="720"><section id="3" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="3" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;" data-marpit-advanced-background="content">
<h1></h1>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="3" data-marpit-pagination-total="35"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="4" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:50%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./assets/age-barros-rBPOfVqROzY-unsplash.jpg&quot;);"></figure></div></section></foreignObject><foreignObject width="50%" height="720"><section id="4" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="4" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:50%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1>The optimisation cycle</h1>
<div data-marpit-fragment>
<ol>
<li>Profile</li>
<li>Develop regression tests</li>
<li>Baseline timing <br /><br /></li>
</ol>
</div>
<div data-marpit-fragment>
<ol start="4">
<li>Optimise identified bottlenecks</li>
<li>Time</li>
<li>Test</li>
<li>Profile then go back to 4<br />
<strong>or</strong> call it a day and bask in glory</li>
</ol>
</div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="4" data-marpit-pagination-total="35"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="5" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="5" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>cProfile</h1>
<div data-marpit-fragment>
<p><code>cProfile</code> is part of the Python standard library <em>(you don't need to manually install it)</em>.<br />
It gives statistics for function calls and is often the best place to start when profiling Python code.</p>
</div>
<div data-marpit-fragment>
<pre class="language-python"><code class="language-python"><span class="hljs-keyword">import</span> cProfile
<span class="hljs-keyword">import</span> pstats

profile = cProfile.Profile()

profile.enable()

dn_dlogm_list = []
<span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> z_list:
    dn_dlogm_list.append(press_schecter(M_list, z, A_std_func()))

profile.disable()

ps = pstats.Stats(profile).strip_dirs().sort_stats(pstats.SortKey.TIME)
ps.print_stats(<span class="hljs-number">10</span>)</code></pre></div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="6" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="6" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>cProfile</h1>
<p><code>cProfile</code> is part of the Python standard library <em>(you don't need to manually install it)</em>.<br />
It gives statistics for function calls and is often the best place to start when profiling Python code.</p>
<div>
<pre class="language-python"><code class="language-python"><span class="hljs-keyword">import</span> cProfile
<span class="hljs-keyword">import</span> pstats

profile = cProfile.Profile()

<span class="highlighted-line">profile.enable()</span>
dn_dlogm_list = []
<span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> z_list:
    dn_dlogm_list.append(press_schecter(M_list, z, A_std_func()))

<span class="highlighted-line">profile.disable()</span>
ps = pstats.Stats(profile).strip_dirs().sort_stats(pstats.SortKey.TIME)
ps.print_stats(<span class="hljs-number">10</span>)</code></pre></div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="7" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="7" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>cProfile</h1>
<p><code>cProfile</code> is part of the Python standard library <em>(you don't need to manually install it)</em>.<br />
It gives statistics for function calls and is often the best place to start when profiling Python code.</p>
<div>
<pre class="language-python"><code class="language-python"><span class="hljs-keyword">import</span> cProfile
<span class="hljs-keyword">import</span> pstats

profile = cProfile.Profile()

profile.enable()

dn_dlogm_list = []
<span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> z_list:
    dn_dlogm_list.append(press_schecter(M_list, z, A_std_func()))

profile.disable()

<span class="highlighted-line">ps = pstats.Stats(profile).strip_dirs().sort_stats(pstats.SortKey.TIME)</span><span class="highlighted-line">ps.print_stats(<span class="hljs-number">10</span>)</span></code></pre></div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="8" data-marpit-fragments="3" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="8" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>cProfile</h1>
<pre><code><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>         3326986 function calls in 8.092 seconds

   Ordered by: internal time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
  1094475    4.079    0.000    4.079    0.000 press_schecter.py:22(tophat_ft)
  1094475    2.482    0.000    2.482    0.000 press_schecter.py:27(power)
  1094100    0.894    0.000    7.454    0.000 press_schecter.py:38(&lt;lambda&gt;)
     4005    0.536    0.000    7.992    0.002 {built-in method scipy.integrate._quadpack._qagie}
     1000    0.018    0.000    6.116    0.006 common.py:75(derivative)
     1000    0.012    0.000    0.012    0.000 {method 'reduce' of 'numpy.ufunc' objects}
        5    0.012    0.002    8.089    1.618 press_schecter.py:69(press_schecter)
</span></span></foreignObject></svg></code></pre>
<ul>
<li data-marpit-fragment="1"><strong>tottime</strong>: time spent inside this function</li>
<li data-marpit-fragment="2"><strong>cumtime</strong>: time spent inside this function and all functions it calls</li>
<li data-marpit-fragment="3"><strong>percall</strong>: cumulative time per call</li>
</ul>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="9" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="9" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>line_profiler</h1>
<p>What if we want to go deeper though?<br />
<em>Where</em> in the function are we spending all of our time? Calculating logarithms, multiplying numbers?</p>
<div data-marpit-fragment>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">@profile</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">press_schechter</span>(<span class="hljs-params">...</span>):</span>
    ...
</span></span></foreignObject></svg></code></pre>
<pre><code class="language-sh"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>&gt; kernprof -l press_schecter.py
&gt; python -m line_profiler press_schechter.py.lprof
</span></span></foreignObject></svg></code></pre>
</div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="10" data-marpit-scope-cuqIQANb="" data-marpit-fragments="4" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="10" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>line_profiler</h1>
<pre><code><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>Function: press_schecter at line 66

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    66                                           @profile
    67                                           def press_schecter(M_list, z, A_std):
    68         5        115.0     23.0      0.0      R_list = (2 * (M_list) * G / (h0 ** 2 * wm)) ** (1 / 3)
    69         5         18.0      3.6      0.0      rho = rho_m(z=0)
    70
    71         5        764.0    152.8      0.0      d_c = d_crit(z)
    72
    73         5          4.0      0.8      0.0      dn_dlogm = []
    74      1005       1436.0      1.4      0.0      for r in R_list:
    75      1000    3266597.0   3266.6     24.3          std = stdev(r, A=A_std)
    76      1000       2010.0      2.0      0.0          deriv = (
    77      1000   10167353.0  10167.4     75.6              2 * G / (3 * h0 ** 2 * wm * r ** 2) * \
                                                            derivative(lambda rr: np.log(stdev(rr, A=A_std)), x0=r, dx=r * 0.5)
    78                                                   )
    79      1000       1078.0      1.1      0.0          nu = d_c / std
    80      1000       9737.0      9.7      0.1          dn_dlogm.append( \
                                                            np.sqrt(2 / np.pi) * rho * -deriv * nu * np.exp(-(nu ** 2) / 2) \
                                                         )
    81         5          3.0      0.6      0.0      return dn_dlogm
</span></span></foreignObject></svg></code></pre>
<ul>
<li data-marpit-fragment="1"><strong>Hits</strong>: Number of times this line is called.</li>
<li data-marpit-fragment="2"><strong>Total</strong>: Cumulative time spent on this line.</li>
<li data-marpit-fragment="3"><strong>Per Hit</strong>: Time spent on line each time it's called.</li>
<li data-marpit-fragment="4"><strong>% Time</strong>: Percentage of time spent on this line relative to whole function.</li>
</ul>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-marpit-scope-A2HmKoYE="" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-class="all-centered" data-theme="custom" class="all-centered" data-marpit-pagination="11" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--class:all-centered;--theme:custom;--marpit-advanced-background-split:33%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="left"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./assets/chris-liverani-ViEBSoZH6M4-unsplash.jpg&quot;);"></figure></div></section></foreignObject><foreignObject width="67%" height="720" x="33%"><section id="11" data-marpit-scope-A2HmKoYE="" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-class="all-centered" data-theme="custom" class="all-centered" data-marpit-pagination="11" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--class:all-centered;--theme:custom;--marpit-advanced-background-split:33%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="left">
<h1>Testing</h1>
<ul>
<li><strong>Unit tests</strong>: Ideally test the smallest logical units of your code (e.g. individual functions).
<ul>
<li>Should (ideally) test correctness, edge cases and unexpected input.</li>
</ul>
</li>
<li><strong>Integration tests</strong>: Tests larger units and how they interact, or the whole code.
<ul>
<li>Should (ideally) test correctness and be used in conjunction with unit tests.</li>
</ul>
</li>
<li><strong>Regression tests</strong>: Tests larger units or the whole code to make sure you recover the same answer after changes.
<ul>
<li>Sometimes you don't want these (e.g. when changing physical models), but they are <strong>very important</strong> for optimisation.</li>
</ul>
</li>
</ul>
<div data-marpit-fragment>
<p class="standout"><strong>Make testing part of your routine</strong>.<br />
It's a lot easier to write tests as you go along, rather than coming back after-the-fact.</p>
</div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section class="all-centered" style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="11" data-marpit-pagination-total="35"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-marpit-scope-PDOwMHx4="" data-paginate="true" data-footer="&lt;sup&gt;1&lt;/sup&gt; See also https://github.com/astropy/pytest-arraydiff
https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="12" data-marpit-pagination-total="35" style="--paginate:true;--footer:&lt;sup&gt;1&lt;/sup&gt; See also https://github.com/astropy/pytest-arraydiff
https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:20%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;https://docs.pytest.org/en/6.2.x/_static/pytest1.png&quot;);background-size:auto;"></figure></div></section></foreignObject><foreignObject width="80%" height="720"><section id="12" data-marpit-scope-PDOwMHx4="" data-paginate="true" data-footer="&lt;sup&gt;1&lt;/sup&gt; See also https://github.com/astropy/pytest-arraydiff
https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="12" data-marpit-pagination-total="35" style="--paginate:true;--footer:&lt;sup&gt;1&lt;/sup&gt; See also https://github.com/astropy/pytest-arraydiff
https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:20%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1>Pytest</h1>

<p>Covering <a href="https://docs.pytest.org/">pytest</a> and all it has to offer would take a whole session itself!<br />
There are a lot of great examples and articles online.</p>
<p>Some useful topics to check out include:</p>
<ul>
<li>Fixtures</li>
<li>Parameterizing tests</li>
<li>Setting up continuous integration (CI) for automated testing</li>
<li>Coverage measurements</li>
</ul>
<p>For regression testing, the <a href="https://pypi.org/project/pytest-regtest/">regtest</a> plugin is popular<sup>1</sup>...</p>
<footer><sup>1</sup> See also <a href="https://github.com/astropy/pytest-arraydiff">https://github.com/astropy/pytest-arraydiff</a><br />
<a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="12" data-marpit-pagination-total="35"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="13" data-marpit-scope-hXgQ8Llv="" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="13" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Regression tests with pytest</h1>
<p>Naming of directories, files and functions all matter with pytest. You can configure this, but standard practice is:</p>
<ul>
<li>Place all of your tests in a directory called <code>tests</code>.</li>
<li>You need to have a <code>__init__.py</code> file in <code>tests</code> (to make them part of a module) but it can be empty.</li>
<li>Each file should be called <code>test_*.py</code>.</li>
<li>Each test function should be called <code>test_*</code>.</li>
</ul>
<pre><code><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>tests
├── __init__.py
└── test_regressions.py
</span></span></foreignObject></svg></code></pre>
<pre><code class="language-py"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_regressions</span>(<span class="hljs-params">...</span>):</span> ...
</span></span></foreignObject></svg></code></pre>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="14" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="14" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Regression tests with pytest</h1>
<pre><code class="language-py"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">from</span> pytest_regtest <span class="hljs-keyword">import</span> regtest

<span class="hljs-keyword">from</span> mycode <span class="hljs-keyword">import</span> myfunc

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_mycode</span>(<span class="hljs-params">regtest</span>):</span>

    result = myfunc(...)

    <span class="hljs-keyword">with</span> regtest:
        <span class="hljs-built_in">print</span>(result)
</span></span></foreignObject></svg></code></pre>
<p>We need to initialise and store the expected output the first time around.</p>
<pre><code class="language-sh"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>&gt; pytest --regtest-reset
</span></span></foreignObject></svg></code></pre>
<p>The results will go in <code>tests/_regtest_outputs/</code> <strong>which should be committed to version control</strong>.</p>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="15" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="15" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Regression tests with pytest</h1>
<p>Now, after trying to optimise the code, we can check we still get the right result using:</p>
<pre><code><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>&gt; pytest

============================================================================== test session starts ==============================================================================
platform darwin -- Python 3.9.5, pytest-6.2.4, py-1.10.0, pluggy-0.13.1
rootdir: /blaa/blaa/mycode
plugins: regtest-1.4.6
collected 1 item

tests/test_regressions.py .                                                                                                                                               [100%]

=============================================================================== 1 passed in 9.22s ===============================================================================
</span></span></foreignObject></svg></code></pre>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="16" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="16" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Regression tests</h1>
<p>If the output of the <code>press_schechter</code> function changes:</p>
<pre><code><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>&gt; pytest

============================================================================== test session starts ==============================================================================
platform darwin -- Python 3.9.5, pytest-6.2.4, py-1.10.0, pluggy-0.13.1
rootdir: /blaa/blaa/mycode
plugins: regtest-1.4.6
collected 1 item

tests/test_regressions.py F                                                                                                                                               [100%]

=================================================================================== FAILURES ====================================================================================
_____________________________________________________________________________ test_press_schechter ______________________________________________________________________________

regression test output differences for tests/test_regressions.py::test_mycode:

&gt;   --- current
&gt;   +++ tobe
&gt;   @@ -1,2 +1,2 @@
&gt;   -[[3943684.4663377525, 3433036.716787263, 2988666.7237358466, 2601939.030501016, 2265406.0334823187, 1972476.6100945876, 1717547.9139849006, 1495624.5560116607, 1302452.0154

...

============================================================================ short test summary info ============================================================================
FAILED tests/test_regressions.py::test_mycode
============================================================================== 1 failed in 10.03s ===============================================================================

</span></span></foreignObject></svg></code></pre>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="17" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-class="all-centered" data-theme="custom" class="all-centered" data-marpit-pagination="17" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--class:all-centered;--theme:custom;">
<h1></h1>
<h1><svg data-marp-fitting="svg"><foreignObject><span data-marp-fitting-svg-content> Let's go fast!</span></foreignObject></svg></h1>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="18" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="18" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Things to know about Python and speed</h1>
<h2>Python is an interpreted language and (almost) everything is an object</h2>
<p>This means there is a cost with looking up and accessing values.</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>a = <span class="hljs-number">8.0</span> 
<span class="hljs-built_in">print</span>(a)
</span></span></foreignObject></svg></code></pre>
<p>Translated to C this is actually something more like <em>(but in reality way more complicated!)</em>:</p>
<pre><code class="language-c"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">void</span> *a = (<span class="hljs-keyword">void</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">double</span>));
*(<span class="hljs-keyword">double</span>*)a = <span class="hljs-number">8.0</span>;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;{:g}\n&quot;</span>, *((<span class="hljs-keyword">double</span>*)a));
</span></span></foreignObject></svg></code></pre>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="19" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="19" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1><strong>The most important</strong> scientific python optimisation rule</h1>
<h4>For loops should be avoided if possible. Take advantage of Numpy's ufuncs (which will vectorize it and do it more efficiently).</h4>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>arr = np.arange(<span class="hljs-number">100_000</span>)

<span class="hljs-comment"># BAD: 165 ms ± 4.78 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>
<span class="hljs-keyword">for</span> ii, val <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(arr):
    arr[ii] = np.sqrt(val)

<span class="hljs-comment"># GOOD: 147 µs ± 2.51 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)</span>
arr = np.sqrt(arr)
</span></span></foreignObject></svg></code></pre>
<div data-marpit-fragment>
<p>147 µs = 0.147 ms<br />
∴ x1,112 speed up !!! <img class="emoji" draggable="false" alt="😮" src="https://twemoji.maxcdn.com/2/svg/1f62e.svg" data-marp-twemoji=""/></p>
</div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="20" data-marpit-scope-KAhwoLma="" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="20" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>An aside...</h1>
<h2>A common misconception:</h2>
<p>Numpy <code>vectorize</code> does not &quot;vectorize&quot; your code.</p>
<p class="nudge-down">From the docs:</p>
<p class="quote">&quot;The vectorize function is provided primarily for convenience, not for performance. The implementation is essentially a for loop.&quot;<br />
-- <em>Numpy docs</em></p>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-marpit-scope-eXPGCaso="" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="21" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:33%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./assets/braden-collum-9HI8UJMSdZA-unsplash.jpg&quot;);"></figure></div></section></foreignObject><foreignObject width="67%" height="720"><section id="21" data-marpit-scope-eXPGCaso="" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="21" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:33%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1>I've removed all the loops I can, but I still need more speed!!!</h1>

<p>There are a number of techniques and tools at our disposal. Which ones will work best is heavily dependent on the problem. e.g.:</p>
<ul>
<li>Use 3rd-party libraries which are already optimised!<br />
<strong>(I won't cover this, but it should always be your first stop.)</strong></li>
<li>Algorithmic changes (e.g. identifying redundant calculations).</li>
</ul>
<div data-marpit-fragment>
<ul>
<li class="no-bullet"><img class="emoji" draggable="false" alt="⬇️" src="https://twemoji.maxcdn.com/2/svg/2b07.svg" data-marp-twemoji=""/> <strong>This is what we'll look at today.</strong> <img class="emoji" draggable="false" alt="⬇️" src="https://twemoji.maxcdn.com/2/svg/2b07.svg" data-marp-twemoji=""/> </li>
<li>Memoisation (caching of results for reuse later)</li>
<li>Dropping down to a lower level using <a href="https://numba.pydata.org/">Numba</a>, <a href="https://numba.pydata.org/">Cython</a>, etc.</li>
<li>Parallelisation</li>
</ul>
</div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="21" data-marpit-pagination-total="35"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="22" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="22" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Memoisation</h1>
<h4>The idea</h4>
<p>Sometimes we have a function that may be called many times with the same input. In these situations it may be faster to store the results and reuse them rather than recalculating them each time.</p>
<h4>Works well when</h4>
<ul>
<li>You have an expensive function being called a number of times with the same input.</li>
<li>You have any non-trivial function being called many, many times with the same <em>small</em> input.</li>
</ul>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="23" data-paginate="true" data-footer="&lt;sup&gt;1&lt;/sup&gt; Don't do this!!!
https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="23" data-marpit-pagination-total="35" style="--paginate:true;--theme:custom;">
<h1>Memoisation</h1>
<h4>A (very contrived) example<sup>1</sup></h4>
<pre><code class="language-py"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

points = np.random.rand(<span class="hljs-number">10_000</span>, <span class="hljs-number">2</span>)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">myfunc</span>(<span class="hljs-params">x, y</span>):</span>
    <span class="hljs-keyword">return</span> (np.log10(np.sqrt(x**<span class="hljs-number">2</span> + y**<span class="hljs-number">2</span>) * <span class="hljs-number">5</span>) / <span class="hljs-number">0.2</span>)**<span class="hljs-number">6</span>

result = <span class="hljs-number">0.0</span>
<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):
    result += np.array([myfunc(x, y) <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> points])
</span></span></foreignObject></svg></code></pre>
<p><code>5.02 s ± 242 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</code></p>
<footer><sup>1</sup> Don't do this!!!<br />
<a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="24" data-paginate="true" data-footer="&lt;sup&gt;1&lt;/sup&gt; Don't do this!!!
https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="24" data-marpit-pagination-total="35" style="--paginate:true;--theme:custom;">
<h1>Memoisation</h1>
<h4>A (very contrived) example<sup>1</sup></h4>
<pre class="language-py"><code class="language-py"><span class="highlighted-line"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> cache</span>
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

points = np.random.rand(<span class="hljs-number">10_000</span>, <span class="hljs-number">2</span>)

<span class="highlighted-line"><span class="hljs-meta">@cache</span></span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">myfunc</span>(<span class="hljs-params">x, y</span>):</span>
    <span class="hljs-keyword">return</span> (np.log10(np.sqrt(x**<span class="hljs-number">2</span> + y**<span class="hljs-number">2</span>) * <span class="hljs-number">5</span>) / <span class="hljs-number">0.2</span>)**<span class="hljs-number">6</span>

result = <span class="hljs-number">0.0</span>
<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):
    result += np.array([myfunc(x, y) <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> points])</code></pre><p><code>1.28 s ± 423 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</code></p>
<div style="margin-bottom: 40px;" data-marpit-fragment>
A factor of ~4 speed-up by adding 2 lines... Not bad!
</div>
<footer><sup>1</sup> Don't do this!!!<br />
<a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="25" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:20%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./assets/joblib_logo.svg&quot;);background-size:auto 200px;"></figure></div></section></foreignObject><foreignObject width="80%" height="720"><section id="25" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="25" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:20%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1>Memoisation</h1>

<h4>However...</h4>
<p><code>functools.cache</code> stores the result in RAM and needs to compare each input argument against the cached results.<br />
This works well when arguments and output are small e.g <code>float</code>s <code>int</code>s etc.</p>
<h4>joblib.Memory</h4>
<p>These limitations can be overcome in some cases with <a href="https://joblib.readthedocs.io/en/latest/memory.html#memory">joblib.Memory</a>.<br />
It caches to disk and removes much of the overhead with large input and output arrays.</p>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="25" data-marpit-pagination-total="35"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-marpit-scope-iR6opykE="" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="26" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:25%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="left"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./assets/verne-ho-5jfvhQPWtUo-unsplash.jpg&quot;);"></figure></div></section></foreignObject><foreignObject width="75%" height="720" x="25%"><section id="26" data-marpit-scope-iR6opykE="" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="26" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:25%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="left">
<h1>Going lower level...</h1>

<p>Sometimes the best way to improve the speed of our code is to use another language!... <img class="emoji" draggable="false" alt="😱" src="https://twemoji.maxcdn.com/2/svg/1f631.svg" data-marp-twemoji=""/></p>
<p>But fear not! This does not mean having to re-write your code in C/C++/Rust etc.</p>
<div style="margin-top: 30px" data-marpit-fragment>
<p><a href="https://numba.pydata.org/"><img src="./assets/numba-blue-horizontal-rgb.svg" alt="w:200px" style="width:200px;" /></a> Does <strong>J</strong>ust <strong>I</strong>n <strong>T</strong>ime (JIT) compilation of Python code. It can be incredibly easy to use and can provide big speed gains. It can also be used for GPU programming.</p>
</div>
<div data-marpit-fragment>
<p><a href="https://cython.readthedocs.io/en/latest/"><img src="./assets/cythonlogo.png" alt="w:200px" style="width:200px;" /></a> A python-superset language that can be used to create efficient C extensions. As well as providing similar speed-ups to Numba (with a bit more effort), it can be used in more complex situations and also provides a great and flexible way to interface C libraries with Python.</p>
</div>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="26" data-marpit-pagination-total="35"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="27" data-marpit-scope-Q4rxCHyh="" data-marpit-fragments="1" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="27" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Numba</h1>
<p>Using Numba can be incredibly easy:</p>
<pre><code class="language-py"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">import</span> numba
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-meta">@numba.njit</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">myfunc</span>(<span class="hljs-params">arr, n_loops</span>):</span>
    result = np.zeros(arr.shape[<span class="hljs-number">0</span>])
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n_loops):
        result += (np.log10(np.sqrt(arr[:, <span class="hljs-number">0</span>]**<span class="hljs-number">2</span> + arr[:, <span class="hljs-number">1</span>]**<span class="hljs-number">2</span>) * <span class="hljs-number">5</span>) / <span class="hljs-number">0.2</span>)**<span class="hljs-number">6</span>
    <span class="hljs-keyword">return</span> result

points = np.random.rand(<span class="hljs-number">10_000</span>, <span class="hljs-number">2</span>)
result = myfunc(points, <span class="hljs-number">100</span>)
</span></span></foreignObject></svg></code></pre>

<ul>
<li><code>njit</code> means compile in &quot;no-python&quot; mode. This requires the function to be simple and use only support functions and types (most of Numpy) but not Python classes or dicts.</li>
<li>Loops are fine! They will be optimised by LLVM (the compiler) for your CPU.</li>
</ul>
<ul>
<li data-marpit-fragment="1"><code>15.7 ms</code> with decorator vs. <code>42.5 ms</code> without <span data-marpit-fragment><strong>= ~2.5x speed-up</strong></span></li>
</ul>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="28" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="28" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Where Numba might not be enough<br />(WARNING: very subjective!)</h1>
<ul>
<li>It only supports a subset of Python + Numpy (although a very large one).</li>
<li>It can be hard to debug if things don't work as expected.</li>
<li>There isn't much scope for workarounds. If it doesn't &quot;just work&quot; then often it won't work.</li>
</ul>
<p><strong>Despite these, I definitely recommend Numba as the first-stop for speeding up numerical code!</strong></p>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="29" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="29" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Parallelisation</h1>
<p>Almost all computers have multiple cores. In some cases we can take advantage of this to speed up our calculations. Numpy &amp; Scipy actually do this for some functions without you necessarily realising.</p>
<p>This technique works well when:</p>
<ul>
<li>you have an expensive function</li>
<li>being called multiple times with different arguments</li>
<li>independently of each other.</li>
</ul>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="30" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-background-color="#263238" data-color="white" data-theme="custom" data-marpit-pagination="30" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--background-color:#263238;--color:white;--theme:custom;color:white;background-color:#263238;background-image:none;">
<h1><strong>Extra</strong><br />Native parallelisation in Python is expensive</h1>
<h3>The GIL</h3>
<p>The Global Interpreter Lock (GIL) is a mutex which ensures only one thread can use the interpreter at any one time. It's a feature that makes Python simple and easy to use.<br />
But it's a hurdle to efficient parallelisation.</p>
<p>To get around this natively we can use the <a href="https://docs.python.org/3/library/multiprocessing.html">multiprocessing</a> standard library.<br />
It uses multiple processes, each running their own Python interpreter, with their own private memory space.<br />
<strong>But</strong> this is expensive, so we need to have enough work for each process to make it worthwhile.</p>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="31" data-marpit-scope-QkzL274r="" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="31" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Parallelisation with Numba</h1>
<p>As it turns out, Numba (does) and Cython (can) release the GIL! <img class="emoji" draggable="false" alt="🥳" src="https://twemoji.maxcdn.com/2/svg/1f973.svg" data-marp-twemoji=""/></p>
<p>Numba can parallelise code automatically in some cases (see <a href="https://numba.readthedocs.io/en/stable/user/parallel.html#">the docs</a>), but we can also manually request it:</p>
<pre class="language-py"><code class="language-py"><span class="hljs-keyword">import</span> numba
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="highlighted-line"><span class="hljs-meta">@numba.njit(<span class="hljs-params">parallel=<span class="hljs-literal">True</span></span>)</span></span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">myfunc</span>(<span class="hljs-params">arr, n_loops</span>):</span>
    result = np.zeros(arr.shape[<span class="hljs-number">0</span>])
<span class="highlighted-line">    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> numba.prange(n_loops):</span>        result += (np.log10(np.sqrt(arr[:, <span class="hljs-number">0</span>]**<span class="hljs-number">2</span> + arr[:, <span class="hljs-number">1</span>]**<span class="hljs-number">2</span>) * <span class="hljs-number">5</span>) / <span class="hljs-number">0.2</span>)**<span class="hljs-number">6</span>
    <span class="hljs-keyword">return</span> result

points = np.random.rand(<span class="hljs-number">10_000</span>, <span class="hljs-number">2</span>)
result = myfunc(points, <span class="hljs-number">10_000</span>)</code></pre><p>Even with Numba, the best performance gains only come when the units of work are large enough.</p>
<p><em>For more information and a good, flexible library for multiple different parallelisation backends, see <a href="https://joblib.readthedocs.io/en/latest/">joblib</a>.</em></p>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="32" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-class="all-centered" data-theme="custom" class="all-centered" data-marpit-pagination="32" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--class:all-centered;--theme:custom;">
<h1><svg data-marp-fitting="svg"><foreignObject><span data-marp-fitting-svg-content> Practical time!</span></foreignObject></svg></h1>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="33" data-marpit-scope-veCbeOYL="" data-paginate="true" data-footer="&lt;sup&gt;1&lt;/sup&gt; I got a 300x speed-up. Can you beat me? 😉
https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="33" data-marpit-pagination-total="35" style="--paginate:true;--footer:&lt;sup&gt;1&lt;/sup&gt; I got a 300x speed-up. Can you beat me? 😉
https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Practical</h1>
<h4>Main suggestion</h4>
<ul>
<li>Optimize <code>code_prac/press_schechter.py</code> and see how fast you can make it<sup>1</sup>.
<ul>
<li>Time your attempts using<br /><code>python -m timeit -s 'import code_prac' 'code_prac.press_schechter.main()'</code></li>
</ul>
</li>
<li>If you followed the setup instructions in the repo then you should have all of the libraries and packages you may need installed.</li>
<li><strong>Compete for the title of <img class="emoji" draggable="false" alt="🏆" src="https://twemoji.maxcdn.com/2/svg/1f3c6.svg" data-marp-twemoji=""/><img class="emoji" draggable="false" alt="🏆" src="https://twemoji.maxcdn.com/2/svg/1f3c6.svg" data-marp-twemoji=""/> &quot;Optimizer Prime&quot; <img class="emoji" draggable="false" alt="🏆" src="https://twemoji.maxcdn.com/2/svg/1f3c6.svg" data-marp-twemoji=""/><img class="emoji" draggable="false" alt="🏆" src="https://twemoji.maxcdn.com/2/svg/1f3c6.svg" data-marp-twemoji=""/>!</strong>
<ul>
<li>There are no rules, except that we must be able to call <code>code_prac.press_schechter.mass_function</code> with the same arguments as the starting code and get the same result.</li>
</ul>
</li>
</ul>
<footer><sup>1</sup> I got a 300x speed-up. Can you beat me? <img class="emoji" draggable="false" alt="😉" src="https://twemoji.maxcdn.com/2/svg/1f609.svg" data-marp-twemoji=""/><br />
<a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="34" data-marpit-scope-iR8uBWkv="" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="34" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;">
<h1>Practical</h1>
<h4>and/or</h4>
<p>Take advantage of the knowledge of your peers and practice your skills with the <code>press_schechter</code> code.<br />
Some ideas include:</p>
<ul>
<li>Add inline documentation and build docs using <a href="https://www.sphinx-doc.org/en/master/">Sphinx</a>
<ul>
<li>Tip: use the <a href="https://www.sphinx-doc.org/en/master/usage/extensions/napoleon.html">Napolean</a> extension and Numpy or Googledoc style docstrings.</li>
<li>Bonus: Fork of the <code>code_prac_hwsa2021</code> repo on Github and serve the docs online using <a href="https://pages.github.com/">Github Pages</a>.</li>
</ul>
</li>
<li>Develop unit tests for the code
<ul>
<li>Bonus: Use <a href="https://coverage.readthedocs.io/en/coverage-5.5/">coverage.py</a> tool to measure your unit test coverage and aim for &gt;90% coverage.</li>
<li>Bonus bonus: Fork the <code>code_prac_hwsa2021</code> repo and use <a href="https://github.com/features/actions">Github Actions</a> to automatically test the code on every push.</li>
</ul>
</li>
<li>Add type annotations to the code then use <a href="https://mypy.readthedocs.io/en/stable/index.html">mypy</a> to check these.</li>
<li>If you manage to speed up the <code>press_schechter</code> function enough (or ask me for a faster version), try making an interactive tool for exploring the PS mass function using <a href="https://jupyter.org/">Jupyter Notebooks</a> and <a href="https://ipywidgets.readthedocs.io/en/stable/">ipywidgets</a> (or a tool of your choice).</li>
</ul>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="35" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:33%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./assets/glenn-carstens-peters-RLw-UC03Gwc-unsplash.jpg&quot;);"></figure></div></section></foreignObject><foreignObject width="67%" height="720"><section id="35" data-paginate="true" data-footer="https://github.com/smutch/code_prac_hwsa2021" data-theme="custom" data-marpit-pagination="35" data-marpit-pagination-total="35" style="--paginate:true;--footer:https://github.com/smutch/code_prac_hwsa2021;--theme:custom;--marpit-advanced-background-split:33%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1>Remember</h1>

<ol>
<li>Profile</li>
<li>Develop regression tests</li>
<li>Baseline timing<br /><br /></li>
<li>Optimise identified bottlenecks</li>
<li>Time</li>
<li>Test</li>
<li>Profile then go back to 4<br />
<strong>or</strong> call it a day</li>
</ol>
<footer><a href="https://github.com/smutch/code_prac_hwsa2021">https://github.com/smutch/code_prac_hwsa2021</a></footer>
</section>
<script>!function(){"use strict";const t="marpitSVGPolyfill:setZoomFactor,",e=Symbol();let r,o;function n(n){const i="object"==typeof n&&n.target||document,a="object"==typeof n?n.zoom:n;window[e]||(Object.defineProperty(window,e,{configurable:!0,value:!0}),window.addEventListener("message",(({data:e,origin:r})=>{if(r===window.origin)try{if(e&&"string"==typeof e&&e.startsWith(t)){const[,t]=e.split(","),r=Number.parseFloat(t);Number.isNaN(r)||(o=r)}}catch(t){console.error(t)}})));let l=!1;Array.from(i.querySelectorAll("svg[data-marpit-svg]"),(t=>{var e,n,i,s;t.style.transform||(t.style.transform="translateZ(0)");const c=a||o||t.currentScale||1;r!==c&&(r=c,l=c);const d=t.getBoundingClientRect(),{length:u}=t.children;for(let r=0;r<u;r+=1){const o=t.children[r],a=o.getScreenCTM();if(a){const t=null!==(n=null===(e=o.x)||void 0===e?void 0:e.baseVal.value)&&void 0!==n?n:0,r=null!==(s=null===(i=o.y)||void 0===i?void 0:i.baseVal.value)&&void 0!==s?s:0,l=o.firstElementChild,{style:u}=l;u.transformOrigin||(u.transformOrigin=`${-t}px ${-r}px`),u.transform=`scale(${c}) matrix(${a.a}, ${a.b}, ${a.c}, ${a.d}, ${a.e-d.left}, ${a.f-d.top}) translateZ(0.0001px)`}}})),!1!==l&&Array.from(i.querySelectorAll("iframe"),(({contentWindow:e})=>{null==e||e.postMessage(`${t}${l}`,"null"===window.origin?"*":window.origin)}))}r=1,o=void 0;const i=(t,e,r)=>{if(t.getAttribute(e)!==r)return t.setAttribute(e,r),!0};function a({once:t=!1,target:e=document}={}){const r="Apple Computer, Inc."===navigator.vendor?[n]:[];let o=!t;const a=()=>{for(const t of r)t({target:e});!function(t=document){Array.from(t.querySelectorAll('svg[data-marp-fitting="svg"]'),(t=>{var e;const r=t.firstChild,o=r.firstChild,{scrollWidth:n,scrollHeight:a}=o;let l,s=1;if(t.hasAttribute("data-marp-fitting-code")&&(l=null===(e=t.parentElement)||void 0===e?void 0:e.parentElement),t.hasAttribute("data-marp-fitting-math")&&(l=t.parentElement),l){const t=getComputedStyle(l),e=Math.ceil(l.clientWidth-parseFloat(t.paddingLeft||"0")-parseFloat(t.paddingRight||"0"));e&&(s=e)}const c=Math.max(n,s),d=Math.max(a,1),u=`0 0 ${c} ${d}`;i(r,"width",`${c}`),i(r,"height",`${d}`),i(t,"preserveAspectRatio",getComputedStyle(t).getPropertyValue("--preserve-aspect-ratio")||"xMinYMin meet"),i(t,"viewBox",u)&&t.classList.toggle("__reflow__")}))}(e),o&&window.requestAnimationFrame(a)};return a(),()=>{o=!1}}const l=Symbol(),s=document.currentScript;((t=document)=>{if("undefined"==typeof window)throw new Error("Marp Core's browser script is valid only in browser context.");if(t[l])return t[l];const e=a({target:t}),r=()=>{e(),delete t[l]};Object.defineProperty(t,l,{configurable:!0,value:r})})(s?s.getRootNode():document)}();
</script></foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="35" data-marpit-pagination-total="35"></section></foreignObject></svg></div><script>/*!! License: https://unpkg.com/@marp-team/marp-cli@1.4.2/lib/bespoke.js.LICENSE.txt */
!function(){"use strict";const e=document.body,t=(...e)=>history.replaceState(...e),n="presenter",r="next",o=["",n,r],a="data-bespoke-marp-",i=(e,{protocol:t,host:n,pathname:r,hash:o}=location)=>{const a=e.toString();return`${t}//${n}${r}${a?"?":""}${a}${o}`},s=()=>e.dataset.bespokeView,l=e=>new URLSearchParams(location.search).get(e),c=(e,n={})=>{var r;const o={location,setter:t,...n},a=new URLSearchParams(o.location.search);for(const t of Object.keys(e)){const n=e[t];"string"==typeof n?a.set(t,n):a.delete(t)}try{o.setter({...null!==(r=window.history.state)&&void 0!==r?r:{}},"",i(a,o.location))}catch(e){console.error(e)}},d=(()=>{const e="bespoke-marp";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}})(),f=e=>{try{return localStorage.getItem(e)}catch(e){return null}},u=(e,t)=>{try{return localStorage.setItem(e,t),!0}catch(e){return!1}},m=e=>{try{return localStorage.removeItem(e),!0}catch(e){return!1}},g=(e,t)=>{const n="aria-hidden";t?e.setAttribute(n,"true"):e.removeAttribute(n)},p=e=>{e.parent.classList.add("bespoke-marp-parent"),e.slides.forEach((e=>e.classList.add("bespoke-marp-slide"))),e.on("activate",(t=>{const n="bespoke-marp-active",r=t.slide,o=r.classList,a=!o.contains(n);if(e.slides.forEach((e=>{e.classList.remove(n),g(e,!0)})),o.add(n),g(r,!1),a){const e=`${n}-ready`;o.add(e),document.body.clientHeight,o.remove(e)}}))},v=e=>{let t=0,n=0;Object.defineProperty(e,"fragments",{enumerable:!0,value:e.slides.map((e=>[null,...e.querySelectorAll("[data-marpit-fragment]")]))});const r=r=>void 0!==e.fragments[t][n+r],o=(r,o)=>{t=r,n=o,e.fragments.forEach(((e,t)=>{e.forEach(((e,n)=>{if(null==e)return;const i=t<r||t===r&&n<=o;e.setAttribute(`${a}fragment`,(i?"":"in")+"active");const s=`${a}current-fragment`;t===r&&n===o?e.setAttribute(s,"current"):e.removeAttribute(s)}))})),e.fragmentIndex=o;const i={slide:e.slides[r],index:r,fragments:e.fragments[r],fragmentIndex:o};e.fire("fragment",i)};e.on("next",(({fragment:a=!0})=>{if(a){if(r(1))return o(t,n+1),!1;const a=t+1;e.fragments[a]&&o(a,0)}else{const r=e.fragments[t].length;if(n+1<r)return o(t,r-1),!1;const a=e.fragments[t+1];a&&o(t+1,a.length-1)}})),e.on("prev",(({fragment:a=!0})=>{if(r(-1)&&a)return o(t,n-1),!1;const i=t-1;e.fragments[i]&&o(i,e.fragments[i].length-1)})),e.on("slide",(({index:t,fragment:n})=>{let r=0;if(void 0!==n){const o=e.fragments[t];if(o){const{length:e}=o;r=-1===n?e-1:Math.min(Math.max(n,0),e-1)}}o(t,r)})),o(0,0)},h=document,y=()=>!(!h.fullscreenEnabled&&!h.webkitFullscreenEnabled),x=()=>!(!h.fullscreenElement&&!h.webkitFullscreenElement),w=e=>{e.fullscreen=()=>{y()&&(async()=>{return x()?null===(e=h.exitFullscreen||h.webkitExitFullscreen)||void 0===e?void 0:e.call(h):((e=h.body)=>{var t;return null===(t=e.requestFullscreen||e.webkitRequestFullscreen)||void 0===t?void 0:t.call(e)})();var e})()},document.addEventListener("keydown",(t=>{"f"!==t.key&&"F11"!==t.key||t.altKey||t.ctrlKey||t.metaKey||!y()||(e.fullscreen(),t.preventDefault())}))},b="bespoke-marp-inactive",k=(e=2e3)=>({parent:t,fire:n})=>{const r=t.classList,o=e=>n(`marp-${e?"":"in"}active`);let a;const i=()=>{a&&clearTimeout(a),a=setTimeout((()=>{r.add(b),o()}),e),r.contains(b)&&(r.remove(b),o(!0))};for(const e of["mousedown","mousemove","touchend"])document.addEventListener(e,i);setTimeout(i,0)},E=["AUDIO","BUTTON","INPUT","SELECT","TEXTAREA","VIDEO"],L=e=>{e.parent.addEventListener("keydown",(e=>{if(!e.target)return;const t=e.target;(E.includes(t.nodeName)||"true"===t.contentEditable)&&e.stopPropagation()}))},$=e=>{window.addEventListener("load",(()=>{for(const t of e.slides){const e=t.querySelector("[data-marp-fitting]")?"":"hideable";t.setAttribute(`${a}load`,e)}}))},P=({interval:e=250}={})=>t=>{document.addEventListener("keydown",(e=>{if(" "===e.key&&e.shiftKey)t.prev();else if("ArrowLeft"===e.key||"ArrowUp"===e.key||"PageUp"===e.key)t.prev({fragment:!e.shiftKey});else if(" "!==e.key||e.shiftKey)if("ArrowRight"===e.key||"ArrowDown"===e.key||"PageDown"===e.key)t.next({fragment:!e.shiftKey});else if("End"===e.key)t.slide(t.slides.length-1,{fragment:-1});else{if("Home"!==e.key)return;t.slide(0)}else t.next();e.preventDefault()}));let n,r,o=0;t.parent.addEventListener("wheel",(a=>{let i=!1;const s=(e,t)=>{e&&(i=i||((e,t)=>((e,t)=>{const n="X"===t?"Width":"Height";return e[`client${n}`]<e[`scroll${n}`]})(e,t)&&((e,t)=>{const{overflow:n}=e,r=e[`overflow${t}`];return"auto"===n||"scroll"===n||"auto"===r||"scroll"===r})(getComputedStyle(e),t))(e,t)),(null==e?void 0:e.parentElement)&&s(e.parentElement,t)};if(0!==a.deltaX&&s(a.target,"X"),0!==a.deltaY&&s(a.target,"Y"),i)return;a.preventDefault();const l=Math.sqrt(a.deltaX**2+a.deltaY**2);if(void 0!==a.wheelDelta){if(void 0===a.webkitForce&&Math.abs(a.wheelDelta)<40)return;if(a.deltaMode===a.DOM_DELTA_PIXEL&&l<4)return}else if(a.deltaMode===a.DOM_DELTA_PIXEL&&l<12)return;r&&clearTimeout(r),r=setTimeout((()=>{n=0}),e);const c=Date.now()-o<e,d=l<=n;if(n=l,c||d)return;let f;(a.deltaX>0||a.deltaY>0)&&(f="next"),(a.deltaX<0||a.deltaY<0)&&(f="prev"),f&&(t[f](),o=Date.now())}))},S=(e=".bespoke-marp-osc")=>{const t=document.querySelector(e);if(!t)return()=>{};const n=(e,n)=>{t.querySelectorAll(`[${a}osc=${JSON.stringify(e)}]`).forEach(n)};return y()||n("fullscreen",(e=>e.style.display="none")),d||n("presenter",(e=>{e.disabled=!0,e.title="Presenter view is disabled due to restricted localStorage."})),e=>{t.addEventListener("click",(t=>{if(t.target instanceof HTMLElement){const{bespokeMarpOsc:n}=t.target.dataset;n&&t.target.blur();const r={fragment:!t.shiftKey};"next"===n?e.next(r):"prev"===n?e.prev(r):"fullscreen"===n?null==e||e.fullscreen():"presenter"===n&&e.openPresenterView()}})),e.parent.appendChild(t),e.on("activate",(({index:t})=>{n("page",(n=>n.textContent=`Page ${t+1} of ${e.slides.length}`))})),e.on("fragment",(({index:t,fragments:r,fragmentIndex:o})=>{n("prev",(e=>e.disabled=0===t&&0===o)),n("next",(n=>n.disabled=t===e.slides.length-1&&o===r.length-1))})),e.on("marp-active",(()=>g(t,!1))),e.on("marp-inactive",(()=>g(t,!0))),y()&&(e=>{for(const t of["","webkit"])h.addEventListener(t+"fullscreenchange",e)})((()=>n("fullscreen",(e=>e.classList.toggle("exit",y()&&x())))))}},I=e=>{window.addEventListener("message",(t=>{if(t.origin!==window.origin)return;const[n,r]=t.data.split(":");if("navigate"===n){const[t,n]=r.split(",");let o=Number.parseInt(t,10),a=Number.parseInt(n,10)+1;a>=e.fragments[o].length&&(o+=1,a=0),e.slide(o,{fragment:a})}}))};var T=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];let A=e=>String(e).replace(/[&<>"']/g,(e=>`&${C[e]};`)),C={"&":"amp","<":"lt",">":"gt",'"':"quot","'":"apos"},N="dangerouslySetInnerHTML",K={className:"class",htmlFor:"for"},O={};function D(e,t){let n=[],r="";t=t||{};for(let e=arguments.length;e-- >2;)n.push(arguments[e]);if("function"==typeof e)return t.children=n.reverse(),e(t);if(e){if(r+="<"+e,t)for(let e in t)!1!==t[e]&&null!=t[e]&&e!==N&&(r+=` ${K[e]?K[e]:A(e)}="${A(t[e])}"`);r+=">"}if(-1===T.indexOf(e)){if(t[N])r+=t[N].__html;else for(;n.length;){let e=n.pop();if(e)if(e.pop)for(let t=e.length;t--;)n.push(e[t]);else r+=!0===O[e]?e:A(e)}r+=e?`</${e}>`:""}return O[r]=!0,r}const M=({children:e})=>D(null,null,...e),q="bespoke-marp-presenter-",_={container:`${q}container`,next:`${q}next`,nextContainer:`${q}next-container`,noteContainer:`${q}note-container`,infoContainer:`${q}info-container`,infoPage:`${q}info-page`,infoPageText:`${q}info-page-text`,infoPagePrev:`${q}info-page-prev`,infoPageNext:`${q}info-page-next`,infoTime:`${q}info-time`,infoTimer:`${q}info-timer`},U=e=>{const{title:t}=document;document.title="[Presenter view]"+(t?` - ${t}`:"");const n={},r=e=>(n[e]=n[e]||document.querySelector(`.${e}`),n[e]);document.body.appendChild((e=>{const t=document.createElement("div");return t.className=_.container,t.appendChild(e),t.insertAdjacentHTML("beforeend",D(M,null,D("div",{class:_.nextContainer},D("iframe",{class:_.next,src:"?view=next"})),D("div",{class:_.noteContainer}),D("div",{class:_.infoContainer},D("div",{class:_.infoPage},D("button",{class:_.infoPagePrev,tabindex:"-1",title:"Previous"},"Previous"),D("span",{class:_.infoPageText}),D("button",{class:_.infoPageNext,tabindex:"-1",title:"Next"},"Next")),D("time",{class:_.infoTime,title:"Current time"}),D("div",{class:_.infoTimer})))),t})(e.parent)),(e=>{r(_.nextContainer).addEventListener("click",(()=>e.next()));const t=r(_.next),n=(o=t,(e,t)=>{var n;return null===(n=o.contentWindow)||void 0===n?void 0:n.postMessage(`navigate:${e},${t}`,"null"===window.origin?"*":window.origin)});var o;t.addEventListener("load",(()=>{r(_.nextContainer).classList.add("active"),n(e.slide(),e.fragmentIndex),e.on("fragment",(({index:e,fragmentIndex:t})=>n(e,t)))}));const a=document.querySelectorAll(".bespoke-marp-note");a.forEach((e=>{e.addEventListener("keydown",(e=>e.stopPropagation())),r(_.noteContainer).appendChild(e)})),e.on("activate",(()=>a.forEach((t=>t.classList.toggle("active",t.dataset.index==e.slide()))))),e.on("activate",(({index:t})=>{r(_.infoPageText).textContent=`${t+1} / ${e.slides.length}`}));const i=r(_.infoPagePrev),s=r(_.infoPageNext);i.addEventListener("click",(t=>{i.blur(),e.prev({fragment:!t.shiftKey})})),s.addEventListener("click",(t=>{s.blur(),e.next({fragment:!t.shiftKey})})),e.on("fragment",(({index:t,fragments:n,fragmentIndex:r})=>{i.disabled=0===t&&0===r,s.disabled=t===e.slides.length-1&&r===n.length-1}));const l=()=>r(_.infoTime).textContent=(new Date).toLocaleTimeString();l(),setInterval(l,250)})(e)},V=e=>{if(!(e=>e.syncKey&&"string"==typeof e.syncKey)(e))throw new Error("The current instance of Bespoke.js is invalid for Marp bespoke presenter plugin.");Object.defineProperties(e,{openPresenterView:{enumerable:!0,value:X},presenterUrl:{enumerable:!0,get:F}}),d&&document.addEventListener("keydown",(t=>{"p"!==t.key||t.altKey||t.ctrlKey||t.metaKey||(t.preventDefault(),e.openPresenterView())}))};function X(){const{max:e,floor:t}=Math,n=e(t(.85*window.innerWidth),640),r=e(t(.85*window.innerHeight),360);return window.open(this.presenterUrl,q+this.syncKey,`width=${n},height=${r},menubar=no,toolbar=no`)}function F(){const e=new URLSearchParams(location.search);return e.set("view","presenter"),e.set("sync",this.syncKey),i(e)}const B=e=>{const t=s();return t===r&&e.appendChild(document.createElement("span")),{"":V,[n]:U,[r]:I}[t]},R=e=>{e.on("activate",(t=>{document.querySelectorAll(".bespoke-progress-parent > .bespoke-progress-bar").forEach((n=>{n.style.flexBasis=100*t.index/(e.slides.length-1)+"%"}))}))},j=e=>{const t=Number.parseInt(e,10);return Number.isNaN(t)?null:t},H=(e={})=>{const t={history:!0,...e};return e=>{let n=!0;const r=e=>{const t=n;try{return n=!0,e()}finally{n=t}},o=(t={fragment:!0})=>{((t,n)=>{const{min:r,max:o}=Math,{fragments:a,slides:i}=e,s=o(0,r(t,i.length-1)),l=o(0,r(n||0,a[s].length-1));s===e.slide()&&l===e.fragmentIndex||e.slide(s,{fragment:l})})((j(location.hash.slice(1))||1)-1,t.fragment?j(l("f")||""):null)};e.on("fragment",(({index:e,fragmentIndex:r})=>{n||c({f:0===r||r.toString()},{location:{...location,hash:`#${e+1}`},setter:(...e)=>t.history?history.pushState(...e):history.replaceState(...e)})})),setTimeout((()=>{o(),window.addEventListener("hashchange",(()=>r((()=>{o({fragment:!1}),c({f:void 0})})))),window.addEventListener("popstate",(()=>{n||r((()=>o()))})),n=!1}),0)}},Y=(e={})=>{var n;const r=e.key||(null===(n=window.history.state)||void 0===n?void 0:n.marpBespokeSyncKey)||Math.random().toString(36).slice(2),o=`bespoke-marp-sync-${r}`;var a;a={marpBespokeSyncKey:r},c({},{setter:(e,...n)=>t({...e,...a},...n)});const i=()=>{const e=f(o);return e?JSON.parse(e):Object.create(null)},s=e=>{const t=i(),n={...t,...e(t)};return u(o,JSON.stringify(n)),n},l=()=>{window.removeEventListener("pageshow",l),s((e=>({reference:(e.reference||0)+1})))};return e=>{l(),Object.defineProperty(e,"syncKey",{value:r,enumerable:!0});let t=!0;setTimeout((()=>{e.on("fragment",(e=>{t&&s((()=>({index:e.index,fragmentIndex:e.fragmentIndex})))}))}),0),window.addEventListener("storage",(n=>{if(n.key===o&&n.oldValue&&n.newValue){const r=JSON.parse(n.oldValue),o=JSON.parse(n.newValue);if(r.index!==o.index||r.fragmentIndex!==o.fragmentIndex)try{t=!1,e.slide(o.index,{fragment:o.fragmentIndex})}finally{t=!0}}}));const n=()=>{const{reference:e}=i();void 0===e||e<=1?m(o):s((()=>({reference:e-1})))};window.addEventListener("pagehide",(e=>{e.persisted&&window.addEventListener("pageshow",l),n()})),e.on("destroy",n)}},{PI:J,abs:W,sqrt:z,atan2:G}=Math,Q={passive:!0},Z=({slope:e=-.7,swipeThreshold:t=30}={})=>n=>{let r;const o=n.parent,a=e=>{const t=o.getBoundingClientRect();return{x:e.pageX-(t.left+t.right)/2,y:e.pageY-(t.top+t.bottom)/2}};o.addEventListener("touchstart",(({touches:e})=>{r=1===e.length?a(e[0]):void 0}),Q),o.addEventListener("touchmove",(e=>{if(r)if(1===e.touches.length){e.preventDefault();const t=a(e.touches[0]),n=t.x-r.x,o=t.y-r.y;r.delta=z(W(n)**2+W(o)**2),r.radian=G(n,o)}else r=void 0})),o.addEventListener("touchend",(o=>{if(r){if(r.delta&&r.delta>=t&&r.radian){const t=(r.radian-e+J)%(2*J)-J;n[t<0?"next":"prev"](),o.stopPropagation()}r=void 0}}),Q)},ee="_tA",te=e=>{const t=document.documentTransition;if(!t)return;let n;e._tP=!1;const r=(n,{back:r,cond:o})=>a=>{const i=e.slides[e.slide()].querySelector("section[data-transition]");if(!i)return!0;const s=document.querySelector(".bespoke-marp-osc"),l=s?[s]:void 0;if(e._tP){if(a._tA){e._tP=!1;try{t.start({sharedElements:l}).catch((()=>{}))}catch(e){}return!0}}else{if(!o(a))return!0;e._tP=t.prepare({rootTransition:a.back||r?i.dataset.transitionBack:i.dataset.transition,sharedElements:l}).then((()=>n(a))).catch((()=>n(a)))}return!1};e.on("prev",r((t=>e.prev({...t,[ee]:!0})),{back:!0,cond:e=>{var t;return e.index>0&&!((null===(t=e.fragment)||void 0===t||t)&&n.fragmentIndex>0)}})),e.on("next",r((t=>e.next({...t,[ee]:!0})),{cond:t=>t.index+1<e.slides.length&&!(n.fragmentIndex+1<n.fragments.length)})),setTimeout((()=>{e.on("slide",r((t=>e.slide(t.index,{...t,[ee]:!0})),{cond:t=>{const n=e.slide();return t.index!==n&&(t.back=t.index<n,!0)}}))}),0),e.on("fragment",(e=>{n=e}))};let ne;const re=()=>(void 0===ne&&(ne="wakeLock"in navigator&&navigator.wakeLock),ne),oe=async()=>{const e=re();if(e)try{return await e.request("screen")}catch(e){console.warn(e)}return null},ae=async()=>{if(!re())return;let e;const t=()=>{e&&"visible"===document.visibilityState&&oe()};for(const e of["visibilitychange","fullscreenchange"])document.addEventListener(e,t);return e=await oe(),e};((t=document.getElementById("p"))=>{(()=>{const t=l("view");e.dataset.bespokeView=t===r||t===n?t:""})();const a=(e=>{const t=l(e);return c({[e]:void 0}),t})("sync")||void 0;var i,d,f,u,m,g,h,y,x,b,E,I;i=t,d=((...e)=>{const t=o.findIndex((e=>s()===e));return e.map((([e,n])=>e[t]&&n)).filter((e=>e))})([[1,1,0],Y({key:a})],[[1,1,1],B(t)],[[1,1,0],L],[[1,1,1],p],[[1,0,0],k()],[[1,1,1],$],[[1,1,1],H({history:!1})],[[1,1,0],P()],[[1,1,0],w],[[1,0,0],R],[[1,1,0],Z()],[[1,0,0],S()],[[1,0,0],te],[[1,1,1],v],[[1,1,0],ae]),u=1===(i.parent||i).nodeType?i.parent||i:document.querySelector(i.parent||i),m=[].filter.call("string"==typeof i.slides?u.querySelectorAll(i.slides):i.slides||u.children,(function(e){return"SCRIPT"!==e.nodeName})),g={},h=function(e,t){return(t=t||{}).index=m.indexOf(e),t.slide=e,t},b=function(e,t){m[e]&&(f&&x("deactivate",h(f,t)),f=m[e],x("activate",h(f,t)))},E=function(e,t){var n=m.indexOf(f)+e;x(e>0?"next":"prev",h(f,t))&&b(n,t)},I={off:y=function(e,t){g[e]=(g[e]||[]).filter((function(e){return e!==t}))},on:function(e,t){return(g[e]||(g[e]=[])).push(t),y.bind(null,e,t)},fire:x=function(e,t){return(g[e]||[]).reduce((function(e,n){return e&&!1!==n(t)}),!0)},slide:function(e,t){if(!arguments.length)return m.indexOf(f);x("slide",h(m[e],t))&&b(e,t)},next:E.bind(null,1),prev:E.bind(null,-1),parent:u,slides:m,destroy:function(e){x("destroy",h(f,e)),g={}}},(d||[]).forEach((function(e){e(I)})),f||b(0)})()}();</script></body></html>